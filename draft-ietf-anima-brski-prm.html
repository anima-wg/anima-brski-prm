<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>BRSKI with Pledge in Responder Mode (BRSKI-PRM)</title>
<meta content="Steffen Fries" name="author">
<meta content="Thomas Werner" name="author">
<meta content="Eliot Lear" name="author">
<meta content="Michael C. Richardson" name="author">
<meta content="
       This document defines enhancements to Bootstrapping a Remote Secure Key Infrastructure (BRSKI, RFC8995) to enable bootstrapping in domains featuring no or only limited connectivity between a pledge and the domain registrar.
It specifically changes the interaction model from a pledge-initiated mode, as used in BRSKI, to a pledge-responding mode, where the pledge is in server role.
For this, BRSKI with Pledge in Responder Mode (BRSKI-PRM) introduces new endpoints for the Domain Registrar and pledge, and a new component, the Registrar-Agent, which facilitates the communication between pledge and registrar during the bootstrapping phase.
To establish the trust relation between pledge and registrar, BRSKI-PRM relies on object security rather than transport security.
This approach is agnostic to the enrollment protocol that connects the domain registrar to a Key Infrastructure (e.g., domain Certification Authority). 
    " name="description">
<meta content="xml2rfc 3.28.1" name="generator">
<meta content="draft-ietf-anima-brski-prm-19" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.28.1
    Python 3.12.3
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.1
    platformdirs 4.3.7
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.3
    setuptools 78.1.0
    wcwidth 0.2.13
    weasyprint 65.0
-->
<link href="draft-ietf-anima-brski-prm.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    max-width: 100%;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code, dt tt, dt code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body class="xml2rfc">
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">BRSKI-PRM</td>
<td class="right">April 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Fries, et al.</td>
<td class="center">Expires 11 October 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">ANIMA WG</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-anima-brski-prm-19</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-04-09" class="published">9 April 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-10-11">11 October 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">S. Fries</div>
<div class="org">Siemens</div>
</div>
<div class="author">
      <div class="author-name">T. Werner</div>
<div class="org">Siemens</div>
</div>
<div class="author">
      <div class="author-name">E. Lear</div>
<div class="org">Cisco Systems</div>
</div>
<div class="author">
      <div class="author-name">M. Richardson</div>
<div class="org">Sandelman Software Works</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">BRSKI with Pledge in Responder Mode (BRSKI-PRM)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines enhancements to Bootstrapping a Remote Secure Key Infrastructure (BRSKI, RFC8995) to enable bootstrapping in domains featuring no or only limited connectivity between a pledge and the domain registrar.
It specifically changes the interaction model from a pledge-initiated mode, as used in BRSKI, to a pledge-responding mode, where the pledge is in server role.
For this, BRSKI with Pledge in Responder Mode (BRSKI-PRM) introduces new endpoints for the Domain Registrar and pledge, and a new component, the Registrar-Agent, which facilitates the communication between pledge and registrar during the bootstrapping phase.
To establish the trust relation between pledge and registrar, BRSKI-PRM relies on object security rather than transport security.
This approach is agnostic to the enrollment protocol that connects the domain registrar to a Key Infrastructure (e.g., domain Certification Authority).<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-ietf-anima-brski-prm/">https://datatracker.ietf.org/doc/draft-ietf-anima-brski-prm/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/anima-wg/anima-brski-prm">https://github.com/anima-wg/anima-brski-prm</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 11 October 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-scope-of-solution" class="internal xref">Scope of Solution</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-supported-environments-and-" class="internal xref">Supported Environments and Use Case Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1" class="keepWithNext"><a href="#section-3.1.1" class="auto internal xref">3.1.1</a>.  <a href="#name-building-automation" class="internal xref">Building Automation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a href="#section-3.1.2" class="auto internal xref">3.1.2</a>.  <a href="#name-infrastructure-isolation-po" class="internal xref">Infrastructure Isolation Policy</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.3">
                    <p id="section-toc.1-1.3.2.1.2.3.1"><a href="#section-3.1.3" class="auto internal xref">3.1.3</a>.  <a href="#name-less-operational-security-i" class="internal xref">Less Operational Security in the Target-Domain</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-potential-limitations" class="internal xref">Potential Limitations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-requirements-discussion-and" class="internal xref">Requirements Discussion and Mapping to BRSKI-PRM Functional Elements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-solution-architecture" class="internal xref">Solution Architecture</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-overview" class="internal xref">Overview</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-nomadic-connectivity" class="internal xref">Nomadic Connectivity</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-co-located-registrar-agent-" class="internal xref">Co-located Registrar-Agent and Domain Registrar</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-agent-proximity-assertion" class="internal xref">Agent Proximity Assertion</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-system-components" class="internal xref">System Components</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-registrar-agent" class="internal xref">Registrar-Agent</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a href="#section-6.1.1" class="auto internal xref">6.1.1</a>.  <a href="#name-discovery-of-the-registrar" class="internal xref">Discovery of the Registrar</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.2">
                    <p id="section-toc.1-1.6.2.1.2.2.1"><a href="#section-6.1.2" class="auto internal xref">6.1.2</a>.  <a href="#name-discovery-of-the-pledge" class="internal xref">Discovery of the Pledge</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-pledge-in-responder-mode" class="internal xref">Pledge in Responder Mode</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="auto internal xref">6.2.1</a>.  <a href="#name-pledge-with-combined-functi" class="internal xref">Pledge with Combined Functionality</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-domain-registrar" class="internal xref">Domain Registrar</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.1">
                    <p id="section-toc.1-1.6.2.3.2.1.1"><a href="#section-6.3.1" class="auto internal xref">6.3.1</a>.  <a href="#name-domain-registrar-with-combi" class="internal xref">Domain Registrar with Combined Functionality</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-masa" class="internal xref">MASA</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-exchanges-and-artifacts" class="internal xref">Exchanges and Artifacts</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-trigger-pledge-voucher-requ" class="internal xref">Trigger Pledge Voucher-Request</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1.2.1">
                    <p id="section-toc.1-1.7.2.1.2.1.1"><a href="#section-7.1.1" class="auto internal xref">7.1.1</a>.  <a href="#name-request-artifact-pledge-vou" class="internal xref">Request Artifact: Pledge Voucher-Request Trigger (tPVR)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1.2.2">
                    <p id="section-toc.1-1.7.2.1.2.2.1"><a href="#section-7.1.2" class="auto internal xref">7.1.2</a>.  <a href="#name-response-artifact-pledge-vo" class="internal xref">Response Artifact: Pledge Voucher-Request (PVR)</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-trigger-pledge-enroll-reque" class="internal xref">Trigger Pledge Enroll-Request</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.1">
                    <p id="section-toc.1-1.7.2.2.2.1.1"><a href="#section-7.2.1" class="auto internal xref">7.2.1</a>.  <a href="#name-request-artifact-pledge-enr" class="internal xref">Request Artifact: Pledge Enroll-Request Trigger (tPER)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.2">
                    <p id="section-toc.1-1.7.2.2.2.2.1"><a href="#section-7.2.2" class="auto internal xref">7.2.2</a>.  <a href="#name-response-artifact-pledge-en" class="internal xref">Response Artifact: Pledge Enroll-Request (PER)</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-supply-pvr-to-registrar-inc" class="internal xref">Supply PVR to Registrar (including MASA interaction)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.1">
                    <p id="section-toc.1-1.7.2.3.2.1.1"><a href="#section-7.3.1" class="auto internal xref">7.3.1</a>.  <a href="#name-masa-interaction" class="internal xref">MASA Interaction</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.2">
                    <p id="section-toc.1-1.7.2.3.2.2.1"><a href="#section-7.3.2" class="auto internal xref">7.3.2</a>.  <a href="#name-supply-voucher-to-registrar" class="internal xref">Supply Voucher to Registrar-Agent</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.3">
                    <p id="section-toc.1-1.7.2.3.2.3.1"><a href="#section-7.3.3" class="auto internal xref">7.3.3</a>.  <a href="#name-request-artifact-pledge-vouc" class="internal xref">Request Artifact: Pledge Voucher-Request (PVR)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.4">
                    <p id="section-toc.1-1.7.2.3.2.4.1"><a href="#section-7.3.4" class="auto internal xref">7.3.4</a>.  <a href="#name-backend-request-artifact-re" class="internal xref">Backend Request Artifact: Registrar Voucher-Request (RVR)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.5">
                    <p id="section-toc.1-1.7.2.3.2.5.1"><a href="#section-7.3.5" class="auto internal xref">7.3.5</a>.  <a href="#name-backend-response-artifact-v" class="internal xref">Backend Response Artifact: Voucher</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.6">
                    <p id="section-toc.1-1.7.2.3.2.6.1"><a href="#section-7.3.6" class="auto internal xref">7.3.6</a>.  <a href="#name-response-artifact-registrar" class="internal xref">Response Artifact: Registrar-Countersigned Voucher</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-supply-per-to-registrar-inc" class="internal xref">Supply PER to Registrar (including Key Infrastructure interaction; requestenroll)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.1">
                    <p id="section-toc.1-1.7.2.4.2.1.1"><a href="#section-7.4.1" class="auto internal xref">7.4.1</a>.  <a href="#name-request-artifact-pledge-enro" class="internal xref">Request Artifact: Pledge Enroll-Request (PER)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.2">
                    <p id="section-toc.1-1.7.2.4.2.2.1"><a href="#section-7.4.2" class="auto internal xref">7.4.2</a>.  <a href="#name-response-artifact-registrar-" class="internal xref">Response Artifact: Registrar Enroll-Response (Enroll-Resp)</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="auto internal xref">7.5</a>.  <a href="#name-obtain-ca-certificates-wrap" class="internal xref">Obtain CA Certificates (wrappedcacerts)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5.2.1">
                    <p id="section-toc.1-1.7.2.5.2.1.1"><a href="#section-7.5.1" class="auto internal xref">7.5.1</a>.  <a href="#name-request-no-artifact" class="internal xref">Request (no artifact)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5.2.2">
                    <p id="section-toc.1-1.7.2.5.2.2.1"><a href="#section-7.5.2" class="auto internal xref">7.5.2</a>.  <a href="#name-response-artifact-ca-certif" class="internal xref">Response Artifact: CA-Certificates (caCerts)</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6">
                <p id="section-toc.1-1.7.2.6.1"><a href="#section-7.6" class="auto internal xref">7.6</a>.  <a href="#name-supply-voucher-to-pledge-sv" class="internal xref">Supply Voucher to Pledge (svr)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6.2.1">
                    <p id="section-toc.1-1.7.2.6.2.1.1"><a href="#section-7.6.1" class="auto internal xref">7.6.1</a>.  <a href="#name-request-artifact-registrar-" class="internal xref">Request Artifact: Registrar-Countersigned Voucher</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6.2.2">
                    <p id="section-toc.1-1.7.2.6.2.2.1"><a href="#section-7.6.2" class="auto internal xref">7.6.2</a>.  <a href="#name-response-artifact-voucher-s" class="internal xref">Response Artifact: Voucher Status (vStatus)</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.7">
                <p id="section-toc.1-1.7.2.7.1"><a href="#section-7.7" class="auto internal xref">7.7</a>.  <a href="#name-supply-ca-certificates-to-p" class="internal xref">Supply CA Certificates to Pledge (scac)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.7.2.1">
                    <p id="section-toc.1-1.7.2.7.2.1.1"><a href="#section-7.7.1" class="auto internal xref">7.7.1</a>.  <a href="#name-request-artifact-ca-certifi" class="internal xref">Request Artifact: CA-Certificates (caCerts)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.7.2.2">
                    <p id="section-toc.1-1.7.2.7.2.2.1"><a href="#section-7.7.2" class="auto internal xref">7.7.2</a>.  <a href="#name-response-no-artifact" class="internal xref">Response (no artifact)</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.8">
                <p id="section-toc.1-1.7.2.8.1"><a href="#section-7.8" class="auto internal xref">7.8</a>.  <a href="#name-supply-enroll-response-to-p" class="internal xref">Supply Enroll-Response to Pledge (ser)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.8.2.1">
                    <p id="section-toc.1-1.7.2.8.2.1.1"><a href="#section-7.8.1" class="auto internal xref">7.8.1</a>.  <a href="#name-request-artifact-enroll-res" class="internal xref">Request Artifact: Enroll-Response (Enroll-Resp)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.8.2.2">
                    <p id="section-toc.1-1.7.2.8.2.2.1"><a href="#section-7.8.2" class="auto internal xref">7.8.2</a>.  <a href="#name-response-artifact-enroll-st" class="internal xref">Response Artifact: Enroll Status (eStatus)</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.9">
                <p id="section-toc.1-1.7.2.9.1"><a href="#section-7.9" class="auto internal xref">7.9</a>.  <a href="#name-voucher-status-telemetry-in" class="internal xref">Voucher Status Telemetry (including MASA interaction)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.9.2.1">
                    <p id="section-toc.1-1.7.2.9.2.1.1"><a href="#section-7.9.1" class="auto internal xref">7.9.1</a>.  <a href="#name-request-artifact-voucher-st" class="internal xref">Request Artifact: Voucher Status (vStatus)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.9.2.2">
                    <p id="section-toc.1-1.7.2.9.2.2.1"><a href="#section-7.9.2" class="auto internal xref">7.9.2</a>.  <a href="#name-response-no-artifact-2" class="internal xref">Response (no artifact)</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.10">
                <p id="section-toc.1-1.7.2.10.1"><a href="#section-7.10" class="auto internal xref">7.10</a>. <a href="#name-enroll-status-telemetry" class="internal xref">Enroll Status Telemetry</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.10.2.1">
                    <p id="section-toc.1-1.7.2.10.2.1.1"><a href="#section-7.10.1" class="auto internal xref">7.10.1</a>.  <a href="#name-request-artifact-enroll-sta" class="internal xref">Request Artifact: Enroll Status (eStatus)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.10.2.2">
                    <p id="section-toc.1-1.7.2.10.2.2.1"><a href="#section-7.10.2" class="auto internal xref">7.10.2</a>.  <a href="#name-response-no-artifact-3" class="internal xref">Response (no artifact)</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.11">
                <p id="section-toc.1-1.7.2.11.1"><a href="#section-7.11" class="auto internal xref">7.11</a>. <a href="#name-query-pledge-status-qps" class="internal xref">Query Pledge Status (qps)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.11.2.1">
                    <p id="section-toc.1-1.7.2.11.2.1.1"><a href="#section-7.11.1" class="auto internal xref">7.11.1</a>.  <a href="#name-request-artifact-status-tri" class="internal xref">Request Artifact: Status Trigger (tStatus)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.11.2.2">
                    <p id="section-toc.1-1.7.2.11.2.2.1"><a href="#section-7.11.2" class="auto internal xref">7.11.2</a>.  <a href="#name-response-artifact-pledge-st" class="internal xref">Response Artifact: Pledge Status (pStatus)</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-logging-considerations" class="internal xref">Logging Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-operational-considerations" class="internal xref">Operational Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-brski-well-known-uris" class="internal xref">BRSKI Well-Known URIs</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-service-name-and-transport-" class="internal xref">Service Name and Transport Protocol Port Number Registry</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="auto internal xref">12.1</a>.  <a href="#name-denial-of-service-dos-attac" class="internal xref">Denial of Service (DoS) Attack on Pledge</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="auto internal xref">12.2</a>.  <a href="#name-misuse-of-acquired-pvr-and-" class="internal xref">Misuse of acquired PVR and PER by Registrar-Agent</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a href="#section-12.3" class="auto internal xref">12.3</a>.  <a href="#name-misuse-of-registrar-agent" class="internal xref">Misuse of Registrar-Agent</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.4">
                <p id="section-toc.1-1.12.2.4.1"><a href="#section-12.4" class="auto internal xref">12.4</a>.  <a href="#name-misuse-of-dns-sd-with-mdns-" class="internal xref">Misuse of DNS-SD with mDNS to obtain list of pledges</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.5">
                <p id="section-toc.1-1.12.2.5.1"><a href="#section-12.5" class="auto internal xref">12.5</a>.  <a href="#name-yang-module-security-consid" class="internal xref">YANG Module Security Considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="auto internal xref">14</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#section-14.1" class="auto internal xref">14.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#section-14.2" class="auto internal xref">14.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-examples" class="internal xref">Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-example-pledge-voucher-requ" class="internal xref">Example Pledge Voucher-Request (PVR) - from Pledge to Registrar-Agent</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-example-parboiled-registrar" class="internal xref">Example Parboiled Registrar Voucher-Request (RVR) - from Registrar to MASA</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.3">
                <p id="section-toc.1-1.15.2.3.1"><a href="#appendix-A.3" class="auto internal xref">A.3</a>.  <a href="#name-example-voucher-from-masa-t" class="internal xref">Example Voucher - from MASA to Pledge, via Registrar and Registrar-Agent</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.4">
                <p id="section-toc.1-1.15.2.4.1"><a href="#appendix-A.4" class="auto internal xref">A.4</a>.  <a href="#name-example-voucher-masa-issued" class="internal xref">Example Voucher, MASA issued Voucher with additional Registrar signature (from MASA to Pledge, via Registrar and Registrar-Agent)</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-http-over-tls-operations-be" class="internal xref">HTTP-over-TLS operations between Registrar-Agent and Pledge</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-history-of-changes-rfc-edit" class="internal xref">History of Changes [RFC Editor: please delete]</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-contributors" class="internal xref">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19">
            <p id="section-toc.1-1.19.1"><a href="#appendix-E" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">BRSKI as defined in <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span> specifies a solution for secure zero-touch (automated) bootstrapping of devices (pledges) in a customer domain, which may be associated with a specific installation location.
This includes the discovery of the BRSKI registrar in the customer domain and the exchange of security information necessary to establish trust between a pledge and the domain.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Security information about the customer domain, specifically the customer domain certificate, are exchanged and authenticated utilizing signed data objects, the voucher artifacts as defined in <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>.
In response to a voucher-request, the Manufacturer Authorized Signing Authority (MASA) issues the voucher and provides it via the domain registrar to the pledge.
<span>[<a href="#I-D.ietf-anima-rfc8366bis" class="cite xref">I-D.ietf-anima-rfc8366bis</a>]</span> specifies the format of the voucher artifacts, including the voucher-request artifact.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">For the certificate enrollment of devices, BRSKI relies on Enrollment over Secure Transport (EST, <span>[<a href="#RFC7030" class="cite xref">RFC7030</a>]</span>) to request and distribute customer domain specific device certificates.
EST in turn relies for the authentication and authorization of the certification request on the credentials used by the underlying TLS between the EST client and an EST server.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">BRSKI addresses scenarios in which a pledge initiates the bootstrapping acting as client (referred to as initiator mode by this document).
BRSKI with Pledge in Responder Mode (BRSKI-PRM) defined in this document allows the pledge to act as server, so that it can be triggered externally and at a specific time to generate bootstrapping requests in the customer domain.
For this approach, this document:<a href="#section-1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-5.1">
          <p id="section-1-5.1.1">defines additional endpoints for the domain registrar and new endpoints for the pledge to enable responder mode.<a href="#section-1-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-5.2">
          <p id="section-1-5.2.1">introduces the Registrar-Agent as new component to facilitate the communication between the pledge and a domain registrar.
The Registrar-Agent may be implemented as an integrated functionality of a commissioning tool or be co-located with the domain registrar itself.
BRSKI-PRM supports the identification of the Registrar-Agent that was performing the bootstrapping allowing for accountability of the pledges installation, when the Registrar-Agent is a component used by an installer and not co-located with the domain registrar.<a href="#section-1-5.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-5.3">
          <p id="section-1-5.3.1">specifies additional artifacts for the exchanges between a pledge acting as server, the Registrar-Agent acting as client, and the domain registrar acting as server toward the Registrar-Agent.<a href="#section-1-5.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-5.4">
          <p id="section-1-5.4.1">allows the application of Registrar-Agent credentials to establish TLS connections to a domain registrar; these are different from the pledge IDevID credentials.<a href="#section-1-5.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-5.5">
          <p id="section-1-5.5.1">also enables the usage of alternative transports, both IP-based and non-IP (e.g., Bluetooth-based or NFC-based communication), between the pledge and the domain registrar via the Registrar-Agent;
security is addressed at the application layer through object security with an additional signature wrapping the exchanged artifacts.<a href="#section-1-5.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-6">The term endpoint used in the context of this document is equivalent to resource in HTTP <span>[<a href="#RFC9110" class="cite xref">RFC9110</a>]</span> and CoAP <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>; it is not used to describe a device.
Endpoints are accessible via Well-Known URIs <span>[<a href="#RFC8615" class="cite xref">RFC8615</a>]</span>.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">To utilize EST <span>[<a href="#RFC7030" class="cite xref">RFC7030</a>]</span> for enrollment, the domain registrar performs pre-processing of the wrapping signature before actually using EST as defined in <span>[<a href="#RFC7030" class="cite xref">RFC7030</a>]</span>.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">There may be pledges that can support both modes, initiator and responder mode.
In these cases, BRSKI-PRM can be combined with BRSKI as defined in <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span> or BRSKI-AE <span>[<a href="#RFC9733" class="cite xref">RFC9733</a>]</span> to allow for more bootstrapping flexibility.
Providing information about capabilities of BRSKI components like the pledge or registrar is handled as part of the discovery. BRSKI-PRM relies only on a minimum necessary set of capabilities for the interaction and leaves the definition of more advanced mechanisms allowing to signal specific capabilities to <span>[<a href="#I-D.ietf-anima-brski-discovery" class="cite xref">I-D.ietf-anima-brski-discovery</a>]</span>.<a href="#section-1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">This document makes use of the terms defined in <span><a href="https://rfc-editor.org/rfc/rfc8995#section-1.2" class="relref">Section 1.2</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>.
The following terms are defined in addition:<a href="#section-2-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2-3">
        <dt id="section-2-3.1">authenticated self-contained object:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.2">
          <p id="section-2-3.2.1">Describes a data object, which is cryptographically bound to an end entity (EE) certificate.
The binding is assumed to be provided through a digital signature of the actual object using the corresponding private key of the certificate.<a href="#section-2-3.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.3">CA:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.4">
          <p id="section-2-3.4.1">Certification Authority.
An entity, which issues certificates and maintains certificate revocation information.<a href="#section-2-3.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.5">Commissioning tool:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.6">
          <p id="section-2-3.6.1">Tool to interact with devices to provide configuration data.<a href="#section-2-3.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.7">CSR:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.8">
          <p id="section-2-3.8.1">Certificate Signing Request, as defined in <span>[<a href="#RFC2986" class="cite xref">RFC2986</a>]</span>.<a href="#section-2-3.8.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.9">EE:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.10">
          <p id="section-2-3.10.1">End entity, as defined in <span>[<a href="#RFC9483" class="cite xref">RFC9483</a>]</span>.
Typically, a device or service that owns a public-private key pair for which it manages a public key certificate.<a href="#section-2-3.10.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.11">EE certificate:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.12">
          <p id="section-2-3.12.1">the certificate of the EE signed by its owner (e.g., CA).
For domain components, the EE certificate is signed by the domain owner.
For the pledge, the EE certificate is either the IDevID certificate signed by the manufacturer or the LDevID certificate signed by the domain owner or an application-specific EE certificate signed by the domain owner.<a href="#section-2-3.12.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.13">endpoint:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.14">
          <p id="section-2-3.14.1">Term equivalent to resource in HTTP <span>[<a href="#RFC9110" class="cite xref">RFC9110</a>]</span>.
Endpoints are accessible via Well-Known URIs <span>[<a href="#RFC8615" class="cite xref">RFC8615</a>]</span>.<a href="#section-2-3.14.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.15">IDevID:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.16">
          <p id="section-2-3.16.1">An Initial Device Identifier X.509 certificate installed by the vendor on new equipment.
This is a term from 802.1AR <span>[<a href="#IEEE-802.1AR" class="cite xref">IEEE-802.1AR</a>]</span>.<a href="#section-2-3.16.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.17">LDevID:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.18">
          <p id="section-2-3.18.1">A Local Device Identifier X.509 certificate installed by the owner of the equipment.
This is a term from 802.1AR <span>[<a href="#IEEE-802.1AR" class="cite xref">IEEE-802.1AR</a>]</span>.<a href="#section-2-3.18.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.19">mTLS:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.20">
          <p id="section-2-3.20.1">mutual Transport Layer Security, refers to mutual authenticated TLS as specified in <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>.<a href="#section-2-3.20.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.21">PER:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.22">
          <p id="section-2-3.22.1">Pledge Enroll-Request is a signature-wrapped CSR, signed by the pledge that requests enrollment to a domain via the Registrar-Agent.<a href="#section-2-3.22.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.23">POI:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.24">
          <p id="section-2-3.24.1">Proof-of-Identity, as defined in <span>[<a href="#RFC5272" class="cite xref">RFC5272</a>]</span>.<a href="#section-2-3.24.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.25">POP:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.26">
          <p id="section-2-3.26.1">Proof-of-Possession (of a private key), as defined in <span>[<a href="#RFC5272" class="cite xref">RFC5272</a>]</span>.<a href="#section-2-3.26.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.27">PVR:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.28">
          <p id="section-2-3.28.1">Pledge Voucher-Request is a signature-wrapped voucher-request, signed by the pledge that sends it to the domain registrar via the Registrar-Agent.<a href="#section-2-3.28.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.29">RA:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.30">
          <p id="section-2-3.30.1">Registration Authority, an optional system component to which a CA delegates certificate management functions such as authorization checks.
In BRSKI-PRM, this is a functionality of the domain registrar, as in BRSKI <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>.<a href="#section-2-3.30.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.31">Registrar-Agent:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.32">
          <p id="section-2-3.32.1">Component facilitating the data exchange between a pledge in responder mode and a domain registrar.<a href="#section-2-3.32.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.33">RVR:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.34">
          <p id="section-2-3.34.1">Registrar Voucher-Request is a signature-wrapped voucher-request, signed by the domain registrar that sends it to the MASA.
For BRSKI-PRM, it contains a copy of the original PVR received from the pledge.<a href="#section-2-3.34.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-2-4">This document uses the following encoding notations in the given JWS-signed artifact examples:<a href="#section-2-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2-5">
        <dt id="section-2-5.1">BASE64(OCTETS):</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.2">
          <p id="section-2-5.2.1">Denotes the base64 encoding of an octet sequence using the character set defined in <span><a href="https://rfc-editor.org/rfc/rfc4648#section-4" class="relref">Section 4</a> of [<a href="#RFC4648" class="cite xref">RFC4648</a>]</span> and without the inclusion of any line breaks, whitespace, or other additional characters.
Note that the base64 encoding of the empty octet sequence is the empty string.<a href="#section-2-5.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.3">BASE64URL(OCTETS):</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.4">
          <p id="section-2-5.4.1">Denotes the base64url encoding of an octet sequence, per <span><a href="https://rfc-editor.org/rfc/rfc7515#section-2" class="relref">Section 2</a> of [<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.<a href="#section-2-5.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.5">UTF8(STRING):</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.6">
          <p id="section-2-5.6.1">Denotes the octet sequence of the UTF-8 <span>[<a href="#RFC3629" class="cite xref">RFC3629</a>]</span> representation of STRING, per <span><a href="https://rfc-editor.org/rfc/rfc7515#section-1" class="relref">Section 1</a> of [<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.<a href="#section-2-5.6.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-2-6">This document includes many examples that would contain many long sequences of base64-encoded objects with no content directly comprehensible to a human reader.
In order to keep those examples short, they use the token <code>base64encodedvalue==</code> as a placeholder for base64 data.
The full base64 data is included in the appendices of this document.<a href="#section-2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="scope-of-solution">
<section id="section-3">
      <h2 id="name-scope-of-solution">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-scope-of-solution" class="section-name selfRef">Scope of Solution</a>
      </h2>
<div id="sup-env">
<section id="section-3.1">
        <h3 id="name-supported-environments-and-">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-supported-environments-and-" class="section-name selfRef">Supported Environments and Use Case Examples</a>
        </h3>
<p id="section-3.1-1">BRSKI-PRM is applicable to scenarios where pledges may have no direct connection to a domain registrar, may have no continuous connection, or require coordination of the pledge requests to be provided to a domain registrar.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">This can be motivated by pledges deployed in environments not yet connected to the operational customer domain network, e.g., at a building construction site, or environments intentionally disconnected from the Internet, e.g., critical industrial facilities.
Another example is the assembly of electrical cabinets, which are prepared in advance before the installation at a customer domain.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<div id="building-automation">
<section id="section-3.1.1">
          <h4 id="name-building-automation">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-building-automation" class="section-name selfRef">Building Automation</a>
          </h4>
<p id="section-3.1.1-1">In building automation, a typical use case exists where a detached building or the basement is equipped with sensors, actuators, and controllers, but with only limited or no connection to the central building management system.
This limited connectivity may exist during installation time or also during operation time.<a href="#section-3.1.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1.1-2">During the installation, for instance, a service technician collects the device-specific information from the basement network and provides them to the central building management system.
This could be done using a laptop, common mobile device, or dedicated commissioning tool to transport the information.
The service technician may successively collect device-specific information in different parts of the building before connecting to the domain registrar for bulk bootstrapping.<a href="#section-3.1.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1.1-3">A domain registrar may be part of the central building management system and already be operational in the installation network.
The central building management system can then provide operational parameters for the specific devices in the basement or other detached areas.
These operational parameters may comprise values and settings required in the operational phase of the sensors/actuators, among them a certificate issued by the operator to authenticate against other components and services.
These operational parameters are then provided to the devices in the basement facilitated by the service technician's laptop.
The Registrar-Agent, defined in this document, may be run on the technician's laptop to interact with pledges.<a href="#section-3.1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="infrastructure-isolation-policy">
<section id="section-3.1.2">
          <h4 id="name-infrastructure-isolation-po">
<a href="#section-3.1.2" class="section-number selfRef">3.1.2. </a><a href="#name-infrastructure-isolation-po" class="section-name selfRef">Infrastructure Isolation Policy</a>
          </h4>
<p id="section-3.1.2-1">This refers to any case in which the network infrastructure is normally isolated from the Internet as a matter of policy, most likely for security reasons.
In such a case, limited access to a domain registrar may be allowed in carefully controlled short periods of time, for example when a batch of new devices are deployed, but prohibited at other times.<a href="#section-3.1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="less-operational-security-in-the-target-domain">
<section id="section-3.1.3">
          <h4 id="name-less-operational-security-i">
<a href="#section-3.1.3" class="section-number selfRef">3.1.3. </a><a href="#name-less-operational-security-i" class="section-name selfRef">Less Operational Security in the Target-Domain</a>
          </h4>
<p id="section-3.1.3-1">The registration authority (RA) performing the authorization of a certificate request is a critical PKI component and therefore requires higher operational security than other components utilizing the issued certificates.
CAs may also require higher security in the registration procedures.
There may be situations in which the customer domain does not offer enough physical security to operate an RA/CA and therefore this service is transferred to a backend that offers a higher level of operational security.<a href="#section-3.1.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="potential-limitations">
<section id="section-3.2">
        <h3 id="name-potential-limitations">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-potential-limitations" class="section-name selfRef">Potential Limitations</a>
        </h3>
<p id="section-3.2-1">The mechanism described in this document presumes the ability of the pledge and the Registrar-Agent to communicate with one another.
This may not be possible in constrained environments where, in particular, power must be conserved.
In these situations, it is anticipated that the transceiver will be powered down most of the time.
This presents a rendezvous problem: the pledge is unavailable for certain periods of time, and the Registrar-Agent is similarly presumed to be unavailable for certain periods of time.
To overcome this situation, the pledges may need to be powered on, either manually or by sending a trigger signal.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="req-sol">
<section id="section-4">
      <h2 id="name-requirements-discussion-and">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-requirements-discussion-and" class="section-name selfRef">Requirements Discussion and Mapping to BRSKI-PRM Functional Elements</a>
      </h2>
<p id="section-4-1">Based on the intended target environment described in <a href="#sup-env" class="auto internal xref">Section 3.1</a>, the following boundary conditions are derived to support bootstrapping of pledges in responder mode (acting as server):<a href="#section-4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-2.1">
          <p id="section-4-2.1.1">To facilitate the communication between a pledge in responder mode and a registrar, additional functionality is needed either on the registrar or as a stand-alone component.
This new functionality is defined as Registrar-Agent and acts as an agent of the registrar to trigger the pledge to generate requests for voucher and enrollment.
These requests are then provided by the Registrar-Agent to the registrar.
This requires the definition of pledge endpoints to allow interaction with the Registrar-Agent.<a href="#section-4-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.2">
          <p id="section-4-2.2.1">The security of communication between the Registrar-Agent and the pledge does not rely on Transport Layer Security (TLS) to enable application of BRSKI-PRM in environments, in which the communication between the Registrar-Agent and the pledge is done over other technologies like BTLE or NFC, which may not support TLS protected communication.
In addition, the pledge does not have a certificate that can easily be verified by <span>[<a href="#RFC9525" class="cite xref">RFC9525</a>]</span> methods.<a href="#section-4-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.3">
          <p id="section-4-2.3.1">The use of authenticated self-contained objects addresses both, the TLS challenges and the technology stack challenge.<a href="#section-4-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.4">
          <p id="section-4-2.4.1">By contrast, the Registrar-Agent can be authenticated by the registrar as a component, acting on behalf of the registrar.
In addition, the registrar must be able to verify, which Registrar-Agent was in direct contact with the pledge.<a href="#section-4-2.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.5">
          <p id="section-4-2.5.1">It would be inaccurate for the voucher-request and voucher-response to use the assertion type <code>proximity</code> in the voucher, as the pledge was not in direct contact with the registrar for bootstrapping.
Therefore, a new assertion type is necessary for distinguishing assertions the MASA can state.<a href="#section-4-2.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-4-3">At least the following properties are required for the voucher and enrollment processing:<a href="#section-4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-4.1">
          <p id="section-4-4.1.1">POI: provides data-origin authentication of an artifact, e.g., a voucher-request or an Enroll-Request, utilizing an existing IDevID.
Certificate updates may utilize the certificate that is to be updated.<a href="#section-4-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-4.2">
          <p id="section-4-4.2.1">POP: proves that an entity possesses and controls the private key corresponding to the public key contained in the certification request, typically by adding a signature computed using the private key to the certification request.<a href="#section-4-4.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-4-5">Solution examples based on existing technology are provided with the focus on existing IETF RFCs:<a href="#section-4-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-6.1">
          <p id="section-4-6.1.1">Voucher-Requests and Vouchers as used in <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span> already provide both, POP and POI, through a digital signature to protect the integrity of the voucher, while the corresponding signing certificate contains the identity of the signer.<a href="#section-4-6.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-6.2">
          <p id="section-4-6.2.1">Enroll-Requests are data structures containing the information from a requester for a CA to create a certificate.
The certification request format in BRSKI is PKCS#10 <span>[<a href="#RFC2986" class="cite xref">RFC2986</a>]</span>.
In PKCS#10, the structure is signed to ensure integrity protection and POP of the private key of the requester that corresponds to the contained public key.
In the application examples, this POP alone is not sufficient.
A POI is also required for the certification request and therefore the certification request needs to be additionally bound to the existing pledge IDevID credential.
This binding supports the authorization decision for the certification request and may be provided directly with the certification request.
While BRSKI uses the binding to TLS, BRSKI-PRM aims at an additional signature of the PKCS#10 using existing credentials on the pledge (IDevID). This allows the process to be independent of the selected transport.<a href="#section-4-6.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="architecture">
<section id="section-5">
      <h2 id="name-solution-architecture">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-solution-architecture" class="section-name selfRef">Solution Architecture</a>
      </h2>
<div id="overview">
<section id="section-5.1">
        <h3 id="name-overview">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
        </h3>
<p id="section-5.1-1">For BRSKI-PRM, the base system architecture defined in BRSKI <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span> is enhanced to facilitate new use cases in which the pledge acts as server.
The responder mode allows delegated bootstrapping using a Registrar-Agent instead of a direct connection between the pledge and the domain registrar.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">Necessary enhancements to support authenticated self-contained objects for certificate enrollment are kept at a minimum to enable reuse of already defined architecture elements and interactions.
The format of the bootstrapping objects produced or consumed by the pledge is usually based on JSON Web Signature (JWS) <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span> and further specified in <a href="#exchanges" class="auto internal xref">Section 7</a> to address the requirements stated in <a href="#req-sol" class="auto internal xref">Section 4</a>.
In constrained environments, it may be based on COSE <span>[<a href="#RFC9052" class="cite xref">RFC9052</a>]</span>.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">An abstract overview of the BRSKI-PRM protocol can be found on slide 8 of <span>[<a href="#BRSKI-PRM-abstract" class="cite xref">BRSKI-PRM-abstract</a>]</span>.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">To support mutual trust establishment between the domain registrar and pledges not directly connected to the customer domain, this document specifies the exchange of authenticated self-contained objects with the help of the Registrar-Agent.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1-5">This leads to extensions of the logical components in the BRSKI architecture as shown in <a href="#uc2figure" class="auto internal xref">Figure 1</a>.<a href="#section-5.1-5" class="pilcrow">¶</a></p>
<p id="section-5.1-6">Note that the Join Proxy is not shown in the figure.
In certain situations the Join Proxy may still be present and could be used by the Registrar-Agent to connect to the Registrar.
For example, a Registrar-Agent application on a smartphone often can connect to local Wi-Fi without giving up their cellular network connection <span>[<a href="#androidnsd" class="cite xref">androidnsd</a>]</span>, but only can make link-local connections.<a href="#section-5.1-6" class="pilcrow">¶</a></p>
<p id="section-5.1-7">The Registrar-Agent interacts with the pledge to transfer the required data objects for bootstrapping, which are then also exchanged between the Registrar-Agent and the domain registrar.
The addition of the Registrar-Agent influences the sequences of the data exchange between the pledge and the domain registrar described in <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>.
To enable reuse of BRSKI defined functionality as much as possible, BRSKI-PRM:<a href="#section-5.1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-8.1">
            <p id="section-5.1-8.1.1">uses existing endpoints where the required functionality is provided.<a href="#section-5.1-8.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-8.2">
            <p id="section-5.1-8.2.1">enhances existing endpoints with new supported media types, e.g., for JWS voucher.<a href="#section-5.1-8.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-8.3">
            <p id="section-5.1-8.3.1">defines new endpoints where additional functionality is required, e.g., for wrapped certification request, wrapped CA certificates, and new status information.<a href="#section-5.1-8.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<span id="name-brski-prm-architecture-over"></span><div id="uc2figure">
<figure id="figure-1">
          <div id="section-5.1-9.1">
            <div class="alignCenter art-svg artwork" id="section-5.1-9.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="464" width="456" viewBox="0 0 456 464" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,240 L 8,384" fill="none" stroke="black"></path>
                <path d="M 80,240 L 80,384" fill="none" stroke="black"></path>
                <path d="M 152,240 L 152,336" fill="none" stroke="black"></path>
                <path d="M 208,32 L 208,144" fill="none" stroke="black"></path>
                <path d="M 224,368 L 224,416" fill="none" stroke="black"></path>
                <path d="M 256,240 L 256,336" fill="none" stroke="black"></path>
                <path d="M 328,240 L 328,336" fill="none" stroke="black"></path>
                <path d="M 336,64 L 336,144" fill="none" stroke="black"></path>
                <path d="M 376,152 L 376,232" fill="none" stroke="black"></path>
                <path d="M 376,336 L 376,368" fill="none" stroke="black"></path>
                <path d="M 424,240 L 424,336" fill="none" stroke="black"></path>
                <path d="M 424,368 L 424,416" fill="none" stroke="black"></path>
                <path d="M 432,32 L 432,144" fill="none" stroke="black"></path>
                <path d="M 208,32 L 432,32" fill="none" stroke="black"></path>
                <path d="M 208,64 L 432,64" fill="none" stroke="black"></path>
                <path d="M 208,144 L 432,144" fill="none" stroke="black"></path>
                <path d="M 8,240 L 80,240" fill="none" stroke="black"></path>
                <path d="M 152,240 L 256,240" fill="none" stroke="black"></path>
                <path d="M 328,240 L 424,240" fill="none" stroke="black"></path>
                <path d="M 88,304 L 144,304" fill="none" stroke="black"></path>
                <path d="M 264,304 L 320,304" fill="none" stroke="black"></path>
                <path d="M 152,336 L 256,336" fill="none" stroke="black"></path>
                <path d="M 328,336 L 424,336" fill="none" stroke="black"></path>
                <path d="M 224,368 L 424,368" fill="none" stroke="black"></path>
                <path d="M 8,384 L 80,384" fill="none" stroke="black"></path>
                <path d="M 224,416 L 424,416" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="384,232 372,226.4 372,237.6" fill="black" transform="rotate(90,376,232)"></polygon>
                <polygon class="arrowhead" points="384,152 372,146.4 372,157.6" fill="black" transform="rotate(270,376,152)"></polygon>
                <polygon class="arrowhead" points="328,304 316,298.4 316,309.6" fill="black" transform="rotate(0,320,304)"></polygon>
                <polygon class="arrowhead" points="272,304 260,298.4 260,309.6" fill="black" transform="rotate(180,264,304)"></polygon>
                <polygon class="arrowhead" points="152,304 140,298.4 140,309.6" fill="black" transform="rotate(0,144,304)"></polygon>
                <polygon class="arrowhead" points="96,304 84,298.4 84,309.6" fill="black" transform="rotate(180,88,304)"></polygon>
                <g class="text">
                  <text x="56" y="52">.....</text>
                  <text x="100" y="52">Drop</text>
                  <text x="140" y="52">Ship</text>
                  <text x="184" y="52">.....</text>
                  <text x="244" y="52">Vendor</text>
                  <text x="308" y="52">Services</text>
                  <text x="40" y="68">:</text>
                  <text x="40" y="84">:</text>
                  <text x="224" y="84">M</text>
                  <text x="280" y="84">anufacturer</text>
                  <text x="40" y="100">:</text>
                  <text x="224" y="100">A</text>
                  <text x="272" y="100">uthorized</text>
                  <text x="384" y="100">Ownership</text>
                  <text x="40" y="116">:</text>
                  <text x="224" y="116">S</text>
                  <text x="260" y="116">igning</text>
                  <text x="376" y="116">Tracker</text>
                  <text x="40" y="132">:</text>
                  <text x="224" y="132">A</text>
                  <text x="268" y="132">uthority</text>
                  <text x="40" y="148">:</text>
                  <text x="40" y="164">:</text>
                  <text x="40" y="180">:</text>
                  <text x="412" y="180">BRSKI-</text>
                  <text x="40" y="196">:</text>
                  <text x="404" y="196">MASA</text>
                  <text x="40" y="212">:</text>
                  <text x="248" y="212">...............................</text>
                  <text x="416" y="212">.........</text>
                  <text x="40" y="228">V</text>
                  <text x="128" y="228">.</text>
                  <text x="448" y="228">.</text>
                  <text x="128" y="244">.</text>
                  <text x="448" y="244">.</text>
                  <text x="128" y="260">.</text>
                  <text x="448" y="260">.</text>
                  <text x="44" y="276">Pledge</text>
                  <text x="116" y="276">BRSKI-</text>
                  <text x="204" y="276">Registrar-</text>
                  <text x="292" y="276">BRSKI-</text>
                  <text x="364" y="276">Domain</text>
                  <text x="448" y="276">.</text>
                  <text x="112" y="292">PRM</text>
                  <text x="184" y="292">Agent</text>
                  <text x="288" y="292">PRM</text>
                  <text x="376" y="292">Registrar</text>
                  <text x="448" y="292">.</text>
                  <text x="448" y="308">.</text>
                  <text x="128" y="324">.</text>
                  <text x="188" y="324">EE</text>
                  <text x="224" y="324">cert.</text>
                  <text x="356" y="324">EE</text>
                  <text x="392" y="324">cert.</text>
                  <text x="448" y="324">.</text>
                  <text x="128" y="340">.</text>
                  <text x="448" y="340">.</text>
                  <text x="44" y="356">IDevID</text>
                  <text x="128" y="356">.</text>
                  <text x="448" y="356">.</text>
                  <text x="128" y="372">.</text>
                  <text x="448" y="372">.</text>
                  <text x="128" y="388">.</text>
                  <text x="248" y="388">Key</text>
                  <text x="324" y="388">Infrastructure</text>
                  <text x="448" y="388">.</text>
                  <text x="128" y="404">.</text>
                  <text x="260" y="404">(e.g.,</text>
                  <text x="304" y="404">PKI</text>
                  <text x="336" y="404">CA)</text>
                  <text x="448" y="404">.</text>
                  <text x="128" y="420">.</text>
                  <text x="448" y="420">.</text>
                  <text x="288" y="436">.........................................</text>
                  <text x="260" y="452">Customer</text>
                  <text x="324" y="452">Domain</text>
                </g>
              </svg><a href="#section-5.1-9.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-brski-prm-architecture-over" class="selfRef">BRSKI-PRM architecture overview using Registrar-Agent</a>
          </figcaption></figure>
</div>
<p id="section-5.1-10"><a href="#uc2figure" class="auto internal xref">Figure 1</a> shows the relations between the following main components:<a href="#section-5.1-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-11.1">
            <p id="section-5.1-11.1.1">Pledge: Is expected to respond with the necessary data objects for bootstrapping to a Registrar-Agent.
The protocol used between the pledge and the Registrar-Agent is assumed to be HTTP(S) in the context of this document.
Any other protocol can be used as long as it supports the exchange of the necessary artifacts.
This includes CoAP or protocols to be used over Bluetooth or NFC connections.
A pledge acting as server leads to the following differences compared to BRSKI <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>:<a href="#section-5.1-11.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-11.1.2.1">
                <p id="section-5.1-11.1.2.1.1">The pledge no longer initiates bootstrapping, but is discovered and triggered by a Registrar-Agent as defined in <a href="#discovery_uc2_ppa" class="auto internal xref">Section 6.1.2</a>.<a href="#section-5.1-11.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.1-11.1.2.2">
                <p id="section-5.1-11.1.2.2.1">The pledge offers additional endpoints as defined in <a href="#pledge_component" class="auto internal xref">Section 6.2</a>, so that a Registrar-Agent can request data required for bootstrapping the pledge.<a href="#section-5.1-11.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.1-11.1.2.3">
                <p id="section-5.1-11.1.2.3.1">The pledge includes additional data in the PVR, which is provided and signed by a Registrar-Agent as defined in <a href="#tpvr" class="auto internal xref">Section 7.1</a>.
This allows the registrar to identify with which Registrar-Agent the pledge was in contact (see <a href="#agt_prx" class="auto internal xref">Section 5.4</a>).<a href="#section-5.1-11.1.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.1-11.1.2.4">
                <p id="section-5.1-11.1.2.4.1">The artifacts exchanged between the pledge and the registrar via the Registrar-Agent are authenticated self-contained objects (i.e., signature-wrapped artifacts).<a href="#section-5.1-11.1.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-5.1-11.2">
            <p id="section-5.1-11.2.1">Registrar-Agent: Is a new component defined in <a href="#agent_component" class="auto internal xref">Section 6.1</a> that provides a store and forward communication path to exchange data objects between the pledge and a domain registrar.
This is for situations in which a domain registrar is not directly reachable by the pledge, which may be due to a different technology stacks or due to missing connectivity.
A Registrar-Agent acting as client leads to the following new aspects:<a href="#section-5.1-11.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-11.2.2.1">
                <p id="section-5.1-11.2.2.1.1">The order of exchanges in the BRSKI-PRM call flow is different from that in BRSKI <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>, as the Registrar-Agent can trigger one or more pledges and collects the PVR and PER artifacts simultaneously as defined in <a href="#exchanges" class="auto internal xref">Section 7</a>.
This enables bulk bootstrapping of several devices.<a href="#section-5.1-11.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.1-11.2.2.2">
                <p id="section-5.1-11.2.2.2.1">There is no trust assumption between the pledge and the Registrar-Agent as only authenticated self-contained objects are used, which are transported via the Registrar-Agent and provided either by the pledge or the domain registrar.<a href="#section-5.1-11.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.1-11.2.2.3">
                <p id="section-5.1-11.2.2.3.1">The trust assumption between the Registrar-Agent and the domain registrar may be based on EE certificates that are both signed by the domain owner.<a href="#section-5.1-11.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.1-11.2.2.4">
                <p id="section-5.1-11.2.2.4.1">The Registrar-Agent may be realized as stand-alone component supporting nomadic activities of a service technician moving between different installation sites.<a href="#section-5.1-11.2.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.1-11.2.2.5">
                <p id="section-5.1-11.2.2.5.1">Alternatively, the Registrar-Agent may also be realized as co-located functionality for a registrar, to support pledges in responder mode.<a href="#section-5.1-11.2.2.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-5.1-11.3">
            <p id="section-5.1-11.3.1">Join Proxy (not shown): Has the same functionality as described in <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span> if needed.
Note that a Registrar-Agent may use a join proxy to facilitate the TLS connection to the registrar in the same way that a BRSKI pledge would use a join proxy. This is useful in cases where the Registrar-Agent does not have full IP connectivity via the domain network or cases where it has no other means to locate the registrar on the network.<a href="#section-5.1-11.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-11.4">
            <p id="section-5.1-11.4.1">Domain registrar: In general fulfills the same functionality regarding the bootstrapping of the pledge in a customer domain by facilitating the communication of the pledge with the MASA service and the domain key infrastructure (PKI).
However, there are also differences compared to BRSKI <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>:<a href="#section-5.1-11.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-11.4.2.1">
                <p id="section-5.1-11.4.2.1.1">A BRSKI-PRM domain registrar does not interact with a pledge directly, but through the Registrar-Agent as defined in <a href="#exchanges" class="auto internal xref">Section 7</a>.<a href="#section-5.1-11.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.1-11.4.2.2">
                <p id="section-5.1-11.4.2.2.1">A BRSKI-PRM domain registrar offers additional endpoints as defined in <a href="#registrar_component" class="auto internal xref">Section 6.3</a> to support the signature-wrapped artifacts used by BRSKI-PRM.<a href="#section-5.1-11.4.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-5.1-11.5">
            <p id="section-5.1-11.5.1">Vendor services: Encompass MASA and Ownership Tracker and are used as defined in <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>.
A MASA responsible for pledges that implement BRSKI-PRM is expected to support BRSKI-PRM extensions:<a href="#section-5.1-11.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-11.5.2.1">
                <p id="section-5.1-11.5.2.1.1">The default format for voucher artifacts (incl. voucher-request) is JWS-signed JSON as defined in <span>[<a href="#I-D.ietf-anima-jws-voucher" class="cite xref">I-D.ietf-anima-jws-voucher</a>]</span>.<a href="#section-5.1-11.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.1-11.5.2.2">
                <p id="section-5.1-11.5.2.2.1">The Agent Proximity Assertion (see <a href="#agt_prx" class="auto internal xref">Section 5.4</a>) requires additional validation steps as defined in <a href="#masa_interaction" class="auto internal xref">Section 7.3.1</a>.<a href="#section-5.1-11.5.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
<div id="arch_nomadic">
<section id="section-5.2">
        <h3 id="name-nomadic-connectivity">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-nomadic-connectivity" class="section-name selfRef">Nomadic Connectivity</a>
        </h3>
<p id="section-5.2-1">In one example instance of the PRM architecture as shown in <a href="#uc3figure" class="auto internal xref">Figure 2</a>, there is no connectivity between the location in which the pledge is installed and the location of the domain registrar.
This is often the case in the building automation use case mentioned in (<a href="#building-automation" class="auto internal xref">Section 3.1.1</a>).<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<span id="name-registrar-agent-nomadic-con"></span><div id="uc3figure">
<figure id="figure-2">
          <div id="section-5.2-2.1">
            <div class="alignCenter art-svg artwork" id="section-5.2-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="496" width="464" viewBox="0 0 464 496" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 24,128 L 24,176" fill="none" stroke="black"></path>
                <path d="M 96,128 L 96,176" fill="none" stroke="black"></path>
                <path d="M 208,32 L 208,64" fill="none" stroke="black"></path>
                <path d="M 224,400 L 224,448" fill="none" stroke="black"></path>
                <path d="M 336,320 L 336,368" fill="none" stroke="black"></path>
                <path d="M 384,72 L 384,312" fill="none" stroke="black"></path>
                <path d="M 384,368 L 384,400" fill="none" stroke="black"></path>
                <path d="M 432,32 L 432,64" fill="none" stroke="black"></path>
                <path d="M 432,320 L 432,368" fill="none" stroke="black"></path>
                <path d="M 432,400 L 432,448" fill="none" stroke="black"></path>
                <path d="M 208,32 L 432,32" fill="none" stroke="black"></path>
                <path d="M 208,64 L 432,64" fill="none" stroke="black"></path>
                <path d="M 24,128 L 96,128" fill="none" stroke="black"></path>
                <path d="M 104,160 L 184,160" fill="none" stroke="black"></path>
                <path d="M 24,176 L 96,176" fill="none" stroke="black"></path>
                <path d="M 336,320 L 432,320" fill="none" stroke="black"></path>
                <path d="M 272,352 L 328,352" fill="none" stroke="black"></path>
                <path d="M 336,368 L 432,368" fill="none" stroke="black"></path>
                <path d="M 224,400 L 432,400" fill="none" stroke="black"></path>
                <path d="M 224,448 L 432,448" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="392,312 380,306.4 380,317.6" fill="black" transform="rotate(90,384,312)"></polygon>
                <polygon class="arrowhead" points="392,72 380,66.4 380,77.6" fill="black" transform="rotate(270,384,72)"></polygon>
                <polygon class="arrowhead" points="336,352 324,346.4 324,357.6" fill="black" transform="rotate(0,328,352)"></polygon>
                <polygon class="arrowhead" points="280,352 268,346.4 268,357.6" fill="black" transform="rotate(180,272,352)"></polygon>
                <polygon class="arrowhead" points="192,160 180,154.4 180,165.6" fill="black" transform="rotate(0,184,160)"></polygon>
                <polygon class="arrowhead" points="112,160 100,154.4 100,165.6" fill="black" transform="rotate(180,104,160)"></polygon>
                <g class="text">
                  <text x="56" y="52">.....</text>
                  <text x="100" y="52">Drop</text>
                  <text x="140" y="52">Ship</text>
                  <text x="184" y="52">.....</text>
                  <text x="244" y="52">Vendor</text>
                  <text x="308" y="52">Services</text>
                  <text x="40" y="68">:</text>
                  <text x="40" y="84">:</text>
                  <text x="164" y="100">........................................</text>
                  <text x="8" y="116">.</text>
                  <text x="40" y="116">v</text>
                  <text x="320" y="116">.</text>
                  <text x="8" y="132">.</text>
                  <text x="248" y="132">.-.-.-.-.-.-.-.</text>
                  <text x="320" y="132">.</text>
                  <text x="8" y="148">.</text>
                  <text x="144" y="148">BRSKI-PRM</text>
                  <text x="192" y="148">:</text>
                  <text x="244" y="148">Registrar-</text>
                  <text x="304" y="148">:</text>
                  <text x="320" y="148">.</text>
                  <text x="8" y="164">.</text>
                  <text x="60" y="164">Pledge</text>
                  <text x="192" y="164">:</text>
                  <text x="224" y="164">Agent</text>
                  <text x="304" y="164">:</text>
                  <text x="320" y="164">.</text>
                  <text x="8" y="180">.</text>
                  <text x="116" y="180">L2</text>
                  <text x="140" y="180">or</text>
                  <text x="164" y="180">L3</text>
                  <text x="248" y="180">:-.-.-.-.-.-.-:</text>
                  <text x="320" y="180">.</text>
                  <text x="420" y="180">BRSKI-</text>
                  <text x="8" y="196">.</text>
                  <text x="140" y="196">connectivity</text>
                  <text x="216" y="196">^</text>
                  <text x="320" y="196">.</text>
                  <text x="412" y="196">MASA</text>
                  <text x="164" y="212">..........................!.............</text>
                  <text x="52" y="228">Pledge</text>
                  <text x="132" y="228">Installation</text>
                  <text x="216" y="228">!</text>
                  <text x="60" y="244">Location</text>
                  <text x="216" y="244">!</text>
                  <text x="256" y="244">Nomadic</text>
                  <text x="216" y="260">!</text>
                  <text x="276" y="260">connectivity</text>
                  <text x="216" y="276">!</text>
                  <text x="252" y="292">...........!....................</text>
                  <text x="424" y="292">.........</text>
                  <text x="128" y="308">.</text>
                  <text x="216" y="308">v</text>
                  <text x="456" y="308">.</text>
                  <text x="128" y="324">.</text>
                  <text x="208" y="324">.-.-.-.-.-.-.-.</text>
                  <text x="300" y="324">BRSKI-</text>
                  <text x="456" y="324">.</text>
                  <text x="128" y="340">.</text>
                  <text x="152" y="340">:</text>
                  <text x="204" y="340">Registrar-</text>
                  <text x="264" y="340">:</text>
                  <text x="296" y="340">PRM</text>
                  <text x="372" y="340">Domain</text>
                  <text x="456" y="340">.</text>
                  <text x="128" y="356">.</text>
                  <text x="152" y="356">:</text>
                  <text x="184" y="356">Agent</text>
                  <text x="264" y="356">:</text>
                  <text x="384" y="356">Registrar</text>
                  <text x="456" y="356">.</text>
                  <text x="128" y="372">.</text>
                  <text x="208" y="372">:-.-.-.-.-.-.-:</text>
                  <text x="456" y="372">.</text>
                  <text x="128" y="388">.</text>
                  <text x="456" y="388">.</text>
                  <text x="128" y="404">.</text>
                  <text x="456" y="404">.</text>
                  <text x="128" y="420">.</text>
                  <text x="248" y="420">Key</text>
                  <text x="324" y="420">Infrastructure</text>
                  <text x="456" y="420">.</text>
                  <text x="128" y="436">.</text>
                  <text x="260" y="436">(e.g.,</text>
                  <text x="304" y="436">PKI</text>
                  <text x="336" y="436">CA)</text>
                  <text x="456" y="436">.</text>
                  <text x="128" y="452">.</text>
                  <text x="456" y="452">.</text>
                  <text x="292" y="468">..........................................</text>
                  <text x="260" y="484">Customer</text>
                  <text x="324" y="484">Domain</text>
                </g>
              </svg><a href="#section-5.2-2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-registrar-agent-nomadic-con" class="selfRef">Registrar-Agent nomadic connectivity example</a>
          </figcaption></figure>
</div>
<p id="section-5.2-3">BRSKI-PRM enables support of this case through nomadic connectivity of the Registrar-Agent.
To perform enrollment in this setup, multiple round trips of the Registrar-Agent between the pledge installation location and the domain registrar are required.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.2-4">
<li id="section-5.2-4.1">
            <p id="section-5.2-4.1.1">Connectivity to domain registrar: preparation tasks for pledge bootstrapping not part of the BRSKI-PRM protocol definition, like retrieval of list of pledges to enroll.<a href="#section-5.2-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.2-4.2">
            <p id="section-5.2-4.2.1">Connectivity to pledge installation location: retrieve information about available pledges (IDevID), collect request objects (i.e., Pledge Voucher-Requests and Pledge Enroll-Requests using the BRSKI-PRM approach described in <a href="#tpvr" class="auto internal xref">Section 7.1</a> and <a href="#tper" class="auto internal xref">Section 7.2</a>).<a href="#section-5.2-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.2-4.3">
            <p id="section-5.2-4.3.1">Connectivity to domain registrar, submit collected request information of pledges, retrieve response objects (i.e., Voucher and Enroll-Response) using the BRSKI-PRM approach described in <a href="#pvr" class="auto internal xref">Section 7.3</a> and <a href="#per" class="auto internal xref">Section 7.4</a>.<a href="#section-5.2-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.2-4.4">
            <p id="section-5.2-4.4.1">Connectivity to pledge installation location, provide retrieved objects to the pledges to enroll pledges and collect status using the BRSKI-PRM approach described in <a href="#voucher" class="auto internal xref">Section 7.6</a>, <a href="#cacerts" class="auto internal xref">Section 7.7</a>, and <a href="#enroll_response" class="auto internal xref">Section 7.8</a>.<a href="#section-5.2-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.2-4.5">
            <p id="section-5.2-4.5.1">Connectivity to domain registrar, submit Voucher Status and Enrollment Status using the BRSKI-PRM approach described in <a href="#vstatus" class="auto internal xref">Section 7.9</a> and <a href="#estatus" class="auto internal xref">Section 7.10</a>.<a href="#section-5.2-4.5.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-5.2-5">Variations of this setup include cases where the Registrar-Agent uses for example, WiFi to connect to the pledge installation network, and mobile network connectivity to connect to the domain registrar.
Both connections may also be possible in a single location at the same time, based on installation building conditions.<a href="#section-5.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="colo-regagt">
<section id="section-5.3">
        <h3 id="name-co-located-registrar-agent-">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-co-located-registrar-agent-" class="section-name selfRef">Co-located Registrar-Agent and Domain Registrar</a>
        </h3>
<p id="section-5.3-1">Compared to <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span> BRSKI, pledges supporting BRSKI-PRM can be completely passive and only need to react when being requested to react by a Registrar-Agent.
In <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>, pledges instead need to continuously interact with a domain registrar during onboarding, through discovery, voucher exchange, and enrollment. 
This may increase the load on the domain registrar, specifically, if a larger number of pledges onboards simultaneously.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<span id="name-registrar-agent-integrated-"></span><div id="uc4figure">
<figure id="figure-3">
          <div id="section-5.3-2.1">
            <div class="alignCenter art-svg artwork" id="section-5.3-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="352" width="464" viewBox="0 0 464 352" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,160 L 8,208" fill="none" stroke="black"></path>
                <path d="M 80,160 L 80,208" fill="none" stroke="black"></path>
                <path d="M 200,32 L 200,64" fill="none" stroke="black"></path>
                <path d="M 208,144 L 208,224" fill="none" stroke="black"></path>
                <path d="M 216,256 L 216,288" fill="none" stroke="black"></path>
                <path d="M 368,72 L 368,136" fill="none" stroke="black"></path>
                <path d="M 368,224 L 368,256" fill="none" stroke="black"></path>
                <path d="M 416,144 L 416,224" fill="none" stroke="black"></path>
                <path d="M 416,256 L 416,288" fill="none" stroke="black"></path>
                <path d="M 424,32 L 424,64" fill="none" stroke="black"></path>
                <path d="M 200,32 L 424,32" fill="none" stroke="black"></path>
                <path d="M 200,64 L 424,64" fill="none" stroke="black"></path>
                <path d="M 208,144 L 416,144" fill="none" stroke="black"></path>
                <path d="M 8,160 L 80,160" fill="none" stroke="black"></path>
                <path d="M 88,192 L 200,192" fill="none" stroke="black"></path>
                <path d="M 8,208 L 80,208" fill="none" stroke="black"></path>
                <path d="M 208,224 L 416,224" fill="none" stroke="black"></path>
                <path d="M 216,256 L 416,256" fill="none" stroke="black"></path>
                <path d="M 216,288 L 416,288" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="376,136 364,130.4 364,141.6" fill="black" transform="rotate(90,368,136)"></polygon>
                <polygon class="arrowhead" points="376,72 364,66.4 364,77.6" fill="black" transform="rotate(270,368,72)"></polygon>
                <polygon class="arrowhead" points="208,192 196,186.4 196,197.6" fill="black" transform="rotate(0,200,192)"></polygon>
                <polygon class="arrowhead" points="96,192 84,186.4 84,197.6" fill="black" transform="rotate(180,88,192)"></polygon>
                <g class="text">
                  <text x="48" y="52">.....</text>
                  <text x="92" y="52">Drop</text>
                  <text x="132" y="52">Ship</text>
                  <text x="176" y="52">.....</text>
                  <text x="236" y="52">Vendor</text>
                  <text x="296" y="52">Service</text>
                  <text x="32" y="68">:</text>
                  <text x="32" y="84">:</text>
                  <text x="32" y="100">:</text>
                  <text x="420" y="100">BRSKI-MASA</text>
                  <text x="32" y="116">:</text>
                  <text x="240" y="116">...............................</text>
                  <text x="408" y="116">.........</text>
                  <text x="32" y="132">:</text>
                  <text x="120" y="132">.</text>
                  <text x="440" y="132">.</text>
                  <text x="32" y="148">v</text>
                  <text x="120" y="148">.</text>
                  <text x="440" y="148">.</text>
                  <text x="120" y="164">.</text>
                  <text x="156" y="164">BRSKI-</text>
                  <text x="268" y="164">..............</text>
                  <text x="440" y="164">.</text>
                  <text x="120" y="180">.</text>
                  <text x="152" y="180">PRM</text>
                  <text x="216" y="180">.</text>
                  <text x="268" y="180">Registrar-</text>
                  <text x="320" y="180">.</text>
                  <text x="356" y="180">Domain</text>
                  <text x="440" y="180">.</text>
                  <text x="44" y="196">Pledge</text>
                  <text x="216" y="196">.</text>
                  <text x="248" y="196">Agent</text>
                  <text x="320" y="196">.</text>
                  <text x="368" y="196">Registrar</text>
                  <text x="440" y="196">.</text>
                  <text x="100" y="212">L2</text>
                  <text x="124" y="212">or</text>
                  <text x="148" y="212">L3</text>
                  <text x="268" y="212">..............</text>
                  <text x="440" y="212">.</text>
                  <text x="140" y="228">connectivity</text>
                  <text x="440" y="228">.</text>
                  <text x="120" y="244">.</text>
                  <text x="440" y="244">.</text>
                  <text x="120" y="260">.</text>
                  <text x="440" y="260">.</text>
                  <text x="120" y="276">.</text>
                  <text x="240" y="276">Key</text>
                  <text x="316" y="276">Infrastructure</text>
                  <text x="440" y="276">.</text>
                  <text x="120" y="292">.</text>
                  <text x="440" y="292">.</text>
                  <text x="280" y="308">.........................................</text>
                  <text x="252" y="324">Customer</text>
                  <text x="316" y="324">Domain</text>
                </g>
              </svg><a href="#section-5.3-2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-registrar-agent-integrated-" class="selfRef">Registrar-Agent integrated into Domain Registrar example</a>
          </figcaption></figure>
</div>
<p id="section-5.3-3">The benefits of BRSKI-PRM can be achieved even without the operational complexity of stand-alone Registrar-Agents by integrating the necessary functionality of the Registrar-Agent as a module into the domain registrar as shown in <a href="#uc4figure" class="auto internal xref">Figure 3</a> so that it can support the BRSKI-PRM communications to the pledge.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="agt_prx">
<section id="section-5.4">
        <h3 id="name-agent-proximity-assertion">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-agent-proximity-assertion" class="section-name selfRef">Agent Proximity Assertion</a>
        </h3>
<p id="section-5.4-1">"Agent proximity" is a statement in the PVR and the voucher that the registrar communicates via a Registrar-Agent as defined in <a href="#exchanges" class="auto internal xref">Section 7</a> and not directly to the pledge.
It is therefore a different assertion than "network proximity", which is defined in <span><a href="https://rfc-editor.org/rfc/rfc8995#section-3" class="relref">Section 3</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>.
Hence, <span>[<a href="#I-D.ietf-anima-rfc8366bis" class="cite xref">I-D.ietf-anima-rfc8366bis</a>]</span> defines the additional assertion type <code>agent-proximity</code>.
This assertion type can be verified by the registrar and MASA during BRSKI-PRM voucher-request processing.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<p id="section-5.4-2">In BRSKI, the pledge verifies POP of the registrar end-entity (EE) credentials via the TLS handshake and pins that public key as the <code>proximity-registrar-cert</code> into the voucher request.
This allows the MASA to verify the proximity of the pledge and registrar, facilitating a decision to assign the pledge to that domain owner.
In BRSKI, the TLS session is considered provisional until the pledge receives the voucher to verify POI.<a href="#section-5.4-2" class="pilcrow">¶</a></p>
<p id="section-5.4-3">In contrast, in BRSKI-PRM the pledge has no direct connection to the registrar and <span class="bcp14">MUST</span> accept the supplied registrar EE certificate provisionally until it receives the voucher as described in <a href="#voucher" class="auto internal xref">Section 7.6</a> to verify both POP and POI.
The provisional registrar EE certificate is used for the object security along the authenticated self-contained objects that in BRSKI-PRM replace the direct TLS connection to the registrar available in BRSKI <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>.
See also <span><a href="https://rfc-editor.org/rfc/rfc8995#section-5" class="relref">Section 5</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span> on "provisional state".<a href="#section-5.4-3" class="pilcrow">¶</a></p>
<p id="section-5.4-4">For the Agent Proximity Assertion, the Registrar-Agent EE certificate and registrar EE certificate must be signed by the same domain owner, i.e., <span class="bcp14">MUST</span> possess a common domain trust anchor in their certificate chain.
Akin to the Network Proximity Assertion in BRSKI <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>, the Agent Proximity Assertion provides pledge proximity evidence to the MASA.
But additionally, the Agent Proximity Assertion allows the domain registrar to be sure that the PVR supplied by the Registrar-Agent was in fact collected by the Registrar-Agent to which the registrar is connected by utilizing an agent-signed data object.<a href="#section-5.4-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="system-components">
<section id="section-6">
      <h2 id="name-system-components">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-system-components" class="section-name selfRef">System Components</a>
      </h2>
<div id="agent_component">
<section id="section-6.1">
        <h3 id="name-registrar-agent">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-registrar-agent" class="section-name selfRef">Registrar-Agent</a>
        </h3>
<p id="section-6.1-1">The Registrar-Agent uses its own EE certificate and corresponding credentials (i.e., private key) for TLS client authentication and for signing agent-signed data objects.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">The Registrar-Agent EE certificate <span class="bcp14">MUST</span> include a SubjectKeyIdentifier as defined in <span><a href="https://rfc-editor.org/rfc/rfc5280#section-4.2.1.2" class="relref">Section 4.2.1.2</a> of [<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>, which is used as a reference within agent-signed data objects as defined in <a href="#jws-asd" class="auto internal xref">Section 7.1.1.1</a>.
Note that this is an additional requirement for issuing the Registrar-Agent EE certificate.
<span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span> has a similar requirement for the registrar EE certificate.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">The SubjectKeyIdentifier is used in favor of providing the complete Registrar-Agent EE certificate in agent-signed data objects to accommodate also constrained environments and reduce bandwidth needed for communication with the pledge.
In addition, it follows the recommendation from BRSKI to use SubjectKeyIdentifier in favor of a certificate fingerprint to avoid additional computations.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">The provisioning of the Registrar-Agent EE certificate is out of scope for this document, but may be done using its own BRSKI run or by other means such as configuration.
It is <span class="bcp14">RECOMMENDED</span> to use short-lived Registrar-Agent EE certificates in the range of days or weeks. 
This is to address the assumed nature of stand-alone Registrar-Agents as nomadic devices (see <a href="#arch_nomadic" class="auto internal xref">Section 5.2</a>) and to avoid potential misuse as outlined in <a href="#sec_cons_reg-agt" class="auto internal xref">Section 12.3</a>.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<p id="section-6.1-5">Further, the Registrar-Agent requires the registrar EE certificate to provide it to the pledge.
It <span class="bcp14">MAY</span> use the certificate verified during server authentication within an initial TLS session with the registrar;
in this case, the Registrar-Agent <span class="bcp14">MUST</span> possess the domain trust anchor (i.e., CA certificate) for the registrar EE certificate to verify the certificate chain.
Alternatively, the registrar EE certificate <span class="bcp14">MAY</span> be provided via configuration or a repository.
The registrar IP address or hostname is provided either by configuration or by using the discovery mechanism defined in <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span> (see <a href="#discovery_uc2_reg" class="auto internal xref">Section 6.1.1</a>).<a href="#section-6.1-5" class="pilcrow">¶</a></p>
<p id="section-6.1-6">In addition to the certificates, the Registrar-Agent is provided with the product-serial-number(s) of the pledge(s) to be bootstrapped.
This is necessary to allow for the discovery of pledges by the Registrar-Agent using DNS-SD with mDNS (see <a href="#discovery_uc2_ppa" class="auto internal xref">Section 6.1.2</a>).
The list may be provided by prior administrative means or the Registrar-Agent may get the information via an (out-of-band) interaction with the pledge.
For instance, <span>[<a href="#RFC9238" class="cite xref">RFC9238</a>]</span> describes scanning of a QR code, where the product-serial-number would be initialized from the 12N B005 Product Serial Number data record.<a href="#section-6.1-6" class="pilcrow">¶</a></p>
<p id="section-6.1-7">In summary, the following information <span class="bcp14">MUST</span> be available at the Registrar-Agent before the interaction with a pledge:<a href="#section-6.1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-8.1">
            <p id="section-6.1-8.1.1">Registrar-Agent EE certificate and corresponding private key: own operational credentials to authenticate and sign agent-signed data<a href="#section-6.1-8.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-8.2">
            <p id="section-6.1-8.2.1">Registrar EE certificate: certificate of the domain registrar to be provided to the pledge<a href="#section-6.1-8.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-8.3">
            <p id="section-6.1-8.3.1">Serial number(s): product-serial-number(s) of pledge(s) to be bootstrapped; used for discovery<a href="#section-6.1-8.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.1-9">Further, the Registrar-Agent <span class="bcp14">SHOULD</span> have synchronized time.<a href="#section-6.1-9" class="pilcrow">¶</a></p>
<p id="section-6.1-10">Finally, the Registrar-Agent <span class="bcp14">MAY</span> possess the IDevID (root or issuing) CA certificate of the pledge manufacturer/vendor to validate the IDevID certificate on returned PVR or in case of optional TLS usage for pledge communication (see <a href="#pledgehttps" class="auto internal xref">Appendix B</a>).
The distribution of IDevID CA certificates to the Registrar-Agent is out of scope of this document and may be done by a manual configuration.<a href="#section-6.1-10" class="pilcrow">¶</a></p>
<div id="discovery_uc2_reg">
<section id="section-6.1.1">
          <h4 id="name-discovery-of-the-registrar">
<a href="#section-6.1.1" class="section-number selfRef">6.1.1. </a><a href="#name-discovery-of-the-registrar" class="section-name selfRef">Discovery of the Registrar</a>
          </h4>
<p id="section-6.1.1-1">While the Registrar-Agent requires an IP address of a domain registrar to initiate a TLS session, a separate discovery of the registrar is likely not needed and a configuration of the domain registrar IP address or hostname is assumed.
Registrar-Agent and registrar are domain components that already have a trust relation, as a Registrar-Agent acts as representative of the domain registrar towards the pledge or may even be collocated with the domain registrar.
Further, other communication (not part of this document) between the Registrar-Agent and the registrar is assumed, e.g., to exchange information about product-serial-number(s) of pledges to be discovered as outlined in <a href="#arch_nomadic" class="auto internal xref">Section 5.2</a>.<a href="#section-6.1.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1.1-2">Moreover, the discovery described in <span><a href="https://rfc-editor.org/rfc/rfc8995#section-4" class="relref">Section 4</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span> and <span><a href="https://rfc-editor.org/rfc/rfc8995#appendix-A.2" class="relref">Appendix A.2</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span> does not support identification of registrars with an enhanced feature set (like the support of BRSKI-PRM), and hence that discovery is not applicable.<a href="#section-6.1.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1.1-3">As a more general solution, the BRSKI discovery mechanism can be extended to provide upfront information on the capabilities of registrars, such as the mode of operation (pledge-responder-mode or registrar-responder-mode).
Defining discovery extensions is out of scope of this document.
For further discussion, see <span>[<a href="#I-D.ietf-anima-brski-discovery" class="cite xref">I-D.ietf-anima-brski-discovery</a>]</span>.<a href="#section-6.1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="discovery_uc2_ppa">
<section id="section-6.1.2">
          <h4 id="name-discovery-of-the-pledge">
<a href="#section-6.1.2" class="section-number selfRef">6.1.2. </a><a href="#name-discovery-of-the-pledge" class="section-name selfRef">Discovery of the Pledge</a>
          </h4>
<p id="section-6.1.2-1">The discovery of the pledge by the Registrar-Agent in the context of this document describes the minimum discovery approach that <span class="bcp14">MUST</span> be supported.
A more general discovery mechanism, also supporting GRASP besides DNS-SD with mDNS, is discussed in <span>[<a href="#I-D.ietf-anima-brski-discovery" class="cite xref">I-D.ietf-anima-brski-discovery</a>]</span>.<a href="#section-6.1.2-1" class="pilcrow">¶</a></p>
<p id="section-6.1.2-2">Discovery in BRSKI-PRM uses DNS-based Service Discovery <span>[<a href="#RFC6763" class="cite xref">RFC6763</a>]</span> over Multicast DNS <span>[<a href="#RFC6762" class="cite xref">RFC6762</a>]</span> to discover the pledge.
Note that <span><a href="https://rfc-editor.org/rfc/rfc6762#section-9" class="relref">Section 9</a> of [<a href="#RFC6762" class="cite xref">RFC6762</a>]</span> provides support for conflict resolution in situations when a DNS-SD with mDNS responder receives an mDNS response with inconsistent data.
Note that <span>[<a href="#RFC8990" class="cite xref">RFC8990</a>]</span> does not support conflict resolution of mDNS, which may be a limitation for its application.<a href="#section-6.1.2-2" class="pilcrow">¶</a></p>
<p id="section-6.1.2-3">The pledge constructs a Service Instance Name based on device local information (manufacturer/vendor name and serial number), which results in <code>&lt;product-serial-number&gt;._brski-pledge._tcp.local</code>.
The product-serial-number composition is manufacturer-dependent and may contain information regarding the manufacturer, the product type, and further information specific to the product instance.
To allow distinction of pledges, the product-serial-number therefore needs to be sufficiently unique.<a href="#section-6.1.2-3" class="pilcrow">¶</a></p>
<p id="section-6.1.2-4">Note that this goes against the naming recommendation of <span>[<a href="#RFC6763" class="cite xref">RFC6763</a>]</span>.
The <code>_brski-pledge._tcp</code> service, however, targets machine-to-machine discovery.<a href="#section-6.1.2-4" class="pilcrow">¶</a></p>
<p id="section-6.1.2-5">In the absence of a more general discovery as defined in <span>[<a href="#I-D.ietf-anima-brski-discovery" class="cite xref">I-D.ietf-anima-brski-discovery</a>]</span> the Registrar-Agent <span class="bcp14">MUST</span> use<a href="#section-6.1.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.2-6.1">
              <p id="section-6.1.2-6.1.1"><code>&lt;product-serial-number&gt;._brski-pledge._tcp.local</code>, to discover a specific pledge, e.g., when connected to a local network.<a href="#section-6.1.2-6.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.1.2-6.2">
              <p id="section-6.1.2-6.2.1"><code>_brski-pledge._tcp.local</code> to get a list of pledges to be bootstrapped.<a href="#section-6.1.2-6.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-6.1.2-7">When supporting different options for discovery, as outlined in <span>[<a href="#I-D.ietf-anima-brski-discovery" class="cite xref">I-D.ietf-anima-brski-discovery</a>]</span>, a manufacturer may support configuration of preferred options.<a href="#section-6.1.2-7" class="pilcrow">¶</a></p>
<p id="section-6.1.2-8">A manufacturer may allow the pledge to react on DNS-SD with mDNS discovery without its product-serial-number contained.
This allows a commissioning tool to discover pledges to be bootstrapped in the domain.
The manufacturer supports this functionality as outlined in <a href="#sec_cons_mDNS" class="auto internal xref">Section 12.4</a>.<a href="#section-6.1.2-8" class="pilcrow">¶</a></p>
<p id="section-6.1.2-9">Establishing network connectivity of the pledge is out of scope of this document but necessary to apply DNS-SD with mDNS.
For Ethernet, it is provided by simply connecting the network cable.
For WiFi networks, connectivity can be provided by using a pre-agreed SSID for bootstrapping, e.g., as proposed in <span>[<a href="#I-D.draft-ietf-emu-eap-arpa" class="cite xref">I-D.draft-ietf-emu-eap-arpa</a>]</span>. 
The same approach can be used by 6LoWPAN/mesh using a pre-agreed PAN ID.
How to gain network connectivity is out of scope of this document.<a href="#section-6.1.2-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="pledge_component">
<section id="section-6.2">
        <h3 id="name-pledge-in-responder-mode">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-pledge-in-responder-mode" class="section-name selfRef">Pledge in Responder Mode</a>
        </h3>
<p id="section-6.2-1">In BRSKI-PRM, the pledge is triggered by a Registrar-Agent to create the PVR and PER.
It is also triggered for processing of the responses and the generation of status information once the Registrar-Agent has received the responses from the registrar later in the process.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">To enable interaction as responder with a Registrar-Agent, pledges in responder mode <span class="bcp14">MUST</span> act as servers and <span class="bcp14">MUST</span> provide the endpoints provide the endpoints "tpvr", "tper", "svr", "scac", and "ser" defined in <a href="#pledge_ep_table" class="auto internal xref">Table 1</a> within the BRSKI-defined <code>/.well-known/brski/</code> URI path. The optional endpoint "qps" <span class="bcp14">SHOULD</span> be supported.
The endpoints are defined with short names to also accommodate for resource-constrained devices.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<span id="name-well-known-endpoints-on-a-p"></span><div id="pledge_ep_table">
<table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-well-known-endpoints-on-a-p" class="selfRef">Well-Known Endpoints on a Pledge in Responder Mode</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Endpoint</th>
              <th class="text-left" rowspan="1" colspan="1">Operation</th>
              <th class="text-left" rowspan="1" colspan="1">Exchange and Artifacts</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">tpvr</td>
              <td class="text-left" rowspan="1" colspan="1">Trigger Pledge Voucher-Request</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#tpvr" class="auto internal xref">Section 7.1</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">tper</td>
              <td class="text-left" rowspan="1" colspan="1">Trigger Pledge Enroll-Request</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#tper" class="auto internal xref">Section 7.2</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">svr</td>
              <td class="text-left" rowspan="1" colspan="1">Supply Voucher to Pledge</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#voucher" class="auto internal xref">Section 7.6</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">scac</td>
              <td class="text-left" rowspan="1" colspan="1">Supply CA Certificates to Pledge</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#cacerts" class="auto internal xref">Section 7.7</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ser</td>
              <td class="text-left" rowspan="1" colspan="1">Supply Enroll-Response to Pledge</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#enroll_response" class="auto internal xref">Section 7.8</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">qps</td>
              <td class="text-left" rowspan="1" colspan="1">Query Pledge Status</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#query" class="auto internal xref">Section 7.11</a>
</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-6.2-4">HTTP(S) uses the Host header field (or :authority in HTTP/2) to allow for name-based virtual hosting as explained in <span><a href="https://rfc-editor.org/rfc/rfc9110#section-7.2" class="relref">Section 7.2</a> of [<a href="#RFC9110" class="cite xref">RFC9110</a>]</span>.
This header field is mandatory, and so a compliant HTTP(S) client is going to insert it, which may be just an IP address.
In the absence of a security policy the pledge <span class="bcp14">MUST</span> respond to all requests regardless of the Host header field provided by the client (i.e., ignore it). 
A security policy  may include a rate limiting for a requests to avoid susceptibility of the pledge to overload.
Note that there is no requirement for the pledge to operate its BRSKI-PRM service on port numbers 80 or 443, so there is no reason for name-based virtual hosting.<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<p id="section-6.2-5">For instance, when the Registrar-Agent reaches out to the "tpvr" endpoint on a pledge in responder mode with the full URI <code>http://pledge.example.com/.well-known/brski/tpvr</code>, it sets the Host header field to <code>pledge.example.com</code> and the absolute path <code>/.well-known/brski/tpbr</code>.
In practice, however, the pledge is usually known by a <code>.local</code> hostname or only its IP address as returned by a discovery protocol, which will be included in the Host header field.<a href="#section-6.2-5" class="pilcrow">¶</a></p>
<p id="section-6.2-6">As BRSKI-PRM uses authenticated self-contained objects between the pledge and the domain registrar, the binding of the pledge identity to the voucher-requests is provided by the wrapping signature employing the pledge IDevID credential.
Hence, pledges <span class="bcp14">MUST</span> have an Initial Device Identifier (IDevID) installed in them at the factory.<a href="#section-6.2-6" class="pilcrow">¶</a></p>
<div id="pledge-with-combined-functionality">
<section id="section-6.2.1">
          <h4 id="name-pledge-with-combined-functi">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-pledge-with-combined-functi" class="section-name selfRef">Pledge with Combined Functionality</a>
          </h4>
<p id="section-6.2.1-1">Pledges <span class="bcp14">MAY</span> support both initiator and responder mode.<a href="#section-6.2.1-1" class="pilcrow">¶</a></p>
<p id="section-6.2.1-2">A pledge in initiator mode should listen for announcement messages as described in <span><a href="https://rfc-editor.org/rfc/rfc8995#section-4.1" class="relref">Section 4.1</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>.
Upon discovery of a potential registrar, it initiates the bootstrapping to that registrar.
At the same time (so as to avoid the Slowloris-like attack described in <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>), it <span class="bcp14">SHOULD</span> also respond to the triggers for responder mode described in this document.<a href="#section-6.2.1-2" class="pilcrow">¶</a></p>
<p id="section-6.2.1-3">Once a pledge with combined functionality has been bootstrapped, it <span class="bcp14">MAY</span> act as client for enrollment of further certificates needed, e.g., using the enrollment protocol of choice.
If it still acts as server, the defined BRSKI-PRM endpoints to trigger a Pledge Enroll-Request (PER) or to provide an Enroll-Response can be used for further certificates.<a href="#section-6.2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="registrar_component">
<section id="section-6.3">
        <h3 id="name-domain-registrar">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-domain-registrar" class="section-name selfRef">Domain Registrar</a>
        </h3>
<p id="section-6.3-1">The domain registrar provides the endpoints already specified in <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span> (derived from EST <span>[<a href="#RFC7030" class="cite xref">RFC7030</a>]</span>) where suitable.
In addition, it <span class="bcp14">MUST</span> provide the endpoints defined in <a href="#registrar_ep_table" class="auto internal xref">Table 2</a> within the BRSKI-defined <code>/.well-known/brski/</code> Well-Known URI path.
These endpoints accommodate for the authenticated self-contained objects used by BRSKI-PRM to provide Pledge Enroll-Request (PER) artifacts and signature-wrapped CA certificates via the Registrar-Agent.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<span id="name-additional-well-known-endpo"></span><div id="registrar_ep_table">
<table class="center" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-additional-well-known-endpo" class="selfRef">Additional Well-Known Endpoints on a BRSKI-PRM Registrar</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Endpoint</th>
              <th class="text-left" rowspan="1" colspan="1">Operation</th>
              <th class="text-left" rowspan="1" colspan="1">Exchange and Artifacts</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">requestenroll</td>
              <td class="text-left" rowspan="1" colspan="1">Supply PER to Registrar</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#per" class="auto internal xref">Section 7.4</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">wrappedcacerts</td>
              <td class="text-left" rowspan="1" colspan="1">Obtain CA Certificates</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#obtain_cacerts" class="auto internal xref">Section 7.5</a>
</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-6.3-3">The registrar possesses its own EE certificate and corresponding private key for authenticating and signing.
It <span class="bcp14">MUST</span> use the same certificate/credentials for authentication in the TLS session with a Registrar-Agent and for signing artifacts for that Registrar-Agent and its pledges (see <a href="#rcv_artifact" class="auto internal xref">Section 7.3.6</a>).<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<p id="section-6.3-4">According to <span><a href="https://rfc-editor.org/rfc/rfc8995#section-5.3" class="relref">Section 5.3</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>, a domain registrar performs the pledge authorization for bootstrapping within its domain based on the Pledge Voucher-Request.
For this, it <span class="bcp14">MUST</span> possess the IDevID trust anchor(s) (i.e., root or issuing CA certificate(s)) of the pledge vendor(s)/manufacturer(s).
This behavior is retained in BRSKI-PRM.<a href="#section-6.3-4" class="pilcrow">¶</a></p>
<p id="section-6.3-5">In its role as EST server <span>[<a href="#RFC7030" class="cite xref">RFC7030</a>]</span>, the domain registrar <span class="bcp14">MUST</span> also possess the domain CA certificates as defined in <span><a href="https://rfc-editor.org/rfc/rfc8995#section-5.9" class="relref">Section 5.9</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>.<a href="#section-6.3-5" class="pilcrow">¶</a></p>
<p id="section-6.3-6">Finally, the domain registrar <span class="bcp14">MUST</span> possess the Registrar-Agent EE certificate(s) to validate agent-signed data and to provide it to the MASA.
The registrar <span class="bcp14">MAY</span> use the certificate verified during client authentication within the TLS sessions with the Registrar-Agent;
in this case, the registrar <span class="bcp14">MUST</span> possess the domain trust anchor (i.e., domain CA certificate) for the Registrar-Agent EE certificate to verify the certificate chain.
Alternatively, the Registrar-Agent EE certificate(s) <span class="bcp14">MAY</span> be provided via configuration or a repository.<a href="#section-6.3-6" class="pilcrow">¶</a></p>
<div id="domain-registrar-with-combined-functionality">
<section id="section-6.3.1">
          <h4 id="name-domain-registrar-with-combi">
<a href="#section-6.3.1" class="section-number selfRef">6.3.1. </a><a href="#name-domain-registrar-with-combi" class="section-name selfRef">Domain Registrar with Combined Functionality</a>
          </h4>
<p id="section-6.3.1-1">A registrar with combined BRSKI and BRSKI-PRM functionality <span class="bcp14">MAY</span> detect if the bootstrapping is performed by the pledge directly (BRSKI case) or by a Registrar-Agent (BRSKI-PRM case) based on the utilized credentials for client authentication during the TLS session establishment and switch the operational mode from BRSKI to BRSKI-PRM.<a href="#section-6.3.1-1" class="pilcrow">¶</a></p>
<p id="section-6.3.1-2">This may be supported by a specific naming in the SAN (subject alternative name) component of the Registrar-Agent EE certificate, which allows the domain registrar to explicitly detect already in the TLS session establishment that the connecting client is a Registrar-Agent.<a href="#section-6.3.1-2" class="pilcrow">¶</a></p>
<p id="section-6.3.1-3">The registrar <span class="bcp14">MAY</span> be restricted by configuration, if it accepts every Registrar-Agent, which can authenticate with a domain issued certificate or only explicitly authorized ones.<a href="#section-6.3.1-3" class="pilcrow">¶</a></p>
<p id="section-6.3.1-4">Note that using an EE certificate for TLS client authentication of the Registrar-Agent is a deviation from <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>, in which the pledge IDevID certificate is used to perform TLS client authentication.<a href="#section-6.3.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="masa">
<section id="section-6.4">
        <h3 id="name-masa">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-masa" class="section-name selfRef">MASA</a>
        </h3>
<p id="section-6.4-1">The Manufacturer Authorized Signing Authority (MASA) is a vendor service that generates and signs voucher artifacts for pledges by the same vendor.
When these pledges support BRSKI-PRM, the MASA needs to implement the following functionality in addition to BRSKI <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<p id="section-6.4-2">A MASA for pledges in responder mode <span class="bcp14">MUST</span> support the voucher format defined in <span>[<a href="#I-D.ietf-anima-jws-voucher" class="cite xref">I-D.ietf-anima-jws-voucher</a>]</span> to parse and process JWS-signed voucher-request artifacts and generate JWS-signed voucher artifacts.<a href="#section-6.4-2" class="pilcrow">¶</a></p>
<p id="section-6.4-3">Further, a MASA for pledges in responder mode <span class="bcp14">MUST</span> support the Agent Proximity Assertion (<a href="#agt_prx" class="auto internal xref">Section 5.4</a>) through the validation steps defined in <a href="#masa_interaction" class="auto internal xref">Section 7.3.1</a> based on the Pledge Voucher-Request (PVR) and Registrar Voucher-Request (RVR) artifact fields defined in <a href="#pvr_artifact" class="auto internal xref">Section 7.1.2</a> and <a href="#rvr_artifact" class="auto internal xref">Section 7.3.4</a>, respectively.<a href="#section-6.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="exchanges">
<section id="section-7">
      <h2 id="name-exchanges-and-artifacts">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-exchanges-and-artifacts" class="section-name selfRef">Exchanges and Artifacts</a>
      </h2>
<p id="section-7-1">The interaction of the pledge with the Registrar-Agent may be accomplished using different transports (i.e., protocols and/or network technologies).
This specification utilizes HTTP(S) as default transport.
Other specifications may define alternative transports such as CoAP, Bluetooth Low Energy (BLE), or Near Field Communication (NFC).
These transports may differ from and are independent of the ones used between the Registrar-Agent and the registrar.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">Transport independence is realized through authenticated self-contained objects that are not bound to a specific transport security and stay the same along the communication path from the pledge via the Registrar-Agent to the registrar.
<span>[<a href="#I-D.ietf-anima-rfc8366bis" class="cite xref">I-D.ietf-anima-rfc8366bis</a>]</span> defines CMS-signed JSON structures as format for artifacts representing authenticated self-contained objects.
This specification utilizes JWS-signed JSON structures as default format for BRSKI-PRM.
Other specifications may define alternative formats for representing authenticated self-contained objects such as COSE-signed CBOR structures.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3"><a href="#exchangesfig_uc2_all" class="auto internal xref">Figure 4</a> provides an overview of the exchanges detailed in the following subsections.<a href="#section-7-3" class="pilcrow">¶</a></p>
<span id="name-overview-pledge-responder-m"></span><div id="exchangesfig_uc2_all">
<figure id="figure-4">
        <div id="section-7-4.1">
          <div class="alignCenter art-svg artwork" id="section-7-4.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="1904" width="576" viewBox="0 0 576 1904" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,32 L 8,80" fill="none" stroke="black"></path>
              <path d="M 16,88 L 16,192" fill="none" stroke="black"></path>
              <path d="M 16,256 L 16,320" fill="none" stroke="black"></path>
              <path d="M 16,384 L 16,448" fill="none" stroke="black"></path>
              <path d="M 16,512 L 16,800" fill="none" stroke="black"></path>
              <path d="M 16,864 L 16,960" fill="none" stroke="black"></path>
              <path d="M 16,1024 L 16,1072" fill="none" stroke="black"></path>
              <path d="M 16,1136 L 16,1200" fill="none" stroke="black"></path>
              <path d="M 16,1264 L 16,1312" fill="none" stroke="black"></path>
              <path d="M 16,1376 L 16,1440" fill="none" stroke="black"></path>
              <path d="M 16,1504 L 16,1632" fill="none" stroke="black"></path>
              <path d="M 16,1696 L 16,1744" fill="none" stroke="black"></path>
              <path d="M 16,1808 L 16,1872" fill="none" stroke="black"></path>
              <path d="M 80,32 L 80,80" fill="none" stroke="black"></path>
              <path d="M 120,32 L 120,80" fill="none" stroke="black"></path>
              <path d="M 168,88 L 168,192" fill="none" stroke="black"></path>
              <path d="M 168,256 L 168,320" fill="none" stroke="black"></path>
              <path d="M 168,384 L 168,448" fill="none" stroke="black"></path>
              <path d="M 168,512 L 168,800" fill="none" stroke="black"></path>
              <path d="M 168,864 L 168,960" fill="none" stroke="black"></path>
              <path d="M 168,1024 L 168,1072" fill="none" stroke="black"></path>
              <path d="M 168,1136 L 168,1200" fill="none" stroke="black"></path>
              <path d="M 168,1264 L 168,1312" fill="none" stroke="black"></path>
              <path d="M 168,1376 L 168,1440" fill="none" stroke="black"></path>
              <path d="M 168,1504 L 168,1632" fill="none" stroke="black"></path>
              <path d="M 168,1696 L 168,1744" fill="none" stroke="black"></path>
              <path d="M 168,1808 L 168,1872" fill="none" stroke="black"></path>
              <path d="M 224,32 L 224,80" fill="none" stroke="black"></path>
              <path d="M 264,32 L 264,80" fill="none" stroke="black"></path>
              <path d="M 312,88 L 312,192" fill="none" stroke="black"></path>
              <path d="M 312,256 L 312,320" fill="none" stroke="black"></path>
              <path d="M 312,384 L 312,448" fill="none" stroke="black"></path>
              <path d="M 312,512 L 312,544" fill="none" stroke="black"></path>
              <path d="M 312,592 L 312,624" fill="none" stroke="black"></path>
              <path d="M 312,656 L 312,800" fill="none" stroke="black"></path>
              <path d="M 312,864 L 312,960" fill="none" stroke="black"></path>
              <path d="M 312,1024 L 312,1072" fill="none" stroke="black"></path>
              <path d="M 312,1136 L 312,1200" fill="none" stroke="black"></path>
              <path d="M 312,1264 L 312,1312" fill="none" stroke="black"></path>
              <path d="M 312,1376 L 312,1440" fill="none" stroke="black"></path>
              <path d="M 312,1504 L 312,1600" fill="none" stroke="black"></path>
              <path d="M 312,1696 L 312,1744" fill="none" stroke="black"></path>
              <path d="M 312,1808 L 312,1872" fill="none" stroke="black"></path>
              <path d="M 360,32 L 360,80" fill="none" stroke="black"></path>
              <path d="M 400,32 L 400,80" fill="none" stroke="black"></path>
              <path d="M 456,88 L 456,192" fill="none" stroke="black"></path>
              <path d="M 456,256 L 456,320" fill="none" stroke="black"></path>
              <path d="M 456,384 L 456,448" fill="none" stroke="black"></path>
              <path d="M 456,512 L 456,664" fill="none" stroke="black"></path>
              <path d="M 456,784 L 456,800" fill="none" stroke="black"></path>
              <path d="M 456,864 L 456,960" fill="none" stroke="black"></path>
              <path d="M 456,1024 L 456,1072" fill="none" stroke="black"></path>
              <path d="M 456,1136 L 456,1200" fill="none" stroke="black"></path>
              <path d="M 456,1264 L 456,1312" fill="none" stroke="black"></path>
              <path d="M 456,1376 L 456,1440" fill="none" stroke="black"></path>
              <path d="M 456,1504 L 456,1544" fill="none" stroke="black"></path>
              <path d="M 456,1600 L 456,1632" fill="none" stroke="black"></path>
              <path d="M 456,1696 L 456,1744" fill="none" stroke="black"></path>
              <path d="M 456,1808 L 456,1872" fill="none" stroke="black"></path>
              <path d="M 472,32 L 472,80" fill="none" stroke="black"></path>
              <path d="M 512,32 L 512,80" fill="none" stroke="black"></path>
              <path d="M 560,88 L 560,192" fill="none" stroke="black"></path>
              <path d="M 560,256 L 560,320" fill="none" stroke="black"></path>
              <path d="M 560,384 L 560,448" fill="none" stroke="black"></path>
              <path d="M 560,512 L 560,704" fill="none" stroke="black"></path>
              <path d="M 560,752 L 560,800" fill="none" stroke="black"></path>
              <path d="M 560,864 L 560,960" fill="none" stroke="black"></path>
              <path d="M 560,1024 L 560,1072" fill="none" stroke="black"></path>
              <path d="M 560,1136 L 560,1200" fill="none" stroke="black"></path>
              <path d="M 560,1264 L 560,1312" fill="none" stroke="black"></path>
              <path d="M 560,1376 L 560,1440" fill="none" stroke="black"></path>
              <path d="M 560,1504 L 560,1632" fill="none" stroke="black"></path>
              <path d="M 560,1696 L 560,1744" fill="none" stroke="black"></path>
              <path d="M 560,1808 L 560,1872" fill="none" stroke="black"></path>
              <path d="M 568,32 L 568,80" fill="none" stroke="black"></path>
              <path d="M 8,32 L 80,32" fill="none" stroke="black"></path>
              <path d="M 120,32 L 224,32" fill="none" stroke="black"></path>
              <path d="M 264,32 L 360,32" fill="none" stroke="black"></path>
              <path d="M 400,32 L 472,32" fill="none" stroke="black"></path>
              <path d="M 512,32 L 568,32" fill="none" stroke="black"></path>
              <path d="M 8,80 L 80,80" fill="none" stroke="black"></path>
              <path d="M 120,80 L 224,80" fill="none" stroke="black"></path>
              <path d="M 264,80 L 360,80" fill="none" stroke="black"></path>
              <path d="M 400,80 L 472,80" fill="none" stroke="black"></path>
              <path d="M 512,80 L 568,80" fill="none" stroke="black"></path>
              <path d="M 24,160 L 160,160" fill="none" stroke="black"></path>
              <path d="M 24,176 L 160,176" fill="none" stroke="black"></path>
              <path d="M 24,272 L 56,272" fill="none" stroke="black"></path>
              <path d="M 128,272 L 160,272" fill="none" stroke="black"></path>
              <path d="M 24,288 L 72,288" fill="none" stroke="black"></path>
              <path d="M 112,288 L 160,288" fill="none" stroke="black"></path>
              <path d="M 24,304 L 80,304" fill="none" stroke="black"></path>
              <path d="M 112,304 L 160,304" fill="none" stroke="black"></path>
              <path d="M 24,400 L 56,400" fill="none" stroke="black"></path>
              <path d="M 128,400 L 160,400" fill="none" stroke="black"></path>
              <path d="M 24,416 L 72,416" fill="none" stroke="black"></path>
              <path d="M 112,416 L 160,416" fill="none" stroke="black"></path>
              <path d="M 24,432 L 80,432" fill="none" stroke="black"></path>
              <path d="M 112,432 L 160,432" fill="none" stroke="black"></path>
              <path d="M 176,528 L 216,528" fill="none" stroke="black"></path>
              <path d="M 256,528 L 304,528" fill="none" stroke="black"></path>
              <path d="M 176,608 L 224,608" fill="none" stroke="black"></path>
              <path d="M 256,608 L 304,608" fill="none" stroke="black"></path>
              <path d="M 320,672 L 416,672" fill="none" stroke="black"></path>
              <path d="M 456,672 L 552,672" fill="none" stroke="black"></path>
              <path d="M 320,688 L 424,688" fill="none" stroke="black"></path>
              <path d="M 456,688 L 552,688" fill="none" stroke="black"></path>
              <path d="M 320,768 L 408,768" fill="none" stroke="black"></path>
              <path d="M 472,768 L 552,768" fill="none" stroke="black"></path>
              <path d="M 176,784 L 208,784" fill="none" stroke="black"></path>
              <path d="M 280,784 L 304,784" fill="none" stroke="black"></path>
              <path d="M 176,880 L 216,880" fill="none" stroke="black"></path>
              <path d="M 256,880 L 304,880" fill="none" stroke="black"></path>
              <path d="M 176,896 L 224,896" fill="none" stroke="black"></path>
              <path d="M 256,896 L 304,896" fill="none" stroke="black"></path>
              <path d="M 320,912 L 344,912" fill="none" stroke="black"></path>
              <path d="M 424,912 L 448,912" fill="none" stroke="black"></path>
              <path d="M 320,928 L 336,928" fill="none" stroke="black"></path>
              <path d="M 176,944 L 192,944" fill="none" stroke="black"></path>
              <path d="M 288,944 L 304,944" fill="none" stroke="black"></path>
              <path d="M 176,1040 L 216,1040" fill="none" stroke="black"></path>
              <path d="M 256,1040 L 304,1040" fill="none" stroke="black"></path>
              <path d="M 176,1056 L 208,1056" fill="none" stroke="black"></path>
              <path d="M 272,1056 L 304,1056" fill="none" stroke="black"></path>
              <path d="M 24,1152 L 56,1152" fill="none" stroke="black"></path>
              <path d="M 128,1152 L 160,1152" fill="none" stroke="black"></path>
              <path d="M 24,1168 L 64,1168" fill="none" stroke="black"></path>
              <path d="M 136,1168 L 160,1168" fill="none" stroke="black"></path>
              <path d="M 24,1184 L 64,1184" fill="none" stroke="black"></path>
              <path d="M 128,1184 L 160,1184" fill="none" stroke="black"></path>
              <path d="M 24,1280 L 56,1280" fill="none" stroke="black"></path>
              <path d="M 128,1280 L 160,1280" fill="none" stroke="black"></path>
              <path d="M 24,1296 L 64,1296" fill="none" stroke="black"></path>
              <path d="M 128,1296 L 160,1296" fill="none" stroke="black"></path>
              <path d="M 24,1392 L 56,1392" fill="none" stroke="black"></path>
              <path d="M 128,1392 L 160,1392" fill="none" stroke="black"></path>
              <path d="M 24,1408 L 48,1408" fill="none" stroke="black"></path>
              <path d="M 144,1408 L 160,1408" fill="none" stroke="black"></path>
              <path d="M 24,1424 L 56,1424" fill="none" stroke="black"></path>
              <path d="M 120,1424 L 160,1424" fill="none" stroke="black"></path>
              <path d="M 176,1520 L 216,1520" fill="none" stroke="black"></path>
              <path d="M 256,1520 L 304,1520" fill="none" stroke="black"></path>
              <path d="M 176,1536 L 208,1536" fill="none" stroke="black"></path>
              <path d="M 272,1536 L 304,1536" fill="none" stroke="black"></path>
              <path d="M 320,1552 L 416,1552" fill="none" stroke="black"></path>
              <path d="M 456,1552 L 552,1552" fill="none" stroke="black"></path>
              <path d="M 320,1568 L 352,1568" fill="none" stroke="black"></path>
              <path d="M 520,1568 L 552,1568" fill="none" stroke="black"></path>
              <path d="M 320,1584 L 368,1584" fill="none" stroke="black"></path>
              <path d="M 504,1584 L 552,1584" fill="none" stroke="black"></path>
              <path d="M 176,1712 L 216,1712" fill="none" stroke="black"></path>
              <path d="M 256,1712 L 304,1712" fill="none" stroke="black"></path>
              <path d="M 176,1728 L 208,1728" fill="none" stroke="black"></path>
              <path d="M 272,1728 L 304,1728" fill="none" stroke="black"></path>
              <path d="M 24,1824 L 56,1824" fill="none" stroke="black"></path>
              <path d="M 128,1824 L 160,1824" fill="none" stroke="black"></path>
              <path d="M 24,1840 L 64,1840" fill="none" stroke="black"></path>
              <path d="M 128,1840 L 160,1840" fill="none" stroke="black"></path>
              <path d="M 24,1856 L 64,1856" fill="none" stroke="black"></path>
              <path d="M 128,1856 L 160,1856" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="560,1568 548,1562.4 548,1573.6" fill="black" transform="rotate(0,552,1568)"></polygon>
              <polygon class="arrowhead" points="560,1552 548,1546.4 548,1557.6" fill="black" transform="rotate(0,552,1552)"></polygon>
              <polygon class="arrowhead" points="560,688 548,682.4 548,693.6" fill="black" transform="rotate(0,552,688)"></polygon>
              <polygon class="arrowhead" points="560,672 548,666.4 548,677.6" fill="black" transform="rotate(0,552,672)"></polygon>
              <polygon class="arrowhead" points="456,912 444,906.4 444,917.6" fill="black" transform="rotate(0,448,912)"></polygon>
              <polygon class="arrowhead" points="328,1584 316,1578.4 316,1589.6" fill="black" transform="rotate(180,320,1584)"></polygon>
              <polygon class="arrowhead" points="328,1552 316,1546.4 316,1557.6" fill="black" transform="rotate(180,320,1552)"></polygon>
              <polygon class="arrowhead" points="328,928 316,922.4 316,933.6" fill="black" transform="rotate(180,320,928)"></polygon>
              <polygon class="arrowhead" points="328,768 316,762.4 316,773.6" fill="black" transform="rotate(180,320,768)"></polygon>
              <polygon class="arrowhead" points="328,672 316,666.4 316,677.6" fill="black" transform="rotate(180,320,672)"></polygon>
              <polygon class="arrowhead" points="312,1728 300,1722.4 300,1733.6" fill="black" transform="rotate(0,304,1728)"></polygon>
              <polygon class="arrowhead" points="312,1712 300,1706.4 300,1717.6" fill="black" transform="rotate(0,304,1712)"></polygon>
              <polygon class="arrowhead" points="312,1536 300,1530.4 300,1541.6" fill="black" transform="rotate(0,304,1536)"></polygon>
              <polygon class="arrowhead" points="312,1520 300,1514.4 300,1525.6" fill="black" transform="rotate(0,304,1520)"></polygon>
              <polygon class="arrowhead" points="312,1040 300,1034.4 300,1045.6" fill="black" transform="rotate(0,304,1040)"></polygon>
              <polygon class="arrowhead" points="312,896 300,890.4 300,901.6" fill="black" transform="rotate(0,304,896)"></polygon>
              <polygon class="arrowhead" points="312,880 300,874.4 300,885.6" fill="black" transform="rotate(0,304,880)"></polygon>
              <polygon class="arrowhead" points="312,608 300,602.4 300,613.6" fill="black" transform="rotate(0,304,608)"></polygon>
              <polygon class="arrowhead" points="312,528 300,522.4 300,533.6" fill="black" transform="rotate(0,304,528)"></polygon>
              <polygon class="arrowhead" points="184,1712 172,1706.4 172,1717.6" fill="black" transform="rotate(180,176,1712)"></polygon>
              <polygon class="arrowhead" points="184,1520 172,1514.4 172,1525.6" fill="black" transform="rotate(180,176,1520)"></polygon>
              <polygon class="arrowhead" points="184,1056 172,1050.4 172,1061.6" fill="black" transform="rotate(180,176,1056)"></polygon>
              <polygon class="arrowhead" points="184,1040 172,1034.4 172,1045.6" fill="black" transform="rotate(180,176,1040)"></polygon>
              <polygon class="arrowhead" points="184,944 172,938.4 172,949.6" fill="black" transform="rotate(180,176,944)"></polygon>
              <polygon class="arrowhead" points="184,880 172,874.4 172,885.6" fill="black" transform="rotate(180,176,880)"></polygon>
              <polygon class="arrowhead" points="184,784 172,778.4 172,789.6" fill="black" transform="rotate(180,176,784)"></polygon>
              <polygon class="arrowhead" points="184,528 172,522.4 172,533.6" fill="black" transform="rotate(180,176,528)"></polygon>
              <polygon class="arrowhead" points="168,1856 156,1850.4 156,1861.6" fill="black" transform="rotate(0,160,1856)"></polygon>
              <polygon class="arrowhead" points="168,1824 156,1818.4 156,1829.6" fill="black" transform="rotate(0,160,1824)"></polygon>
              <polygon class="arrowhead" points="168,1424 156,1418.4 156,1429.6" fill="black" transform="rotate(0,160,1424)"></polygon>
              <polygon class="arrowhead" points="168,1392 156,1386.4 156,1397.6" fill="black" transform="rotate(0,160,1392)"></polygon>
              <polygon class="arrowhead" points="168,1280 156,1274.4 156,1285.6" fill="black" transform="rotate(0,160,1280)"></polygon>
              <polygon class="arrowhead" points="168,1184 156,1178.4 156,1189.6" fill="black" transform="rotate(0,160,1184)"></polygon>
              <polygon class="arrowhead" points="168,1152 156,1146.4 156,1157.6" fill="black" transform="rotate(0,160,1152)"></polygon>
              <polygon class="arrowhead" points="168,432 156,426.4 156,437.6" fill="black" transform="rotate(0,160,432)"></polygon>
              <polygon class="arrowhead" points="168,400 156,394.4 156,405.6" fill="black" transform="rotate(0,160,400)"></polygon>
              <polygon class="arrowhead" points="168,304 156,298.4 156,309.6" fill="black" transform="rotate(0,160,304)"></polygon>
              <polygon class="arrowhead" points="168,272 156,266.4 156,277.6" fill="black" transform="rotate(0,160,272)"></polygon>
              <polygon class="arrowhead" points="168,176 156,170.4 156,181.6" fill="black" transform="rotate(0,160,176)"></polygon>
              <polygon class="arrowhead" points="32,1840 20,1834.4 20,1845.6" fill="black" transform="rotate(180,24,1840)"></polygon>
              <polygon class="arrowhead" points="32,1824 20,1818.4 20,1829.6" fill="black" transform="rotate(180,24,1824)"></polygon>
              <polygon class="arrowhead" points="32,1408 20,1402.4 20,1413.6" fill="black" transform="rotate(180,24,1408)"></polygon>
              <polygon class="arrowhead" points="32,1392 20,1386.4 20,1397.6" fill="black" transform="rotate(180,24,1392)"></polygon>
              <polygon class="arrowhead" points="32,1296 20,1290.4 20,1301.6" fill="black" transform="rotate(180,24,1296)"></polygon>
              <polygon class="arrowhead" points="32,1280 20,1274.4 20,1285.6" fill="black" transform="rotate(180,24,1280)"></polygon>
              <polygon class="arrowhead" points="32,1168 20,1162.4 20,1173.6" fill="black" transform="rotate(180,24,1168)"></polygon>
              <polygon class="arrowhead" points="32,1152 20,1146.4 20,1157.6" fill="black" transform="rotate(180,24,1152)"></polygon>
              <polygon class="arrowhead" points="32,416 20,410.4 20,421.6" fill="black" transform="rotate(180,24,416)"></polygon>
              <polygon class="arrowhead" points="32,400 20,394.4 20,405.6" fill="black" transform="rotate(180,24,400)"></polygon>
              <polygon class="arrowhead" points="32,288 20,282.4 20,293.6" fill="black" transform="rotate(180,24,288)"></polygon>
              <polygon class="arrowhead" points="32,272 20,266.4 20,277.6" fill="black" transform="rotate(180,24,272)"></polygon>
              <polygon class="arrowhead" points="32,160 20,154.4 20,165.6" fill="black" transform="rotate(180,24,160)"></polygon>
              <g class="text">
                <text x="44" y="52">Pledge</text>
                <text x="172" y="52">Registrar-</text>
                <text x="308" y="52">Domain</text>
                <text x="432" y="52">Key</text>
                <text x="540" y="52">MASA</text>
                <text x="168" y="68">Agent</text>
                <text x="312" y="68">Registrar</text>
                <text x="436" y="68">Infra.</text>
                <text x="516" y="100">Internet</text>
                <text x="92" y="116">discover</text>
                <text x="92" y="132">pledge</text>
                <text x="68" y="148">mDNS</text>
                <text x="112" y="148">query</text>
                <text x="16" y="212">~</text>
                <text x="168" y="212">~</text>
                <text x="312" y="212">~</text>
                <text x="456" y="212">~</text>
                <text x="560" y="212">~</text>
                <text x="16" y="228">(1)</text>
                <text x="64" y="228">Trigger</text>
                <text x="124" y="228">Pledge</text>
                <text x="216" y="228">Voucher-Request</text>
                <text x="16" y="244">~</text>
                <text x="168" y="244">~</text>
                <text x="312" y="244">~</text>
                <text x="456" y="244">~</text>
                <text x="560" y="244">~</text>
                <text x="76" y="276">opt.</text>
                <text x="112" y="276">TLS</text>
                <text x="92" y="292">tPVR</text>
                <text x="96" y="308">PVR</text>
                <text x="16" y="340">~</text>
                <text x="168" y="340">~</text>
                <text x="312" y="340">~</text>
                <text x="456" y="340">~</text>
                <text x="560" y="340">~</text>
                <text x="16" y="356">(2)</text>
                <text x="64" y="356">Trigger</text>
                <text x="124" y="356">Pledge</text>
                <text x="212" y="356">Enroll-Request</text>
                <text x="16" y="372">~</text>
                <text x="168" y="372">~</text>
                <text x="312" y="372">~</text>
                <text x="456" y="372">~</text>
                <text x="560" y="372">~</text>
                <text x="76" y="404">opt.</text>
                <text x="112" y="404">TLS</text>
                <text x="92" y="420">tPER</text>
                <text x="96" y="436">PER</text>
                <text x="16" y="468">~</text>
                <text x="168" y="468">~</text>
                <text x="312" y="468">~</text>
                <text x="456" y="468">~</text>
                <text x="560" y="468">~</text>
                <text x="16" y="484">(3)</text>
                <text x="60" y="484">Supply</text>
                <text x="104" y="484">PVR</text>
                <text x="132" y="484">to</text>
                <text x="184" y="484">Registrar</text>
                <text x="268" y="484">(including</text>
                <text x="332" y="484">MASA</text>
                <text x="404" y="484">interaction)</text>
                <text x="16" y="500">~</text>
                <text x="168" y="500">~</text>
                <text x="312" y="500">~</text>
                <text x="456" y="500">~</text>
                <text x="560" y="500">~</text>
                <text x="236" y="532">mTLS</text>
                <text x="308" y="564">[Registrar-Agent</text>
                <text x="308" y="580">authenticated&amp;authorized?]</text>
                <text x="240" y="612">PVR</text>
                <text x="280" y="644">[accept</text>
                <text x="348" y="644">device?]</text>
                <text x="436" y="676">mTLS</text>
                <text x="440" y="692">RVR</text>
                <text x="456" y="708">~</text>
                <text x="460" y="724">[extract</text>
                <text x="536" y="724">DomainID]</text>
                <text x="456" y="740">[update</text>
                <text x="532" y="740">audit-log]</text>
                <text x="456" y="756">~</text>
                <text x="440" y="772">Voucher</text>
                <text x="244" y="788">Voucher'</text>
                <text x="16" y="820">~</text>
                <text x="168" y="820">~</text>
                <text x="312" y="820">~</text>
                <text x="456" y="820">~</text>
                <text x="560" y="820">~</text>
                <text x="16" y="836">(4)</text>
                <text x="60" y="836">Supply</text>
                <text x="104" y="836">PER</text>
                <text x="132" y="836">to</text>
                <text x="184" y="836">Registrar</text>
                <text x="268" y="836">(including</text>
                <text x="328" y="836">Key</text>
                <text x="404" y="836">Infrastructure</text>
                <text x="516" y="836">interaction)</text>
                <text x="16" y="852">~</text>
                <text x="168" y="852">~</text>
                <text x="312" y="852">~</text>
                <text x="456" y="852">~</text>
                <text x="560" y="852">~</text>
                <text x="236" y="884">mTLS</text>
                <text x="240" y="900">PER</text>
                <text x="384" y="916">[Request]</text>
                <text x="396" y="932">[Certificate]-</text>
                <text x="240" y="948">Enroll-Resp</text>
                <text x="16" y="980">~</text>
                <text x="168" y="980">~</text>
                <text x="312" y="980">~</text>
                <text x="456" y="980">~</text>
                <text x="560" y="980">~</text>
                <text x="16" y="996">(5)</text>
                <text x="60" y="996">Obtain</text>
                <text x="100" y="996">CA</text>
                <text x="164" y="996">Certificates</text>
                <text x="16" y="1012">~</text>
                <text x="168" y="1012">~</text>
                <text x="312" y="1012">~</text>
                <text x="456" y="1012">~</text>
                <text x="560" y="1012">~</text>
                <text x="236" y="1044">mTLS</text>
                <text x="240" y="1060">caCerts</text>
                <text x="16" y="1092">~</text>
                <text x="168" y="1092">~</text>
                <text x="312" y="1092">~</text>
                <text x="456" y="1092">~</text>
                <text x="560" y="1092">~</text>
                <text x="16" y="1108">(6)</text>
                <text x="60" y="1108">Supply</text>
                <text x="120" y="1108">Voucher</text>
                <text x="164" y="1108">to</text>
                <text x="204" y="1108">Pledge</text>
                <text x="16" y="1124">~</text>
                <text x="168" y="1124">~</text>
                <text x="312" y="1124">~</text>
                <text x="456" y="1124">~</text>
                <text x="560" y="1124">~</text>
                <text x="76" y="1156">opt.</text>
                <text x="112" y="1156">TLS</text>
                <text x="100" y="1172">Voucher'</text>
                <text x="96" y="1188">vStatus</text>
                <text x="16" y="1220">~</text>
                <text x="168" y="1220">~</text>
                <text x="312" y="1220">~</text>
                <text x="456" y="1220">~</text>
                <text x="560" y="1220">~</text>
                <text x="16" y="1236">(7)</text>
                <text x="60" y="1236">Supply</text>
                <text x="100" y="1236">CA</text>
                <text x="164" y="1236">Certificates</text>
                <text x="228" y="1236">to</text>
                <text x="268" y="1236">Pledge</text>
                <text x="16" y="1252">~</text>
                <text x="168" y="1252">~</text>
                <text x="312" y="1252">~</text>
                <text x="456" y="1252">~</text>
                <text x="560" y="1252">~</text>
                <text x="76" y="1284">opt.</text>
                <text x="112" y="1284">TLS</text>
                <text x="96" y="1300">caCerts</text>
                <text x="16" y="1332">~</text>
                <text x="168" y="1332">~</text>
                <text x="312" y="1332">~</text>
                <text x="456" y="1332">~</text>
                <text x="560" y="1332">~</text>
                <text x="16" y="1348">(8)</text>
                <text x="60" y="1348">Supply</text>
                <text x="152" y="1348">Enroll-Response</text>
                <text x="228" y="1348">to</text>
                <text x="268" y="1348">Pledge</text>
                <text x="16" y="1364">~</text>
                <text x="168" y="1364">~</text>
                <text x="312" y="1364">~</text>
                <text x="456" y="1364">~</text>
                <text x="560" y="1364">~</text>
                <text x="76" y="1396">opt.</text>
                <text x="112" y="1396">TLS</text>
                <text x="96" y="1412">Enroll-Resp</text>
                <text x="88" y="1428">eStatus</text>
                <text x="16" y="1460">~</text>
                <text x="168" y="1460">~</text>
                <text x="312" y="1460">~</text>
                <text x="456" y="1460">~</text>
                <text x="560" y="1460">~</text>
                <text x="16" y="1476">(9)</text>
                <text x="64" y="1476">Voucher</text>
                <text x="124" y="1476">Status</text>
                <text x="192" y="1476">Telemetry</text>
                <text x="276" y="1476">(including</text>
                <text x="352" y="1476">backend</text>
                <text x="436" y="1476">interaction)</text>
                <text x="16" y="1492">~</text>
                <text x="168" y="1492">~</text>
                <text x="312" y="1492">~</text>
                <text x="456" y="1492">~</text>
                <text x="560" y="1492">~</text>
                <text x="236" y="1524">mTLS</text>
                <text x="240" y="1540">vStatus</text>
                <text x="436" y="1556">mTLS</text>
                <text x="368" y="1572">req</text>
                <text x="412" y="1572">device</text>
                <text x="480" y="1572">audit-log</text>
                <text x="396" y="1588">device</text>
                <text x="464" y="1588">audit-log</text>
                <text x="264" y="1620">[verify</text>
                <text x="340" y="1620">audit-log]</text>
                <text x="312" y="1636">|</text>
                <text x="16" y="1652">~</text>
                <text x="168" y="1652">~</text>
                <text x="312" y="1652">~</text>
                <text x="456" y="1652">~</text>
                <text x="560" y="1652">~</text>
                <text x="20" y="1668">(10)</text>
                <text x="68" y="1668">Enroll</text>
                <text x="124" y="1668">Status</text>
                <text x="192" y="1668">Telemetry</text>
                <text x="16" y="1684">~</text>
                <text x="168" y="1684">~</text>
                <text x="312" y="1684">~</text>
                <text x="456" y="1684">~</text>
                <text x="560" y="1684">~</text>
                <text x="236" y="1716">mTLS</text>
                <text x="240" y="1732">eStatus</text>
                <text x="16" y="1764">~</text>
                <text x="168" y="1764">~</text>
                <text x="312" y="1764">~</text>
                <text x="456" y="1764">~</text>
                <text x="560" y="1764">~</text>
                <text x="20" y="1780">(11)</text>
                <text x="64" y="1780">Query</text>
                <text x="116" y="1780">Pledge</text>
                <text x="172" y="1780">Status</text>
                <text x="16" y="1796">~</text>
                <text x="168" y="1796">~</text>
                <text x="312" y="1796">~</text>
                <text x="456" y="1796">~</text>
                <text x="560" y="1796">~</text>
                <text x="76" y="1828">opt.</text>
                <text x="112" y="1828">TLS</text>
                <text x="96" y="1844">tStatus</text>
                <text x="96" y="1860">pStatus</text>
                <text x="16" y="1892">~</text>
                <text x="168" y="1892">~</text>
                <text x="312" y="1892">~</text>
                <text x="456" y="1892">~</text>
                <text x="560" y="1892">~</text>
              </g>
            </svg><a href="#section-7-4.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-overview-pledge-responder-m" class="selfRef">Overview pledge-responder-mode exchanges</a>
        </figcaption></figure>
</div>
<p id="section-7-5">The following subsections split the interactions shown in <a href="#exchangesfig_uc2_all" class="auto internal xref">Figure 4</a> between the different components into:<a href="#section-7-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7-6">
<li id="section-7-6.1">
          <p id="section-7-6.1.1"><a href="#tpvr" class="auto internal xref">Section 7.1</a> describes the acquisition exchange for the Pledge Voucher-Request initiated by the Registrar-Agent to the pledge.<a href="#section-7-6.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-7-6.2">
          <p id="section-7-6.2.1"><a href="#tper" class="auto internal xref">Section 7.2</a> describes the acquisition exchange for the Pledge Enroll-Request initiated by the Registrar-Agent to the pledge.<a href="#section-7-6.2.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-7-6.3">
          <p id="section-7-6.3.1"><a href="#pvr" class="auto internal xref">Section 7.3</a> describes the issuing exchange for the Voucher initiated by the Registrar-Agent to the registrar, including the interaction of the registrar with the MASA using the RVR <a href="#rvr_artifact" class="auto internal xref">Section 7.3.4</a>, as well as the artifact processing by these entities.<a href="#section-7-6.3.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-7-6.4">
          <p id="section-7-6.4.1"><a href="#per" class="auto internal xref">Section 7.4</a> describes the enroll exchange initiated by the Registrar-Agent to the registrar including the interaction of the registrar with the CA using the PER as well as the artifact processing by these entities.<a href="#section-7-6.4.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-7-6.5">
          <p id="section-7-6.5.1"><a href="#obtain_cacerts" class="auto internal xref">Section 7.5</a> describes the retrieval exchange for the optional CA certificate provisioning to the pledge initiated by the Registrar-Agent to the CA.<a href="#section-7-6.5.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-7-6.6">
          <p id="section-7-6.6.1"><a href="#voucher" class="auto internal xref">Section 7.6</a> describes the Voucher exchange initiated by the Registrar-Agent to the pledge and the returned status information.<a href="#section-7-6.6.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-7-6.7">
          <p id="section-7-6.7.1"><a href="#cacerts" class="auto internal xref">Section 7.7</a> describes the CA certificate exchange initiated by the Registrar-Agent to the pledge.<a href="#section-7-6.7.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-7-6.8">
          <p id="section-7-6.8.1"><a href="#enroll_response" class="auto internal xref">Section 7.8</a> describes the Enroll-Response exchange initiated by the Registrar-Agent to the pledge (containing a new pledge EE certificate) and the returned status information.<a href="#section-7-6.8.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-7-6.9">
          <p id="section-7-6.9.1"><a href="#vstatus" class="auto internal xref">Section 7.9</a> describes the Voucher Status telemetry exchange initiated by the Registrar-Agent to the registrar, including the interaction of the registrar with the MASA.<a href="#section-7-6.9.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-7-6.10">
          <p id="section-7-6.10.1"><a href="#estatus" class="auto internal xref">Section 7.10</a> describes the Enroll Status telemetry exchange initiated by the Registrar-Agent to the registrar.<a href="#section-7-6.10.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-7-6.11">
          <p id="section-7-6.11.1"><a href="#query" class="auto internal xref">Section 7.11</a> describes the Pledge Status exchange about the general bootstrapping state initiated by the Registrar-Agent to the pledge.<a href="#section-7-6.11.1" class="pilcrow">¶</a></p>
</li>
      </ol>
<div id="tpvr">
<section id="section-7.1">
        <h3 id="name-trigger-pledge-voucher-requ">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-trigger-pledge-voucher-requ" class="section-name selfRef">Trigger Pledge Voucher-Request</a>
        </h3>
<p id="section-7.1-1">The Registrar-Agent <span class="bcp14">MUST</span> begin the sequence of exchanges by sending the Pledge Voucher-Request Trigger (tPVR).
This assumes that the Registrar-Agent has already discovered the pledge, for instance as described in <a href="#discovery_uc2_ppa" class="auto internal xref">Section 6.1.2</a> based on DNS-SD or similar.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">TLS <span class="bcp14">MAY</span> be used to provide transport security, e.g., privacy and peer authentication, for the exchange between the Registrar-Agent and the pledge (see <a href="#pledgehttps" class="auto internal xref">Appendix B</a>).<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3"><a href="#exchangesfig_uc2_1" class="auto internal xref">Figure 5</a> shows the acquisition of the Pledge Voucher-Request (PVR) and the following subsections describe the corresponding artifacts.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
<span id="name-pvr-acquisition-exchange"></span><div id="exchangesfig_uc2_1">
<figure id="figure-5">
          <div id="section-7.1-4.1">
            <div class="alignCenter art-svg artwork" id="section-7.1-4.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="256" width="576" viewBox="0 0 576 256" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,32 L 8,80" fill="none" stroke="black"></path>
                <path d="M 16,160 L 16,224" fill="none" stroke="black"></path>
                <path d="M 80,32 L 80,80" fill="none" stroke="black"></path>
                <path d="M 120,32 L 120,80" fill="none" stroke="black"></path>
                <path d="M 168,160 L 168,224" fill="none" stroke="black"></path>
                <path d="M 224,32 L 224,80" fill="none" stroke="black"></path>
                <path d="M 264,32 L 264,80" fill="none" stroke="black"></path>
                <path d="M 312,160 L 312,224" fill="none" stroke="black"></path>
                <path d="M 360,32 L 360,80" fill="none" stroke="black"></path>
                <path d="M 400,32 L 400,80" fill="none" stroke="black"></path>
                <path d="M 456,160 L 456,224" fill="none" stroke="black"></path>
                <path d="M 472,32 L 472,80" fill="none" stroke="black"></path>
                <path d="M 512,32 L 512,80" fill="none" stroke="black"></path>
                <path d="M 560,160 L 560,224" fill="none" stroke="black"></path>
                <path d="M 568,32 L 568,80" fill="none" stroke="black"></path>
                <path d="M 8,32 L 80,32" fill="none" stroke="black"></path>
                <path d="M 120,32 L 224,32" fill="none" stroke="black"></path>
                <path d="M 264,32 L 360,32" fill="none" stroke="black"></path>
                <path d="M 400,32 L 472,32" fill="none" stroke="black"></path>
                <path d="M 512,32 L 568,32" fill="none" stroke="black"></path>
                <path d="M 8,80 L 80,80" fill="none" stroke="black"></path>
                <path d="M 120,80 L 224,80" fill="none" stroke="black"></path>
                <path d="M 264,80 L 360,80" fill="none" stroke="black"></path>
                <path d="M 400,80 L 472,80" fill="none" stroke="black"></path>
                <path d="M 512,80 L 568,80" fill="none" stroke="black"></path>
                <path d="M 24,176 L 56,176" fill="none" stroke="black"></path>
                <path d="M 128,176 L 160,176" fill="none" stroke="black"></path>
                <path d="M 24,192 L 72,192" fill="none" stroke="black"></path>
                <path d="M 112,192 L 160,192" fill="none" stroke="black"></path>
                <path d="M 24,208 L 80,208" fill="none" stroke="black"></path>
                <path d="M 112,208 L 160,208" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="168,208 156,202.4 156,213.6" fill="black" transform="rotate(0,160,208)"></polygon>
                <polygon class="arrowhead" points="168,176 156,170.4 156,181.6" fill="black" transform="rotate(0,160,176)"></polygon>
                <polygon class="arrowhead" points="32,192 20,186.4 20,197.6" fill="black" transform="rotate(180,24,192)"></polygon>
                <polygon class="arrowhead" points="32,176 20,170.4 20,181.6" fill="black" transform="rotate(180,24,176)"></polygon>
                <g class="text">
                  <text x="44" y="52">Pledge</text>
                  <text x="172" y="52">Registrar-</text>
                  <text x="308" y="52">Domain</text>
                  <text x="432" y="52">Key</text>
                  <text x="540" y="52">MASA</text>
                  <text x="168" y="68">Agent</text>
                  <text x="312" y="68">Registrar</text>
                  <text x="436" y="68">Infra.</text>
                  <text x="16" y="100">|</text>
                  <text x="168" y="100">|</text>
                  <text x="312" y="100">|</text>
                  <text x="456" y="100">|</text>
                  <text x="516" y="100">Internet</text>
                  <text x="560" y="100">|</text>
                  <text x="16" y="116">~</text>
                  <text x="168" y="116">~</text>
                  <text x="312" y="116">~</text>
                  <text x="456" y="116">~</text>
                  <text x="560" y="116">~</text>
                  <text x="16" y="132">(1)</text>
                  <text x="64" y="132">Trigger</text>
                  <text x="124" y="132">Pledge</text>
                  <text x="216" y="132">Voucher-Request</text>
                  <text x="16" y="148">~</text>
                  <text x="168" y="148">~</text>
                  <text x="312" y="148">~</text>
                  <text x="456" y="148">~</text>
                  <text x="560" y="148">~</text>
                  <text x="76" y="180">opt.</text>
                  <text x="112" y="180">TLS</text>
                  <text x="92" y="196">tPVR</text>
                  <text x="96" y="212">PVR</text>
                  <text x="16" y="244">~</text>
                  <text x="168" y="244">~</text>
                  <text x="312" y="244">~</text>
                  <text x="456" y="244">~</text>
                  <text x="560" y="244">~</text>
                </g>
              </svg><a href="#section-7.1-4.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-pvr-acquisition-exchange" class="selfRef">PVR acquisition exchange</a>
          </figcaption></figure>
</div>
<p id="section-7.1-5">The Registrar-Agent <span class="bcp14">SHALL</span> trigger the pledge to create a PVR via HTTP(S) POST to the pledge endpoint at <code>/.well-known/brski/tpvr</code>.
The request body <span class="bcp14">MUST</span> contain the JSON-based Pledge Voucher-Request Trigger (tPVR) artifact as defined in <a href="#tpvr_artifact" class="auto internal xref">Section 7.1.1</a>.
In the request header, the Content-Type field <span class="bcp14">MUST</span> be set to <code>application/json</code> and the Accept field <span class="bcp14">SHOULD</span> be set to <code>application/voucher-jws+json</code> as defined in <span>[<a href="#I-D.ietf-anima-jws-voucher" class="cite xref">I-D.ietf-anima-jws-voucher</a>]</span>.<a href="#section-7.1-5" class="pilcrow">¶</a></p>
<p id="section-7.1-6">Upon receiving a valid tPVR, the pledge <span class="bcp14">MUST</span> reply with the PVR artifact as defined in <a href="#pvr_artifact" class="auto internal xref">Section 7.1.2</a> in the body of an HTTP 200 OK response.
If the Accept header was not provided in the PVR, the pledge assumes that the accepted response format is <code>application/voucher-jws+json</code> and proceeds processing.
In the response header, the Content-Type field <span class="bcp14">MUST</span> be set to <code>application/voucher-jws+json</code> as defined in <span>[<a href="#I-D.ietf-anima-jws-voucher" class="cite xref">I-D.ietf-anima-jws-voucher</a>]</span>.<a href="#section-7.1-6" class="pilcrow">¶</a></p>
<p id="section-7.1-7">Note that the pledge provisionally accepts the registrar EE certificate contained in the tPVR until it receives the voucher (see <a href="#agt_prx" class="auto internal xref">Section 5.4</a>).
The pledge will take the last received tPVR for the provisional accept of the received registrar EE certificate, if it does not have the capability to store more that one registrar EE certificate.<a href="#section-7.1-7" class="pilcrow">¶</a></p>
<p id="section-7.1-8">If the pledge is unable to create the PVR, it <span class="bcp14">SHOULD</span> respond with an HTTP error status code to the Registrar-Agent.
The following client error status codes <span class="bcp14">SHOULD</span> be used:<a href="#section-7.1-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-9.1">
            <p id="section-7.1-9.1.1">400 Bad Request: if the pledge detects an error in the format of the request, e.g., missing field, wrong data types, etc. or if the request is not valid JSON even though the Content-Type request header field was set to <code>application/json</code>.<a href="#section-7.1-9.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-9.2">
            <p id="section-7.1-9.2.1">406 Not Acceptable: if the Accept request header field indicates a type that is unknown or unsupported, e.g., a type other than <code>application/voucher-jws+json</code>.<a href="#section-7.1-9.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-9.3">
            <p id="section-7.1-9.3.1">415 Unsupported Media Type: if the Content-Type request header field indicates a type that is unknown or unsupported, e.g., a type other than <code>application/json</code>.<a href="#section-7.1-9.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.1-10">The pledge <span class="bcp14">MAY</span> use the response body to signal success/failure details to the service technician operating the Registrar-Agent.<a href="#section-7.1-10" class="pilcrow">¶</a></p>
<p id="section-7.1-11">While BRSKI-PRM does not specify which content may be provided in the response body, it is recommended to provided it as JSON encoded information as other BRSKI-PRM exchanges also utilize this encoding.<a href="#section-7.1-11" class="pilcrow">¶</a></p>
<div id="tpvr_artifact">
<section id="section-7.1.1">
          <h4 id="name-request-artifact-pledge-vou">
<a href="#section-7.1.1" class="section-number selfRef">7.1.1. </a><a href="#name-request-artifact-pledge-vou" class="section-name selfRef">Request Artifact: Pledge Voucher-Request Trigger (tPVR)</a>
          </h4>
<p id="section-7.1.1-1">The Pledge Voucher-Request Trigger (tPVR) artifact <span class="bcp14">SHALL</span> be an unsigned data object, providing the necessary parameters for generating the Pledge Voucher-Request (PVR) artifact such that the Agent Proximity Assertion can be verified by registrar and MASA:
the registrar EE certificate and an agent-signed data object containing the product-serial-number and a timestamp.
The artifact is unsigned because at the time of receiving the tPVR, the pledge could not verify any signature.<a href="#section-7.1.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1.1-2">For the JSON-based format used by this specification, the tPVR artifact <span class="bcp14">SHALL</span> be a UTF-8 encoded JSON document <span>[<a href="#RFC8259" class="cite xref">RFC8259</a>]</span> that conforms with the CDDL <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> data model defined in <a href="#tpvr_CDDL_def" class="auto internal xref">Figure 6</a>:<a href="#section-7.1.1-2" class="pilcrow">¶</a></p>
<span id="name-cddl-for-pledge-voucher-req"></span><div id="tpvr_CDDL_def">
<figure id="figure-6">
            <div class="alignLeft art-cddl art-text artwork" id="section-7.1.1-3.1">
<pre>
  pledgevoucherrequesttrigger = {
    "agent-provided-proximity-registrar-cert": bytes,
    "agent-signed-data": bytes
  }
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-cddl-for-pledge-voucher-req" class="selfRef">CDDL for Pledge Voucher-Request Trigger (pledgevoucherrequesttrigger)</a>
            </figcaption></figure>
</div>
<p id="section-7.1.1-4">The <code>agent-provided-proximity-registrar-cert</code> member <span class="bcp14">SHALL</span> contain the base64-encoded registrar EE certificate in X.509 v3 (DER) format.
The <code>agent-signed-data</code> member <span class="bcp14">SHALL</span> contain the base64-encoded JWS Agent-Signed Data as defined in <a href="#jws-asd" class="auto internal xref">Section 7.1.1.1</a>.
<a href="#tpvr_example" class="auto internal xref">Figure 7</a> summarizes the serialization the JSON tPVR artifact:<a href="#section-7.1.1-4" class="pilcrow">¶</a></p>
<span id="name-tpvr-representation-in-json"></span><div id="tpvr_example">
<figure id="figure-7">
            <div class="alignLeft art-text artwork" id="section-7.1.1-5.1">
<pre>
{
  "agent-provided-proximity-registrar-cert": "base64encodedvalue==",
  "agent-signed-data": BASE64(UTF8(JWS Agent-Signed Data))
}
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-tpvr-representation-in-json" class="selfRef">tPVR Representation in JSON</a>
            </figcaption></figure>
</div>
<div id="jws-asd">
<section id="section-7.1.1.1">
            <h5 id="name-jws-agent-signed-data">
<a href="#section-7.1.1.1" class="section-number selfRef">7.1.1.1. </a><a href="#name-jws-agent-signed-data" class="section-name selfRef">JWS Agent-Signed Data</a>
            </h5>
<p id="section-7.1.1.1-1">To enable alternative formats, the YANG module in <span>[<a href="#I-D.ietf-anima-rfc8366bis" class="cite xref">I-D.ietf-anima-rfc8366bis</a>]</span> defines the leaf <code>agent-signed-data</code> as binary.
For the JWS-signed JSON format used by this specification, the <code>agent-signed-data</code> leaf <span class="bcp14">SHALL</span> be a UTF-8 encoded JWS structure in "General JWS JSON Serialization Syntax" as defined in <span><a href="https://rfc-editor.org/rfc/rfc7515#section-7.2.1" class="relref">Section 7.2.1</a> of [<a href="#RFC7515" class="cite xref">RFC7515</a>]</span> signing the JSON Agent-Signed Data defined in <a href="#prm-asd" class="auto internal xref">Section 7.1.1.1.1</a>.
<a href="#asd_representation" class="auto internal xref">Figure 8</a> summarizes this JWS structure for the <code>agent-signed-data</code> member of the tPVR artifact:<a href="#section-7.1.1.1-1" class="pilcrow">¶</a></p>
<span id="name-jws-agent-signed-data-in-ge"></span><div id="asd_representation">
<figure id="figure-8">
              <div class="alignLeft art-text artwork" id="section-7.1.1.1-2.1">
<pre>
{
  "payload": BASE64URL(UTF8(JSON Agent-Signed Data)),
  "signatures": [
    {
      "protected": BASE64URL(UTF8(JWS Protected Header)),
      "signature": BASE64URL(JWS Signature)
    }
  ]
}
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-jws-agent-signed-data-in-ge" class="selfRef">JWS Agent-Signed Data in General JWS JSON Serialization Syntax</a>
              </figcaption></figure>
</div>
<p id="section-7.1.1.1-3">The JSON Agent-Signed Data <span class="bcp14">MUST</span> be UTF-8 encoded to become the octet-based JWS Payload defined in <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.
The JWS Payload is further base64url-encoded to become the string value of the <code>payload</code> member as described in <span><a href="https://rfc-editor.org/rfc/rfc7515#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.
The octets of the UTF-8 representation of the JWS Protected Header are base64url-encoded to become the string value of the <code>protected</code> member.
The generated JWS Signature is base64url-encoded to become the string value of the <code>signature</code> member.<a href="#section-7.1.1.1-3" class="pilcrow">¶</a></p>
<div id="prm-asd">
<section id="section-7.1.1.1.1">
              <h6 id="name-json-agent-signed-data">
<a href="#section-7.1.1.1.1" class="section-number selfRef">7.1.1.1.1. </a><a href="#name-json-agent-signed-data" class="section-name selfRef">JSON Agent-Signed Data</a>
              </h6>
<p id="section-7.1.1.1.1-1">The JSON Agent-Signed Data <span class="bcp14">SHALL</span> be a JSON document <span>[<a href="#RFC8259" class="cite xref">RFC8259</a>]</span> that <span class="bcp14">MUST</span> conform with the CDDL <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> data model defined in <a href="#prmasd_CDDL_def" class="auto internal xref">Figure 9</a>:<a href="#section-7.1.1.1.1-1" class="pilcrow">¶</a></p>
<span id="name-cddl-for-json-agent-signed-"></span><div id="prmasd_CDDL_def">
<figure id="figure-9">
                <div class="alignLeft art-cddl art-text artwork" id="section-7.1.1.1.1-2.1">
<pre>
  prmasd = {
    "created-on": tdate,
    "serial-number": text
  }
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-cddl-for-json-agent-signed-" class="selfRef">CDDL for JSON Agent-Signed Data (prmasd)</a>
                </figcaption></figure>
</div>
<p id="section-7.1.1.1.1-3">The <code>created-on</code> member <span class="bcp14">SHALL</span> contain the current date and time at tPVR creation as standard date/time string as defined in <span><a href="https://rfc-editor.org/rfc/rfc3339#section-5.6" class="relref">Section 5.6</a> of [<a href="#RFC3339" class="cite xref">RFC3339</a>]</span>.<a href="#section-7.1.1.1.1-3" class="pilcrow">¶</a></p>
<p id="section-7.1.1.1.1-4">The <code>serial-number</code> member <span class="bcp14">SHALL</span> contain the product-serial-number of the pledge with which the Registrar-Agent assumes to communicate as string.
The format <span class="bcp14">MUST</span> correspond to the X520SerialNumber field of IDevID certificates.<a href="#section-7.1.1.1.1-4" class="pilcrow">¶</a></p>
<p id="section-7.1.1.1.1-5"><a href="#prmasd_payload" class="auto internal xref">Figure 10</a> below shows an example for the JSON Agent-Signed Data:<a href="#section-7.1.1.1.1-5" class="pilcrow">¶</a></p>
<span id="name-json-agent-signed-data-exam"></span><div id="prmasd_payload">
<figure id="figure-10">
                <div class="alignLeft art-json art-text artwork" id="section-7.1.1.1.1-6.1">
<pre>
{
  "created-on": "2021-04-16T00:00:01.000Z",
  "serial-number": "vendor-pledge4711"
}
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-json-agent-signed-data-exam" class="selfRef">JSON Agent-Signed Data Example</a>
                </figcaption></figure>
</div>
</section>
</div>
<div id="jws-protected-header">
<section id="section-7.1.1.1.2">
              <h6 id="name-jws-protected-header">
<a href="#section-7.1.1.1.2" class="section-number selfRef">7.1.1.1.2. </a><a href="#name-jws-protected-header" class="section-name selfRef">JWS Protected Header</a>
              </h6>
<p id="section-7.1.1.1.2-1">The JWS Protected Header of the <code>agent-signed-data</code> member <span class="bcp14">MUST</span> contain the following standard Header Parameters as defined in <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>:<a href="#section-7.1.1.1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1.1.1.2-2.1">
                  <p id="section-7.1.1.1.2-2.1.1"><code>alg</code>: <span class="bcp14">SHALL</span> contain the algorithm type used to create the signature, e.g., <code>ES256</code>, as defined in <span><a href="https://rfc-editor.org/rfc/rfc7515#section-4.1.1" class="relref">Section 4.1.1</a> of [<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.<a href="#section-7.1.1.1.2-2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-7.1.1.1.2-2.2">
                  <p id="section-7.1.1.1.2-2.2.1"><code>kid</code>: <span class="bcp14">SHALL</span> contain the base64-encoded OCTET STRING value of the SubjectKeyIdentifier of the Registrar-Agent EE certificate as described in <a href="#agent_component" class="auto internal xref">Section 6.1</a>.<a href="#section-7.1.1.1.2-2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-7.1.1.1.2-3"><a href="#asd_header" class="auto internal xref">Figure 11</a> shows an example for this JWS Protected Header:<a href="#section-7.1.1.1.2-3" class="pilcrow">¶</a></p>
<span id="name-jws-protected-header-exampl"></span><div id="asd_header">
<figure id="figure-11">
                <div class="alignLeft art-text artwork" id="section-7.1.1.1.2-4.1">
<pre>
{
  "alg": "ES256",
  "kid": "base64encodedvalue=="
}
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-jws-protected-header-exampl" class="selfRef">JWS Protected Header Example for</a>
                </figcaption></figure>
</div>
</section>
</div>
<div id="jws-signature">
<section id="section-7.1.1.1.3">
              <h6 id="name-jws-signature">
<a href="#section-7.1.1.1.3" class="section-number selfRef">7.1.1.1.3. </a><a href="#name-jws-signature" class="section-name selfRef">JWS Signature</a>
              </h6>
<p id="section-7.1.1.1.3-1">The Registrar-Agent <span class="bcp14">MUST</span> sign the <code>agent-signed-data</code> member using its EE credentials.
The JWS Signature is generated over the JWS Protected Header and the JWS Payload as described in <span><a href="https://rfc-editor.org/rfc/rfc7515#section-5.1" class="relref">Section 5.1</a> of [<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.<a href="#section-7.1.1.1.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="pvr_artifact">
<section id="section-7.1.2">
          <h4 id="name-response-artifact-pledge-vo">
<a href="#section-7.1.2" class="section-number selfRef">7.1.2. </a><a href="#name-response-artifact-pledge-vo" class="section-name selfRef">Response Artifact: Pledge Voucher-Request (PVR)</a>
          </h4>
<p id="section-7.1.2-1">The Pledge Voucher-Request (PVR) artifact <span class="bcp14">SHALL</span> be an authenticated self-contained object signed by the pledge, containing an extended Voucher-Request artifact based on <span><a href="https://rfc-editor.org/rfc/rfc8995#section-5.2" class="relref">Section 5.2</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>.
The BRSKI-PRM related enhancements of the <code>ietf-voucher-request</code> YANG module are defined in <span>[<a href="#I-D.ietf-anima-rfc8366bis" class="cite xref">I-D.ietf-anima-rfc8366bis</a>]</span>.<a href="#section-7.1.2-1" class="pilcrow">¶</a></p>
<p id="section-7.1.2-2">For the JWS-signed JSON format used by this specification, the PVR artifact <span class="bcp14">MUST</span> be a JWS Voucher structure as defined in <span>[<a href="#I-D.ietf-anima-jws-voucher" class="cite xref">I-D.ietf-anima-jws-voucher</a>]</span>, which <span class="bcp14">MUST</span> contain the JSON PVR Data defined in <a href="#pvr_data" class="auto internal xref">Section 7.1.2.1</a> in the JWS Payload.
<a href="#pvr_representation" class="auto internal xref">Figure 12</a> summarizes the serialization of the JWS-signed JSON PVR artifact:<a href="#section-7.1.2-2" class="pilcrow">¶</a></p>
<span id="name-pvr-representation-in-gener"></span><div id="pvr_representation">
<figure id="figure-12">
            <div class="alignLeft art-text artwork" id="section-7.1.2-3.1">
<pre>
{
  "payload": BASE64URL(UTF8(JSON PVR Data)),
  "signatures": [
    {
      "protected": BASE64URL(UTF8(JWS Protected Header)),
      "signature": BASE64URL(JWS Signature)
    }
  ]
}
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-pvr-representation-in-gener" class="selfRef">PVR Representation in General JWS JSON Serialization Syntax</a>
            </figcaption></figure>
</div>
<div id="pvr_data">
<section id="section-7.1.2.1">
            <h5 id="name-json-pvr-data">
<a href="#section-7.1.2.1" class="section-number selfRef">7.1.2.1. </a><a href="#name-json-pvr-data" class="section-name selfRef">JSON PVR Data</a>
            </h5>
<p id="section-7.1.2.1-1">The JSON PVR Data <span class="bcp14">MUST</span> contain the following fields of the <code>ietf-voucher-request</code> YANG module as defined in <span>[<a href="#I-D.ietf-anima-rfc8366bis" class="cite xref">I-D.ietf-anima-rfc8366bis</a>]</span>;
note that this makes optional leaf data nodes in the YANG definition mandatory for the PVR artifact:<a href="#section-7.1.2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1.2.1-2.1">
                <p id="section-7.1.2.1-2.1.1"><code>created-on</code>: <span class="bcp14">SHALL</span> contain the current date and time at PVR creation as standard date/time string as defined in <span><a href="https://rfc-editor.org/rfc/rfc3339#section-5.6" class="relref">Section 5.6</a> of [<a href="#RFC3339" class="cite xref">RFC3339</a>]</span>;
if the pledge does not have synchronized time, it <span class="bcp14">SHALL</span> use the <code>created-on</code> value from the JSON Agent-Signed Data received with the tPVR artifact and <span class="bcp14">SHOULD</span> advance that value based on its local clock to reflect the PVR creation time.<a href="#section-7.1.2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.1.2.1-2.2">
                <p id="section-7.1.2.1-2.2.1"><code>nonce</code>: <span class="bcp14">SHALL</span> contain a cryptographically strong pseudo-random number.<a href="#section-7.1.2.1-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.1.2.1-2.3">
                <p id="section-7.1.2.1-2.3.1"><code>serial-number</code>: <span class="bcp14">SHALL</span> contain the product-serial-number in the X520SerialNumber field of the pledge IDevID certificate as string as defined in <span><a href="https://rfc-editor.org/rfc/rfc8995#section-2.3.1" class="relref">Section 2.3.1</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>.<a href="#section-7.1.2.1-2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.1.2.1-2.4">
                <p id="section-7.1.2.1-2.4.1"><code>assertion</code>: <span class="bcp14">SHALL</span> contain the assertion type <code>agent-proximity</code> to indicate the pledge request (different from BRSKI <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>).<a href="#section-7.1.2.1-2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.1.2.1-2.5">
                <p id="section-7.1.2.1-2.5.1"><code>agent-provided-proximity-registrar-cert</code>: <span class="bcp14">SHALL</span> contain the base64-encoded registrar EE certificate provided in the tPVR by the Registrar-Agent;
enables the registrar and MASA to verify the Agent Proximity Assertion.<a href="#section-7.1.2.1-2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.1.2.1-2.6">
                <p id="section-7.1.2.1-2.6.1"><code>agent-signed-data</code>: <span class="bcp14">SHALL</span> contain the same value as the <code>agent-signed-data</code> member in the tPVR provided by the Registrar-Agent;
enables the registrar and MASA to verify the Agent Proximity Assertion;
also enables the registrar to log which Registrar-Agent was in contact with the pledge.<a href="#section-7.1.2.1-2.6.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-7.1.2.1-3"><a href="#pvr_data_example" class="auto internal xref">Figure 13</a> shows an example for the JSON PVR Data:<a href="#section-7.1.2.1-3" class="pilcrow">¶</a></p>
<span id="name-json-pvr-data-example"></span><div id="pvr_data_example">
<figure id="figure-13">
              <div class="alignLeft art-json art-text artwork" id="section-7.1.2.1-4.1">
<pre>
{
  "ietf-voucher-request:voucher": {
     "created-on": "2021-04-16T00:00:02.000Z",
     "nonce": "eDs++/FuDHGUnRxN3E14CQ==",
     "serial-number": "vendor-pledge4711",
     "assertion": "agent-proximity",
     "agent-provided-proximity-registrar-cert": "base64encodedvalue==",
     "agent-signed-data": "base64encodedvalue=="
  }
}
</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-json-pvr-data-example" class="selfRef">JSON PVR Data Example</a>
              </figcaption></figure>
</div>
</section>
</div>
<div id="jws-protected-header-1">
<section id="section-7.1.2.2">
            <h5 id="name-jws-protected-header-2">
<a href="#section-7.1.2.2" class="section-number selfRef">7.1.2.2. </a><a href="#name-jws-protected-header-2" class="section-name selfRef">JWS Protected Header</a>
            </h5>
<p id="section-7.1.2.2-1">The JWS Protected Header <span class="bcp14">MUST</span> follow the definitions of <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-anima-jws-voucher-16#section-3.2" class="relref">Section 3.2</a> of [<a href="#I-D.ietf-anima-jws-voucher" class="cite xref">I-D.ietf-anima-jws-voucher</a>]</span>.<a href="#section-7.1.2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="jws-signature-1">
<section id="section-7.1.2.3">
            <h5 id="name-jws-signature-2">
<a href="#section-7.1.2.3" class="section-number selfRef">7.1.2.3. </a><a href="#name-jws-signature-2" class="section-name selfRef">JWS Signature</a>
            </h5>
<p id="section-7.1.2.3-1">The pledge <span class="bcp14">MUST</span> sign the PVR artifact using its IDevID credential following the definitions of <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-anima-jws-voucher-16#section-3.3" class="relref">Section 3.3</a> of [<a href="#I-D.ietf-anima-jws-voucher" class="cite xref">I-D.ietf-anima-jws-voucher</a>]</span>.<a href="#section-7.1.2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="tper">
<section id="section-7.2">
        <h3 id="name-trigger-pledge-enroll-reque">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-trigger-pledge-enroll-reque" class="section-name selfRef">Trigger Pledge Enroll-Request</a>
        </h3>
<p id="section-7.2-1">Once the Registrar-Agent has received the PVR it can trigger the pledge to generate a Pledge Enroll-Request (PER).<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">TLS <span class="bcp14">MAY</span> be used to provide privacy for this exchange between the Registrar-Agent and the pledge (see <a href="#pledgehttps" class="auto internal xref">Appendix B</a>).<a href="#section-7.2-2" class="pilcrow">¶</a></p>
<p id="section-7.2-3"><a href="#exchangesfig_uc2_2" class="auto internal xref">Figure 14</a> shows the acquisition of the PER and the following subsections describe the corresponding artifacts.<a href="#section-7.2-3" class="pilcrow">¶</a></p>
<span id="name-per-acquisition-exchange"></span><div id="exchangesfig_uc2_2">
<figure id="figure-14">
          <div id="section-7.2-4.1">
            <div class="alignCenter art-svg artwork" id="section-7.2-4.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="256" width="576" viewBox="0 0 576 256" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,32 L 8,80" fill="none" stroke="black"></path>
                <path d="M 16,160 L 16,224" fill="none" stroke="black"></path>
                <path d="M 80,32 L 80,80" fill="none" stroke="black"></path>
                <path d="M 120,32 L 120,80" fill="none" stroke="black"></path>
                <path d="M 168,160 L 168,224" fill="none" stroke="black"></path>
                <path d="M 224,32 L 224,80" fill="none" stroke="black"></path>
                <path d="M 264,32 L 264,80" fill="none" stroke="black"></path>
                <path d="M 312,160 L 312,224" fill="none" stroke="black"></path>
                <path d="M 360,32 L 360,80" fill="none" stroke="black"></path>
                <path d="M 400,32 L 400,80" fill="none" stroke="black"></path>
                <path d="M 456,160 L 456,224" fill="none" stroke="black"></path>
                <path d="M 472,32 L 472,80" fill="none" stroke="black"></path>
                <path d="M 512,32 L 512,80" fill="none" stroke="black"></path>
                <path d="M 560,160 L 560,224" fill="none" stroke="black"></path>
                <path d="M 568,32 L 568,80" fill="none" stroke="black"></path>
                <path d="M 8,32 L 80,32" fill="none" stroke="black"></path>
                <path d="M 120,32 L 224,32" fill="none" stroke="black"></path>
                <path d="M 264,32 L 360,32" fill="none" stroke="black"></path>
                <path d="M 400,32 L 472,32" fill="none" stroke="black"></path>
                <path d="M 512,32 L 568,32" fill="none" stroke="black"></path>
                <path d="M 8,80 L 80,80" fill="none" stroke="black"></path>
                <path d="M 120,80 L 224,80" fill="none" stroke="black"></path>
                <path d="M 264,80 L 360,80" fill="none" stroke="black"></path>
                <path d="M 400,80 L 472,80" fill="none" stroke="black"></path>
                <path d="M 512,80 L 568,80" fill="none" stroke="black"></path>
                <path d="M 24,176 L 56,176" fill="none" stroke="black"></path>
                <path d="M 128,176 L 160,176" fill="none" stroke="black"></path>
                <path d="M 24,192 L 72,192" fill="none" stroke="black"></path>
                <path d="M 112,192 L 160,192" fill="none" stroke="black"></path>
                <path d="M 24,208 L 80,208" fill="none" stroke="black"></path>
                <path d="M 112,208 L 160,208" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="168,208 156,202.4 156,213.6" fill="black" transform="rotate(0,160,208)"></polygon>
                <polygon class="arrowhead" points="168,176 156,170.4 156,181.6" fill="black" transform="rotate(0,160,176)"></polygon>
                <polygon class="arrowhead" points="32,192 20,186.4 20,197.6" fill="black" transform="rotate(180,24,192)"></polygon>
                <polygon class="arrowhead" points="32,176 20,170.4 20,181.6" fill="black" transform="rotate(180,24,176)"></polygon>
                <g class="text">
                  <text x="44" y="52">Pledge</text>
                  <text x="172" y="52">Registrar-</text>
                  <text x="308" y="52">Domain</text>
                  <text x="432" y="52">Key</text>
                  <text x="540" y="52">MASA</text>
                  <text x="168" y="68">Agent</text>
                  <text x="312" y="68">Registrar</text>
                  <text x="436" y="68">Infra.</text>
                  <text x="16" y="100">|</text>
                  <text x="168" y="100">|</text>
                  <text x="312" y="100">|</text>
                  <text x="456" y="100">|</text>
                  <text x="516" y="100">Internet</text>
                  <text x="560" y="100">|</text>
                  <text x="16" y="116">~</text>
                  <text x="168" y="116">~</text>
                  <text x="312" y="116">~</text>
                  <text x="456" y="116">~</text>
                  <text x="560" y="116">~</text>
                  <text x="16" y="132">(2)</text>
                  <text x="64" y="132">Trigger</text>
                  <text x="124" y="132">Pledge</text>
                  <text x="212" y="132">Enroll-Request</text>
                  <text x="16" y="148">~</text>
                  <text x="168" y="148">~</text>
                  <text x="312" y="148">~</text>
                  <text x="456" y="148">~</text>
                  <text x="560" y="148">~</text>
                  <text x="76" y="180">opt.</text>
                  <text x="112" y="180">TLS</text>
                  <text x="92" y="196">tPER</text>
                  <text x="96" y="212">PER</text>
                  <text x="16" y="244">~</text>
                  <text x="168" y="244">~</text>
                  <text x="312" y="244">~</text>
                  <text x="456" y="244">~</text>
                  <text x="560" y="244">~</text>
                </g>
              </svg><a href="#section-7.2-4.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-per-acquisition-exchange" class="selfRef">PER acquisition exchange</a>
          </figcaption></figure>
</div>
<p id="section-7.2-5">The Registrar-Agent <span class="bcp14">SHALL</span> trigger the pledge to create the PER via HTTP(S) POST to the pledge endpoint at <code>/.well-known/brski/tper</code>.
The request body <span class="bcp14">MUST</span> contain the JSON-based Pledge Enroll-Request Trigger (tPER) artifact as defined in <a href="#tper_artifact" class="auto internal xref">Section 7.2.1</a>.
In the request header, the Content-Type field <span class="bcp14">MUST</span> be set to <code>application/json</code> and the Accept field <span class="bcp14">SHOULD</span> be set to <code>application/jose+json</code>.<a href="#section-7.2-5" class="pilcrow">¶</a></p>
<p id="section-7.2-6">Upon receiving a valid tPER, the pledge <span class="bcp14">MUST</span> reply with the PER artifact as defined in <a href="#per_artifact" class="auto internal xref">Section 7.2.2</a> in the body of an HTTP 200 OK response.
If the Accept header was not provided in the PER, the pledge assumes that the accepted response format is <code>application/voucher-jws+json</code> and proceeds processing.
In the response header, the Content-Type field <span class="bcp14">MUST</span> be set to <code>application/jose+json</code>.<a href="#section-7.2-6" class="pilcrow">¶</a></p>
<p id="section-7.2-7">If the pledge is unable to create the PER, it <span class="bcp14">SHOULD</span> respond with an HTTP error status code to the Registrar-Agent.
The following client error status codes <span class="bcp14">MAY</span> be used:<a href="#section-7.2-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2-8.1">
            <p id="section-7.2-8.1.1">400 Bad Request: if the pledge detects an error in the format of the request.<a href="#section-7.2-8.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-8.2">
            <p id="section-7.2-8.2.1">406 Not Acceptable: if the Accept request header field indicates a type that is unknown or unsupported, e.g., a type other than <code>application/jose+json</code>.<a href="#section-7.2-8.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-8.3">
            <p id="section-7.2-8.3.1">415 Unsupported Media Type: if the Content-Type request header field indicates a type that is unknown or unsupported, e.g., a type other than <code>application/json</code>.<a href="#section-7.2-8.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.2-9">The pledge <span class="bcp14">MAY</span> use the response body to signal success/failure details to the service technician operating the Registrar-Agent.
While BRSKI-PRM does not specify which content may be provided in the response body, it is recommended to provided it as JSON encoded information as other BRSKI-PRM exchanges also utilize this encoding.<a href="#section-7.2-9" class="pilcrow">¶</a></p>
<div id="tper_artifact">
<section id="section-7.2.1">
          <h4 id="name-request-artifact-pledge-enr">
<a href="#section-7.2.1" class="section-number selfRef">7.2.1. </a><a href="#name-request-artifact-pledge-enr" class="section-name selfRef">Request Artifact: Pledge Enroll-Request Trigger (tPER)</a>
          </h4>
<p id="section-7.2.1-1">The Pledge Enroll-Request Trigger (tPVR) artifact <span class="bcp14">SHALL</span> be an unsigned data object, providing enrollment parameters.
This document specifies only the basic parameter for a generic, device-related LDevID certificate with no CSR attributes provided to the pledge.
If specific attributes in the certificate are required, they have to be inserted by the issuing Key Infrastructure.<a href="#section-7.2.1-1" class="pilcrow">¶</a></p>
<p id="section-7.2.1-2">The Pledge Enroll-Request Trigger (tPER) artifact <span class="bcp14">MAY</span> be used to provide additional enrollment parameters such as CSR attributes.
How to provide and use such additional data is out of scope for this specification.<a href="#section-7.2.1-2" class="pilcrow">¶</a></p>
<p id="section-7.2.1-3">For the JSON-based format used by this specification, the tPER artifact <span class="bcp14">MUST</span> be a UTF-8 encoded JSON document <span>[<a href="#RFC8259" class="cite xref">RFC8259</a>]</span> that conforms with the CDDL <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> data model defined in <a href="#tper_CDDL_def" class="auto internal xref">Figure 15</a>:<a href="#section-7.2.1-3" class="pilcrow">¶</a></p>
<span id="name-cddl-for-pledge-enroll-requ"></span><div id="tper_CDDL_def">
<figure id="figure-15">
            <div class="alignLeft art-cddl art-text artwork" id="section-7.2.1-4.1">
<pre>
pledgeenrollrequesttrigger = {
        "enroll-type": $enroll-type
}

$enroll-type /= "enroll-generic-cert"
</pre>
</div>
<figcaption><a href="#figure-15" class="selfRef">Figure 15</a>:
<a href="#name-cddl-for-pledge-enroll-requ" class="selfRef">CDDL for Pledge Enroll-Request Trigger (pledgeenrollrequesttrigger)</a>
            </figcaption></figure>
</div>
<p id="section-7.2.1-5">The <code>enroll-type</code> member allows for specifying which type of certificate is to be enrolled.
As shown in <a href="#tper_CDDL_def" class="auto internal xref">Figure 15</a>, BRSKI-PRM only defines the enumeration value <code>enroll-generic-cert</code> for the enrollment of the generic, device-related LDevID certificate.
Other specifications using this artifact may define further enum values, e.g., to bootstrap application-related EE certificates with additional CSR attributes.<a href="#section-7.2.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="per_artifact">
<section id="section-7.2.2">
          <h4 id="name-response-artifact-pledge-en">
<a href="#section-7.2.2" class="section-number selfRef">7.2.2. </a><a href="#name-response-artifact-pledge-en" class="section-name selfRef">Response Artifact: Pledge Enroll-Request (PER)</a>
          </h4>
<p id="section-7.2.2-1">The Pledge Enroll-Request (PER) artifact <span class="bcp14">SHALL</span> be an authenticated self-contained object signed by the pledge, containing a PKCS#10 Certificate Signing Request (CSR) <span>[<a href="#RFC2986" class="cite xref">RFC2986</a>]</span>.
The CSR already assures POP of the private key corresponding to the contained public key.
In addition, based on the PER signature using the IDevID of the pledge, POI is provided.<a href="#section-7.2.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2.2-2">For the JWS-signed JSON format used by this specification, the PER artifact <span class="bcp14">MUST</span> use the "General JWS JSON Serialization Syntax" defined in <span><a href="https://rfc-editor.org/rfc/rfc7515#section-7.2.1" class="relref">Section 7.2.1</a> of [<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>, which <span class="bcp14">MUST</span> contain the JSON CSR Data defined in <a href="#per_data" class="auto internal xref">Section 7.2.2.1</a> in the JWS Payload.
<a href="#per_representation" class="auto internal xref">Figure 16</a> summarizes the serialization of the JWS-signed JSON PER artifact:<a href="#section-7.2.2-2" class="pilcrow">¶</a></p>
<span id="name-per-representation-in-gener"></span><div id="per_representation">
<figure id="figure-16">
            <div class="alignLeft art-text artwork" id="section-7.2.2-3.1">
<pre>
{
  "payload": BASE64URL(UTF8(JSON CSR Data)),
  "signatures": [
    {
      "protected": BASE64URL(UTF8(JWS Protected Header)),
      "signature": BASE64URL(JWS Signature)
    }
  ]
}
</pre>
</div>
<figcaption><a href="#figure-16" class="selfRef">Figure 16</a>:
<a href="#name-per-representation-in-gener" class="selfRef">PER Representation in General JWS JSON Serialization Syntax</a>
            </figcaption></figure>
</div>
<p id="section-7.2.2-4">The JSON CSR Data <span class="bcp14">MUST</span> be UTF-8 encoded to become the octet-based JWS Payload defined in <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.
The JWS Payload is further base64url-encoded to become the string value of the <code>payload</code> member as described in <span><a href="https://rfc-editor.org/rfc/rfc7515#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.
The octets of the UTF-8 representation of the JWS Protected Header are base64url-encoded to become the string value of the <code>protected</code> member.
The generated JWS Signature is base64url-encoded to become the string value of the <code>signature</code> member.<a href="#section-7.2.2-4" class="pilcrow">¶</a></p>
<div id="per_data">
<section id="section-7.2.2.1">
            <h5 id="name-json-csr-data">
<a href="#section-7.2.2.1" class="section-number selfRef">7.2.2.1. </a><a href="#name-json-csr-data" class="section-name selfRef">JSON CSR Data</a>
            </h5>
<p id="section-7.2.2.1-1">The JSON CSR Data <span class="bcp14">SHALL</span> be a JSON document <span>[<a href="#RFC8259" class="cite xref">RFC8259</a>]</span> that <span class="bcp14">MUST</span> conform with the data model described by the <code>csr-grouping</code> of the <code>ietf-ztp-types</code> YANG module defined in <span><a href="https://rfc-editor.org/rfc/rfc9646#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC9646" class="cite xref">RFC9646</a>]</span> and <span class="bcp14">MUST</span> be encoded using the rules defined in <span>[<a href="#RFC7951" class="cite xref">RFC7951</a>]</span>.
Note that <span>[<a href="#RFC9646" class="cite xref">RFC9646</a>]</span> also allows for inclusion of CSRs in different formats used by CMP and CMC.
For PKCS#10 CSRs as used in BRSKI and BRSKI-PRM, the <code>p10-csr</code> case of the <code>csr-grouping</code> <span class="bcp14">MUST</span> be used.<a href="#section-7.2.2.1-1" class="pilcrow">¶</a></p>
<p id="section-7.2.2.1-2"><a href="#csr_example" class="auto internal xref">Figure 17</a> below shows an example for the JSON CSR Data:<a href="#section-7.2.2.1-2" class="pilcrow">¶</a></p>
<span id="name-json-csr-data-example"></span><div id="csr_example">
<figure id="figure-17">
              <div class="alignLeft art-text artwork" id="section-7.2.2.1-3.1">
<pre>
{
  "ietf-ztp-types": {
     "p10-csr": "base64encodedvalue=="
   }
}
</pre>
</div>
<figcaption><a href="#figure-17" class="selfRef">Figure 17</a>:
<a href="#name-json-csr-data-example" class="selfRef">JSON CSR Data Example</a>
              </figcaption></figure>
</div>
</section>
</div>
<div id="jws-protected-header-2">
<section id="section-7.2.2.2">
            <h5 id="name-jws-protected-header-3">
<a href="#section-7.2.2.2" class="section-number selfRef">7.2.2.2. </a><a href="#name-jws-protected-header-3" class="section-name selfRef">JWS Protected Header</a>
            </h5>
<p id="section-7.2.2.2-1">The JWS Protected Header of the PER artifact <span class="bcp14">MUST</span> contain the following standard Header Parameters as defined in <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>:<a href="#section-7.2.2.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2.2.2-2.1">
                <p id="section-7.2.2.2-2.1.1"><code>alg</code>: <span class="bcp14">SHALL</span> contain the algorithm type used to create the signature, e.g., <code>ES256</code>, as defined in <span><a href="https://rfc-editor.org/rfc/rfc7515#section-4.1.1" class="relref">Section 4.1.1</a> of [<a href="#RFC7515" class="cite xref">RFC7515</a>]</span><a href="#section-7.2.2.2-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.2.2.2-2.2">
                <p id="section-7.2.2.2-2.2.1"><code>x5c</code>: <span class="bcp14">SHALL</span> contain the base64-encoded pledge EE certificate used to sign the PER artifact;
it <span class="bcp14">SHOULD</span> also contain the certificate chain for this certificate;
if the certificate chain is not included in the <code>x5c</code> Header Parameter, it <span class="bcp14">MUST</span> be available at the domain registrar for verification.<a href="#section-7.2.2.2-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.2.2.2-2.3">
                <p id="section-7.2.2.2-2.3.1"><code>crit</code>: <span class="bcp14">SHALL</span> indicate the extension Header Parameter <code>created-on</code> to ensure that it must be understood and validated by the receiver as defined in <span><a href="https://rfc-editor.org/rfc/rfc7515#section-4.1.11" class="relref">Section 4.1.11</a> of [<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.<a href="#section-7.2.2.2-2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-7.2.2.2-3">In addition, the JWS Protected Header of the PER artifact <span class="bcp14">MUST</span> contain the following extension Header Parameter:<a href="#section-7.2.2.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2.2.2-4.1">
                <p id="section-7.2.2.2-4.1.1"><code>created-on</code>: <span class="bcp14">SHALL</span> contain the current date and time at PER creation as standard date/time string as defined in <span><a href="https://rfc-editor.org/rfc/rfc3339#section-5.6" class="relref">Section 5.6</a> of [<a href="#RFC3339" class="cite xref">RFC3339</a>]</span>;
if the pledge does not have synchronized time, it <span class="bcp14">SHALL</span> use the <code>created-on</code> value from the JSON Agent-Signed Data received with the tPVR artifact and <span class="bcp14">SHOULD</span> advance that value based on its local clock to reflect the PER creation time.<a href="#section-7.2.2.2-4.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-7.2.2.2-5">The new protected Header Parameter <code>created-on</code> is introduced to reflect freshness of the PER.
It allows the registrar to verify the timely correlation between the PER artifact and previous exchanges, i.e., <code>created-on</code> of PER &gt;= <code>created-on</code> of PVR &gt;= <code>created-on</code> of PVR trigger.
The registrar <span class="bcp14">MAY</span> consider ignoring any but the newest PER artifact from the same pledge in case the registrar has at any point in time more than one pending PER from the pledge.<a href="#section-7.2.2.2-5" class="pilcrow">¶</a></p>
<p id="section-7.2.2.2-6"><a href="#per_header" class="auto internal xref">Figure 18</a> shows an example for this JWS Protected Header:<a href="#section-7.2.2.2-6" class="pilcrow">¶</a></p>
<span id="name-jws-protected-header-example"></span><div id="per_header">
<figure id="figure-18">
              <div class="alignLeft art-text artwork" id="section-7.2.2.2-7.1">
<pre>
{
  "alg": "ES256",
  "x5c": [
    "base64encodedvalue==",
    "base64encodedvalue=="
  ],
  "crit": ["created-on"],
  "created-on": "2022-09-13T00:00:02.000Z"
}
</pre>
</div>
<figcaption><a href="#figure-18" class="selfRef">Figure 18</a>:
<a href="#name-jws-protected-header-example" class="selfRef">JWS Protected Header Example within PER</a>
              </figcaption></figure>
</div>
</section>
</div>
<div id="jws-signature-2">
<section id="section-7.2.2.3">
            <h5 id="name-jws-signature-3">
<a href="#section-7.2.2.3" class="section-number selfRef">7.2.2.3. </a><a href="#name-jws-signature-3" class="section-name selfRef">JWS Signature</a>
            </h5>
<p id="section-7.2.2.3-1">The pledge <span class="bcp14">MUST</span> sign the PER artifact using its IDevID credential.
The JWS Signature is generated over the JWS Protected Header and the JWS Payload as described in <span><a href="https://rfc-editor.org/rfc/rfc7515#section-5.1" class="relref">Section 5.1</a> of [<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.<a href="#section-7.2.2.3-1" class="pilcrow">¶</a></p>
<p id="section-7.2.2.3-2">While BRSKI-PRM targets the initial enrollment, re-enrollment can be supported similarly.
In this case, the pledge <span class="bcp14">MAY</span> use its current, potentially application-related EE credential instead of its IDevID credential to sign the PER artifact.
The issuing CA can associate the re-enrollment request with the pledge based on the previously issued and still valid EE certificate.
Note that a pledge that does not have synchronized time needs to advance the last known current date and time based on its local clock over a longer period, which also requires persisting the local clock advancements across reboots.<a href="#section-7.2.2.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="pvr">
<section id="section-7.3">
        <h3 id="name-supply-pvr-to-registrar-inc">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-supply-pvr-to-registrar-inc" class="section-name selfRef">Supply PVR to Registrar (including MASA interaction)</a>
        </h3>
<p id="section-7.3-1">Once the Registrar-Agent has acquired one or more PVR and PER object pairs, it starts the interaction with the domain registrar.
Collecting multiple pairs allows bulk bootstrapping of several pledges using the same session with the registrar.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3-2">The Registrar-Agent <span class="bcp14">MUST</span> establish a TLS session to the registrar with mutual authentication.
In contrast to BRSKI <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>, the TLS client authentication uses the Registrar-Agent EE certificate instead of the pledge IDevID certificate.
Consequently, the domain registrar can distinguish BRSKI (pledge-initiator-mode) from BRSKI-PRM (pledge-responder-mode).<a href="#section-7.3-2" class="pilcrow">¶</a></p>
<p id="section-7.3-3">The registrar <span class="bcp14">SHOULD</span> verify the TLS client authentication of the Registrar-Agent, in particular if the TLS session is used to obtain the Registrar-Agent EE certificate (see <a href="#registrar_component" class="auto internal xref">Section 6.3</a>).
Note that authentication and authorization of the pledge verified during the TLS session based on the signatures inside the PVR artifact.<a href="#section-7.3-3" class="pilcrow">¶</a></p>
<p id="section-7.3-4">As already stated in <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>, and required by <span>[<a href="#I-D.ietf-uta-require-tls13" class="cite xref">I-D.ietf-uta-require-tls13</a>]</span>, the use of TLS 1.3 (or newer) is encouraged.
TLS 1.2 or newer is <span class="bcp14">REQUIRED</span> on the Registrar-Agent side.
TLS 1.3 (or newer) <span class="bcp14">SHOULD</span> be available on the registrar, but TLS 1.2 <span class="bcp14">MAY</span> be used.
TLS 1.3 (or newer) <span class="bcp14">SHOULD</span> be available on the MASA, but TLS 1.2 <span class="bcp14">MAY</span> be used.<a href="#section-7.3-4" class="pilcrow">¶</a></p>
<p id="section-7.3-5"><a href="#exchangesfig_uc2_3" class="auto internal xref">Figure 19</a> shows the voucher-request processing and the following subsections describe the corresponding artifacts.<a href="#section-7.3-5" class="pilcrow">¶</a></p>
<span id="name-voucher-issuing-exchange"></span><div id="exchangesfig_uc2_3">
<figure id="figure-19">
          <div id="section-7.3-6.1">
            <div class="alignCenter art-svg artwork" id="section-7.3-6.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="480" width="576" viewBox="0 0 576 480" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,32 L 8,80" fill="none" stroke="black"></path>
                <path d="M 16,160 L 16,448" fill="none" stroke="black"></path>
                <path d="M 80,32 L 80,80" fill="none" stroke="black"></path>
                <path d="M 120,32 L 120,80" fill="none" stroke="black"></path>
                <path d="M 168,160 L 168,448" fill="none" stroke="black"></path>
                <path d="M 224,32 L 224,80" fill="none" stroke="black"></path>
                <path d="M 264,32 L 264,80" fill="none" stroke="black"></path>
                <path d="M 312,160 L 312,192" fill="none" stroke="black"></path>
                <path d="M 312,240 L 312,272" fill="none" stroke="black"></path>
                <path d="M 312,304 L 312,448" fill="none" stroke="black"></path>
                <path d="M 360,32 L 360,80" fill="none" stroke="black"></path>
                <path d="M 400,32 L 400,80" fill="none" stroke="black"></path>
                <path d="M 456,160 L 456,312" fill="none" stroke="black"></path>
                <path d="M 456,432 L 456,448" fill="none" stroke="black"></path>
                <path d="M 472,32 L 472,80" fill="none" stroke="black"></path>
                <path d="M 512,32 L 512,80" fill="none" stroke="black"></path>
                <path d="M 560,160 L 560,352" fill="none" stroke="black"></path>
                <path d="M 560,400 L 560,448" fill="none" stroke="black"></path>
                <path d="M 568,32 L 568,80" fill="none" stroke="black"></path>
                <path d="M 8,32 L 80,32" fill="none" stroke="black"></path>
                <path d="M 120,32 L 224,32" fill="none" stroke="black"></path>
                <path d="M 264,32 L 360,32" fill="none" stroke="black"></path>
                <path d="M 400,32 L 472,32" fill="none" stroke="black"></path>
                <path d="M 512,32 L 568,32" fill="none" stroke="black"></path>
                <path d="M 8,80 L 80,80" fill="none" stroke="black"></path>
                <path d="M 120,80 L 224,80" fill="none" stroke="black"></path>
                <path d="M 264,80 L 360,80" fill="none" stroke="black"></path>
                <path d="M 400,80 L 472,80" fill="none" stroke="black"></path>
                <path d="M 512,80 L 568,80" fill="none" stroke="black"></path>
                <path d="M 176,176 L 216,176" fill="none" stroke="black"></path>
                <path d="M 256,176 L 304,176" fill="none" stroke="black"></path>
                <path d="M 176,256 L 224,256" fill="none" stroke="black"></path>
                <path d="M 256,256 L 304,256" fill="none" stroke="black"></path>
                <path d="M 320,320 L 416,320" fill="none" stroke="black"></path>
                <path d="M 456,320 L 552,320" fill="none" stroke="black"></path>
                <path d="M 320,336 L 424,336" fill="none" stroke="black"></path>
                <path d="M 456,336 L 552,336" fill="none" stroke="black"></path>
                <path d="M 320,416 L 408,416" fill="none" stroke="black"></path>
                <path d="M 472,416 L 552,416" fill="none" stroke="black"></path>
                <path d="M 176,432 L 208,432" fill="none" stroke="black"></path>
                <path d="M 280,432 L 304,432" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="560,336 548,330.4 548,341.6" fill="black" transform="rotate(0,552,336)"></polygon>
                <polygon class="arrowhead" points="560,320 548,314.4 548,325.6" fill="black" transform="rotate(0,552,320)"></polygon>
                <polygon class="arrowhead" points="328,416 316,410.4 316,421.6" fill="black" transform="rotate(180,320,416)"></polygon>
                <polygon class="arrowhead" points="328,320 316,314.4 316,325.6" fill="black" transform="rotate(180,320,320)"></polygon>
                <polygon class="arrowhead" points="312,256 300,250.4 300,261.6" fill="black" transform="rotate(0,304,256)"></polygon>
                <polygon class="arrowhead" points="312,176 300,170.4 300,181.6" fill="black" transform="rotate(0,304,176)"></polygon>
                <polygon class="arrowhead" points="184,432 172,426.4 172,437.6" fill="black" transform="rotate(180,176,432)"></polygon>
                <polygon class="arrowhead" points="184,176 172,170.4 172,181.6" fill="black" transform="rotate(180,176,176)"></polygon>
                <g class="text">
                  <text x="44" y="52">Pledge</text>
                  <text x="172" y="52">Registrar-</text>
                  <text x="308" y="52">Domain</text>
                  <text x="432" y="52">Key</text>
                  <text x="540" y="52">MASA</text>
                  <text x="168" y="68">Agent</text>
                  <text x="312" y="68">Registrar</text>
                  <text x="436" y="68">Infra.</text>
                  <text x="16" y="100">|</text>
                  <text x="168" y="100">|</text>
                  <text x="312" y="100">|</text>
                  <text x="456" y="100">|</text>
                  <text x="516" y="100">Internet</text>
                  <text x="560" y="100">|</text>
                  <text x="16" y="116">~</text>
                  <text x="168" y="116">~</text>
                  <text x="312" y="116">~</text>
                  <text x="456" y="116">~</text>
                  <text x="560" y="116">~</text>
                  <text x="16" y="132">(3)</text>
                  <text x="60" y="132">Supply</text>
                  <text x="104" y="132">PVR</text>
                  <text x="132" y="132">to</text>
                  <text x="184" y="132">Registrar</text>
                  <text x="268" y="132">(including</text>
                  <text x="344" y="132">backend</text>
                  <text x="428" y="132">interaction)</text>
                  <text x="16" y="148">~</text>
                  <text x="168" y="148">~</text>
                  <text x="312" y="148">~</text>
                  <text x="456" y="148">~</text>
                  <text x="560" y="148">~</text>
                  <text x="236" y="180">mTLS</text>
                  <text x="308" y="212">[Registrar-Agent</text>
                  <text x="308" y="228">authenticated&amp;authorized?]</text>
                  <text x="240" y="260">PVR</text>
                  <text x="280" y="292">[accept</text>
                  <text x="348" y="292">device?]</text>
                  <text x="436" y="324">mTLS</text>
                  <text x="440" y="340">RVR</text>
                  <text x="456" y="356">~</text>
                  <text x="460" y="372">[extract</text>
                  <text x="536" y="372">DomainID]</text>
                  <text x="456" y="388">[update</text>
                  <text x="532" y="388">audit-log]</text>
                  <text x="456" y="404">~</text>
                  <text x="440" y="420">Voucher</text>
                  <text x="244" y="436">Voucher'</text>
                  <text x="16" y="468">~</text>
                  <text x="168" y="468">~</text>
                  <text x="312" y="468">~</text>
                  <text x="456" y="468">~</text>
                  <text x="560" y="468">~</text>
                </g>
              </svg><a href="#section-7.3-6.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-19" class="selfRef">Figure 19</a>:
<a href="#name-voucher-issuing-exchange" class="selfRef">Voucher issuing exchange</a>
          </figcaption></figure>
</div>
<p id="section-7.3-7">As a first step of the interaction with the domain registrar, the Registrar-Agent <span class="bcp14">SHALL</span> supply the PVR artifact(s) to the registrar via HTTP-over-TLS POST to the registrar endpoint at <code>/.well-known/brski/requestvoucher</code>.
Note that this is the same endpoint as for BRSKI described in <span><a href="https://rfc-editor.org/rfc/rfc8995#section-5.2" class="relref">Section 5.2</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>.
The request body <span class="bcp14">MUST</span> contain one previously acquired PVR artifact as defined in <a href="#pvr_artifact" class="auto internal xref">Section 7.1.2</a>.
In the request header, the Content-Type field <span class="bcp14">MUST</span> be set to <code>application/voucher-jws+json</code> and the Accept field <span class="bcp14">SHOULD</span> be set to <code>application/voucher-jws+json</code> as defined in <span>[<a href="#I-D.ietf-anima-jws-voucher" class="cite xref">I-D.ietf-anima-jws-voucher</a>]</span>.<a href="#section-7.3-7" class="pilcrow">¶</a></p>
<p id="section-7.3-8">Upon receiving a PVR artifact, the registrar accepts or declines the request to join the domain.
For this, it <span class="bcp14">MUST</span> perform pledge authorization as defined in <span><a href="https://rfc-editor.org/rfc/rfc8995#section-5.3" class="relref">Section 5.3</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>.
Due to the Registrar-Agent in the middle, the registrar <span class="bcp14">MUST</span> verify in addition that<a href="#section-7.3-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.3-9.1">
            <p id="section-7.3-9.1.1">the <code>agent-provided-proximity-registrar-cert</code> field of the PVR contains a registrar EE certificate signed by the same domain owner as the registrar EE certificate used to sign the RVR;
note that this check allows for installations with multiple domain registrars and for registrar EE certificate renewal between exchanges with the Registrar-Agent (see <a href="#arch_nomadic" class="auto internal xref">Section 5.2</a>);
in many installations with a single registrar the contained certificate is identical to the signing certificate.<a href="#section-7.3-9.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-9.2">
            <p id="section-7.3-9.2.1">the <code>agent-signed-data</code> field of the PVR is signed with the private key corresponding to the Registrar-Agent EE certificate as known by the registrar (see <a href="#registrar_component" class="auto internal xref">Section 6.3</a>);
this is done via the SubjectKeyIdentifier of the certificate in the <code>kid</code> Header Parameter of the JWS Protected Header of the <code>agent-signed-data</code> field.<a href="#section-7.3-9.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-9.3">
            <p id="section-7.3-9.3.1">the product-serial-number inside the <code>agent-signed-data</code> is equal to the <code>serial-number</code> field of the PVR as well as the X520SerialNumber field of the pledge IDevID certificate, which is contained in the JWS Protected Header of the PVR.<a href="#section-7.3-9.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-9.4">
            <p id="section-7.3-9.4.1">the Registrar-Agent EE certificate is still valid;
this is necessary to avoid that a rogue Registrar-Agent generates <code>agent-signed-data</code> objects to onboard arbitrary pledges at a later point in time, see also <a href="#sec_cons_reg-agt" class="auto internal xref">Section 12.3</a>.<a href="#section-7.3-9.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.3-10">If the registrar is unable to process the request or validate the PVR, it <span class="bcp14">MUST</span> respond with an HTTP client error status code to the Registrar-Agent.
The following client error status codes <span class="bcp14">SHOULD</span> be used:<a href="#section-7.3-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.3-11.1">
            <p id="section-7.3-11.1.1">400 Bad Request: if the registrar detects an error in the format of the request.<a href="#section-7.3-11.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-11.2">
            <p id="section-7.3-11.2.1">403 Forbidden: if the registrar detected that one or more security related fields are not valid or if the pledge-provided information could not be used with automated allowance.<a href="#section-7.3-11.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-11.3">
            <p id="section-7.3-11.3.1">406 Not Acceptable: if the Accept request header field indicates a type that is unknown or unsupported.<a href="#section-7.3-11.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-11.4">
            <p id="section-7.3-11.4.1">415 Unsupported Media Type: if the Content-Type request header field indicates a type that is unknown or unsupported.<a href="#section-7.3-11.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.3-12">Otherwise, the registrar converts the PVR artifact to a Registrar Voucher-Request (RVR) artifact (see <a href="#rvr_artifact" class="auto internal xref">Section 7.3.4</a>) and starts the backend interaction with the MASA.<a href="#section-7.3-12" class="pilcrow">¶</a></p>
<p id="section-7.3-13">The domain registrar <span class="bcp14">MAY</span> respond with an HTTP 202 Accepted response status code to the Registrar-Agent at this point following <span><a href="https://rfc-editor.org/rfc/rfc8995#section-5.6" class="relref">Section 5.6</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>, while the rules defined for the pledge also apply to the Registrar-Agent;
in this case, the registrar still continues with the MASA interaction to provide the Voucher artifact to the retry request.<a href="#section-7.3-13" class="pilcrow">¶</a></p>
<p id="section-7.3-14">The registrar <span class="bcp14">MAY</span> use the response body to signal success/failure details to the service technician operating the Registrar-Agent.<a href="#section-7.3-14" class="pilcrow">¶</a></p>
<div id="masa_interaction">
<section id="section-7.3.1">
          <h4 id="name-masa-interaction">
<a href="#section-7.3.1" class="section-number selfRef">7.3.1. </a><a href="#name-masa-interaction" class="section-name selfRef">MASA Interaction</a>
          </h4>
<p id="section-7.3.1-1">The domain registrar <span class="bcp14">MUST</span> establish a TLS session with mutual authentication to the MASA of the pledge according to <span><a href="https://rfc-editor.org/rfc/rfc8995#section-5.4" class="relref">Section 5.4</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>.
It requests the voucher from the MASA according to <span><a href="https://rfc-editor.org/rfc/rfc8995#section-5.5" class="relref">Section 5.5</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span> via HTTP-over-TLS POST to the MASA endpoint at <code>/.well-known/brski/requestvoucher</code>.
The request body <span class="bcp14">MUST</span> contain the RVR artifact as defined in <a href="#rvr_artifact" class="auto internal xref">Section 7.3.4</a>.
In the request header, the Content-Type field and the Accept field <span class="bcp14">MUST</span> be set to the same media type as the incoming PVR artifact.
For the default format used in this specification, this is <code>application/voucher-jws+json</code> as defined in <span>[<a href="#I-D.ietf-anima-jws-voucher" class="cite xref">I-D.ietf-anima-jws-voucher</a>]</span>.<a href="#section-7.3.1-1" class="pilcrow">¶</a></p>
<p id="section-7.3.1-2">The assumption is that a pledge typically supports a single artifact format and creates the PVR in the supported format;
to ensure that the pledge is able to process the voucher, the registrar requests this format via the HTTP Accept header field when requesting the voucher.
Further, the RVR artifact and the PVR artifact inside should also use the same format to limit the number of required format encoders.
Note that BRSKI-PRM allows for alternative formats such as CMS-signed JSON as used in BRSKI <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span> or COSE-signed CBOR for constrained environments, when defined by other specifications.
Overall, a MASA responsible for BRSKI-PRM capable pledges <span class="bcp14">MUST</span> support the same formats as supported by those pledges.<a href="#section-7.3.1-2" class="pilcrow">¶</a></p>
<p id="section-7.3.1-3">Once the MASA receives the RVR artifact, it <span class="bcp14">MUST</span> perform the verification as described in <span><a href="https://rfc-editor.org/rfc/rfc8995#section-5.5" class="relref">Section 5.5</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>.
Depending on policy, the MASA <span class="bcp14">MAY</span> choose the type of assertion to perform.
For the Agent Proximity Assertion of BRSKI-PRM (see <a href="#agt_prx" class="auto internal xref">Section 5.4</a>), the MASA <span class="bcp14">MUST</span> skip the verification described in <span><a href="https://rfc-editor.org/rfc/rfc8995#section-5.5.5" class="relref">Section 5.5.5</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span> and instead <span class="bcp14">MUST</span> verify for the PVR contained in the <code>prior-signed-voucher-request</code> field of the RVR that<a href="#section-7.3.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.3.1-4.1">
              <p id="section-7.3.1-4.1.1">the <code>agent-provided-proximity-registrar-cert</code> field contains an EE certificate that is signed by the same domain owner as the EE certificate/credentials used to sign the RVR;
note that this check allows for installations with multiple domain registrars and for registrar EE certificate renewal while PVRs are collected by the Registrar-Agent.<a href="#section-7.3.1-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.3.1-4.2">
              <p id="section-7.3.1-4.2.1">the registrar EE certificate in the <code>agent-provided-proximity-registrar-cert</code> field and the Registrar-Agent EE certificate in the <code>agent-sign-cert</code> field of the RVR are signed by the same domain owner.<a href="#section-7.3.1-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.3.1-4.3">
              <p id="section-7.3.1-4.3.1">the <code>agent-signed-data</code> field is signed with the credentials corresponding to the Registrar-Agent EE certificate in the <code>agent-sign-cert</code> field of the RVR;
this is done via the SubjectKeyIdentifier of the certificate in the <code>kid</code> Header Parameter of the JWS Protected Header in the <code>agent-signed-data</code> field.<a href="#section-7.3.1-4.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.3.1-4.4">
              <p id="section-7.3.1-4.4.1">the product-serial-number inside the <code>agent-signed-data</code> is equal to the <code>serial-number</code> field of PVR and the <code>serial-number</code> field of the RVR as well as the X520SerialNumber field of the pledge IDevID certificate, which is contained in the JWS Protected Header of the PVR.<a href="#section-7.3.1-4.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-7.3.1-5">If the <code>agent-sign-cert</code> field in the RVR is not set, the MASA <span class="bcp14">MAY</span> state a lower level assertion value instead of failing the verification, e.g., "logged" or "verified".<a href="#section-7.3.1-5" class="pilcrow">¶</a></p>
<p id="section-7.3.1-6">If the verification fails, the MASA <span class="bcp14">SHOULD</span> respond with an HTTP client error status code to the registrar.
The client error status codes are kept the same as defined in <span><a href="https://rfc-editor.org/rfc/rfc8995#section-5.6" class="relref">Section 5.6</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>:<a href="#section-7.3.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.3.1-7.1">
              <p id="section-7.3.1-7.1.1">403 Forbidden: if the voucher-request is not signed correctly or is stale or if the pledge has another outstanding voucher that cannot be overridden.<a href="#section-7.3.1-7.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.3.1-7.2">
              <p id="section-7.3.1-7.2.1">404 Not Found: if the request is for a device that is not known to the MASA.<a href="#section-7.3.1-7.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.3.1-7.3">
              <p id="section-7.3.1-7.3.1">406 Not Acceptable: if a voucher of the desired type or that uses the desired algorithms (as indicated by the "Accept" header fields and algorithms used in the signature) cannot be issued as such because the MASA knows the pledge cannot process that type.<a href="#section-7.3.1-7.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.3.1-7.4">
              <p id="section-7.3.1-7.4.1">415 Unsupported Media Type: if the request uses an artifact format or Accept header value that is not supported by the MASA.<a href="#section-7.3.1-7.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-7.3.1-8">Otherwise, the MASA creates a Voucher artifact as defined in <a href="#voucher_artifact" class="auto internal xref">Section 7.3.5</a> and updates the audit-log as described in <span><a href="https://rfc-editor.org/rfc/rfc8995#section-5.5" class="relref">Section 5.5</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>.
The Voucher is then supplied to the registrar within the body of an HTTP 200 OK response according to <span><a href="https://rfc-editor.org/rfc/rfc8995#section-5.6" class="relref">Section 5.6</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>.
In the response header, the Content-Type field <span class="bcp14">MUST</span> be set to the media type of the incoming RVR artifact.
For the default format used in this specification, this is <code>application/voucher-jws+json</code> as defined in <span>[<a href="#I-D.ietf-anima-jws-voucher" class="cite xref">I-D.ietf-anima-jws-voucher</a>]</span>.<a href="#section-7.3.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="supply-voucher-to-registrar-agent">
<section id="section-7.3.2">
          <h4 id="name-supply-voucher-to-registrar">
<a href="#section-7.3.2" class="section-number selfRef">7.3.2. </a><a href="#name-supply-voucher-to-registrar" class="section-name selfRef">Supply Voucher to Registrar-Agent</a>
          </h4>
<p id="section-7.3.2-1">After receiving the Voucher from the MASA, the registrar <span class="bcp14">SHOULD</span> evaluate it for transparency and logging purposes as outlined in <span><a href="https://rfc-editor.org/rfc/rfc8995#section-5.6" class="relref">Section 5.6</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>.
It then countersigns the Voucher for delivery to the pledge via the Registrar-Agent.<a href="#section-7.3.2-1" class="pilcrow">¶</a></p>
<p id="section-7.3.2-2">The registrar <span class="bcp14">MUST</span> reply to the Registrar-Agent with the Registrar-Countersigned Voucher artifact (Voucher') as defined in <a href="#rcv_artifact" class="auto internal xref">Section 7.3.6</a> in the body of an HTTP 200 OK response.
In the response header, the Content-Type field <span class="bcp14">MUST</span> be set to the media type of the incoming PVR artifact.
For the default format used in this specification, this is <code>application/voucher-jws+json</code> as defined in <span>[<a href="#I-D.ietf-anima-jws-voucher" class="cite xref">I-D.ietf-anima-jws-voucher</a>]</span>.<a href="#section-7.3.2-2" class="pilcrow">¶</a></p>
<p id="section-7.3.2-3">If the domain registrar is unable to return the Voucher, it <span class="bcp14">MUST</span> respond with an HTTP server error status code to the Registrar-Agent.
The following server error status codes <span class="bcp14">SHOULD</span> be used:<a href="#section-7.3.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.3.2-4.1">
              <p id="section-7.3.2-4.1.1">500 Internal Server Error: if both Registrar-Agent request and MASA response are valid, but the registrar still failed to return the Voucher, e.g., due to missing configuration or a program failure.<a href="#section-7.3.2-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.3.2-4.2">
              <p id="section-7.3.2-4.2.1">502 Bad Gateway: if the registrar received an invalid response from the MASA.<a href="#section-7.3.2-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.3.2-4.3">
              <p id="section-7.3.2-4.3.1">503 Service Unavailable: if a simple retry of the Registrar-Agent request might lead to a successful response;
this error response <span class="bcp14">SHOULD</span> include the <code>Retry-After</code> response header field with an appropriate value.<a href="#section-7.3.2-4.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.3.2-4.4">
              <p id="section-7.3.2-4.4.1">504 Gateway Timeout: if the backend request to the MASA timed out.<a href="#section-7.3.2-4.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="request-artifact-pledge-voucher-request-pvr">
<section id="section-7.3.3">
          <h4 id="name-request-artifact-pledge-vouc">
<a href="#section-7.3.3" class="section-number selfRef">7.3.3. </a><a href="#name-request-artifact-pledge-vouc" class="section-name selfRef">Request Artifact: Pledge Voucher-Request (PVR)</a>
          </h4>
<p id="section-7.3.3-1">Identical to the PVR artifact received from the pledge as defined in <a href="#pvr_artifact" class="auto internal xref">Section 7.1.2</a>.
The Registrar-Agent <span class="bcp14">MUST NOT</span> modify PVRs.<a href="#section-7.3.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rvr_artifact">
<section id="section-7.3.4">
          <h4 id="name-backend-request-artifact-re">
<a href="#section-7.3.4" class="section-number selfRef">7.3.4. </a><a href="#name-backend-request-artifact-re" class="section-name selfRef">Backend Request Artifact: Registrar Voucher-Request (RVR)</a>
          </h4>
<p id="section-7.3.4-1">The Registrar Voucher-Request (RVR) artifact <span class="bcp14">SHALL</span> be an extended Voucher-Request artifact based on <span><a href="https://rfc-editor.org/rfc/rfc8995#section-5.5" class="relref">Section 5.5</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>.
The BRSKI-PRM related enhancements of the <code>ietf-voucher-request</code> YANG module are defined in <span>[<a href="#I-D.ietf-anima-rfc8366bis" class="cite xref">I-D.ietf-anima-rfc8366bis</a>]</span>.<a href="#section-7.3.4-1" class="pilcrow">¶</a></p>
<p id="section-7.3.4-2">For the JWS-signed JSON format used by this specification, the RVR artifact <span class="bcp14">MUST</span> be a JWS Voucher structure as defined in <span>[<a href="#I-D.ietf-anima-jws-voucher" class="cite xref">I-D.ietf-anima-jws-voucher</a>]</span>, which <span class="bcp14">MUST</span> contain the JSON RVR Data defined in <a href="#rvr_data" class="auto internal xref">Section 7.3.4.1</a> in the JWS Payload.
<a href="#rvr_representation" class="auto internal xref">Figure 20</a> summarizes the serialization of the JWS-signed JSON RVR artifact:<a href="#section-7.3.4-2" class="pilcrow">¶</a></p>
<span id="name-rvr-representation-in-gener"></span><div id="rvr_representation">
<figure id="figure-20">
            <div class="alignLeft art-text artwork" id="section-7.3.4-3.1">
<pre>
{
  "payload": BASE64URL(UTF8(JSON RVR Data)),
  "signatures": [
    {
      "protected": BASE64URL(UTF8(JWS Protected Header)),
      "signature": BASE64URL(JWS Signature)
    }
  ]
}
</pre>
</div>
<figcaption><a href="#figure-20" class="selfRef">Figure 20</a>:
<a href="#name-rvr-representation-in-gener" class="selfRef">RVR Representation in General JWS JSON Serialization Syntax</a>
            </figcaption></figure>
</div>
<div id="rvr_data">
<section id="section-7.3.4.1">
            <h5 id="name-json-rvr-data">
<a href="#section-7.3.4.1" class="section-number selfRef">7.3.4.1. </a><a href="#name-json-rvr-data" class="section-name selfRef">JSON RVR Data</a>
            </h5>
<p id="section-7.3.4.1-1">The JSON RVR Data <span class="bcp14">MUST</span> contain the following fields of the <code>ietf-voucher-request</code> YANG module as defined in <span>[<a href="#I-D.ietf-anima-rfc8366bis" class="cite xref">I-D.ietf-anima-rfc8366bis</a>]</span>;
note that this makes optional leaves in the YANG definition mandatory for the RVR artifact:<a href="#section-7.3.4.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.3.4.1-2.1">
                <p id="section-7.3.4.1-2.1.1"><code>created-on</code>: <span class="bcp14">SHALL</span> contain the current date and time at RVR creation as standard date/time string as defined in <span><a href="https://rfc-editor.org/rfc/rfc3339#section-5.6" class="relref">Section 5.6</a> of [<a href="#RFC3339" class="cite xref">RFC3339</a>]</span><a href="#section-7.3.4.1-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.3.4.1-2.2">
                <p id="section-7.3.4.1-2.2.1"><code>nonce</code>: <span class="bcp14">SHALL</span> contain a copy of the <code>nonce</code> field from the JSON PVR Data
the registrar provides this information to assure successful verification of Registrar-Agent proximity based on the agent-signed-data<a href="#section-7.3.4.1-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.3.4.1-2.3">
                <p id="section-7.3.4.1-2.3.1"><code>serial-number</code>: <span class="bcp14">SHALL</span> contain the product-serial-number of the pledge;
note the required verification by the registrar defined in <a href="#pvr" class="auto internal xref">Section 7.3</a><a href="#section-7.3.4.1-2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.3.4.1-2.4">
                <p id="section-7.3.4.1-2.4.1"><code>idevid-issuer</code>: <span class="bcp14">SHALL</span> contain the issuer value from the pledge IDevID certificate obtained from the PVR JWS Protected Header <code>x5c</code> field<a href="#section-7.3.4.1-2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.3.4.1-2.5">
                <p id="section-7.3.4.1-2.5.1"><code>prior-signed-voucher-request</code>: <span class="bcp14">SHALL</span> contain the PVR artifact as received from the Registrar-Agent, see <a href="#tpvr" class="auto internal xref">Section 7.1</a><a href="#section-7.3.4.1-2.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-7.3.4.1-3">As BRSKI-PRM uses the Agent Proximity Assertion (see <a href="#agt_prx" class="auto internal xref">Section 5.4</a>), the JSON RVR Data <span class="bcp14">MUST</span> also contain the following fields:<a href="#section-7.3.4.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.3.4.1-4.1">
                <p id="section-7.3.4.1-4.1.1"><code>assertion</code>: <span class="bcp14">SHALL</span> contain the value <code>agent-proximity</code> to indicate successful verification of the Agent Proximity Assertion (see <a href="#agt_prx" class="auto internal xref">Section 5.4</a>) by the registrar.<a href="#section-7.3.4.1-4.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.3.4.1-4.2">
                <p id="section-7.3.4.1-4.2.1"><code>agent-sign-cert</code>: <span class="bcp14">SHALL</span> be a JSON array that contains the base64-encoded Registrar-Agent EE certificate as possessed by the registrar (see <a href="#registrar_component" class="auto internal xref">Section 6.3</a>) as the first item;
subsequent items <span class="bcp14">MUST</span> contain the corresponding certificate chain for verification at the MASA;
the field is used for verification of the <code>agent-signed-data</code> field of the contained PVR.<a href="#section-7.3.4.1-4.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-7.3.4.1-5">Note that the <code>ietf-voucher-request</code> YANG module defines the leaf <code>agent-sign-cert</code> as binary;
this specification refines it as a JSON array structure similar to the <code>x5c</code> Header Parameter defined in <span><a href="https://rfc-editor.org/rfc/rfc7515#section-4.1.6" class="relref">Section 4.1.6</a> of [<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.<a href="#section-7.3.4.1-5" class="pilcrow">¶</a></p>
<p id="section-7.3.4.1-6"><a href="#rvr_data_example" class="auto internal xref">Figure 21</a> shows an example for the JSON RVR Data:<a href="#section-7.3.4.1-6" class="pilcrow">¶</a></p>
<span id="name-json-rvr-data-example"></span><div id="rvr_data_example">
<figure id="figure-21">
              <div class="alignLeft art-json art-text artwork" id="section-7.3.4.1-7.1">
<pre>
{
  "ietf-voucher-request:voucher": {
     "created-on": "2022-01-04T02:37:39.235Z",
     "nonce": "eDs++/FuDHGUnRxN3E14CQ==",
     "serial-number": "vendor-pledge4711",
     "idevid-issuer": "base64encodedvalue==",
     "prior-signed-voucher-request": "base64encodedvalue==",
     "assertion": "agent-proximity",
     "agent-sign-cert": [
       "base64encodedvalue==",
       "base64encodedvalue==",
       "..."
     ]
  }
}
</pre>
</div>
<figcaption><a href="#figure-21" class="selfRef">Figure 21</a>:
<a href="#name-json-rvr-data-example" class="selfRef">JSON RVR Data Example</a>
              </figcaption></figure>
</div>
</section>
</div>
<div id="jws-protected-header-3">
<section id="section-7.3.4.2">
            <h5 id="name-jws-protected-header-4">
<a href="#section-7.3.4.2" class="section-number selfRef">7.3.4.2. </a><a href="#name-jws-protected-header-4" class="section-name selfRef">JWS Protected Header</a>
            </h5>
<p id="section-7.3.4.2-1">The JWS Protected Header <span class="bcp14">MUST</span> follow the definitions of <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-anima-jws-voucher-16#section-3.2" class="relref">Section 3.2</a> of [<a href="#I-D.ietf-anima-jws-voucher" class="cite xref">I-D.ietf-anima-jws-voucher</a>]</span>.<a href="#section-7.3.4.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="jws-signature-3">
<section id="section-7.3.4.3">
            <h5 id="name-jws-signature-4">
<a href="#section-7.3.4.3" class="section-number selfRef">7.3.4.3. </a><a href="#name-jws-signature-4" class="section-name selfRef">JWS Signature</a>
            </h5>
<p id="section-7.3.4.3-1">The domain registrar <span class="bcp14">MUST</span> sign the RVR artifact using its EE credentials following the definitions of <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-anima-jws-voucher-16#section-3.3" class="relref">Section 3.3</a> of [<a href="#I-D.ietf-anima-jws-voucher" class="cite xref">I-D.ietf-anima-jws-voucher</a>]</span>.<a href="#section-7.3.4.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="voucher_artifact">
<section id="section-7.3.5">
          <h4 id="name-backend-response-artifact-v">
<a href="#section-7.3.5" class="section-number selfRef">7.3.5. </a><a href="#name-backend-response-artifact-v" class="section-name selfRef">Backend Response Artifact: Voucher</a>
          </h4>
<p id="section-7.3.5-1">The Voucher artifact is defined in <span><a href="https://rfc-editor.org/rfc/rfc8995#section-5.6" class="relref">Section 5.6</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span> (cf. "voucher response").
The only difference for BRSKI-PRM is that the <code>assertion</code> field <span class="bcp14">MAY</span> contain the value <code>agent-proximity</code> as defined in <span>[<a href="#I-D.ietf-anima-rfc8366bis" class="cite xref">I-D.ietf-anima-rfc8366bis</a>]</span>, when the Agent-Proximity Assertion (see <a href="#agt_prx" class="auto internal xref">Section 5.4</a>) is performed by the MASA.<a href="#section-7.3.5-1" class="pilcrow">¶</a></p>
<p id="section-7.3.5-2">For the JWS-signed JSON format used by this specification, the Voucher artifact <span class="bcp14">MUST</span> be a JWS Voucher structure as defined in <span>[<a href="#I-D.ietf-anima-jws-voucher" class="cite xref">I-D.ietf-anima-jws-voucher</a>]</span>.
It contains JSON Voucher Data in the JWS Payload, for which an example is given in <a href="#voucher_data_example" class="auto internal xref">Figure 22</a>:<a href="#section-7.3.5-2" class="pilcrow">¶</a></p>
<span id="name-json-rvr-data-example-2"></span><div id="voucher_data_example">
<figure id="figure-22">
            <div class="alignLeft art-json art-text artwork" id="section-7.3.5-3.1">
<pre>
{
  "ietf-voucher:voucher": {
    "created-on": "2022-01-04T00:00:02.000Z",
    "nonce": "base64encodedvalue==",
    "assertion": "agent-proximity",
    "pinned-domain-cert": "base64encodedvalue==",
    "serial-number": "vendor-pledge4711"
  }
}
</pre>
</div>
<figcaption><a href="#figure-22" class="selfRef">Figure 22</a>:
<a href="#name-json-rvr-data-example-2" class="selfRef">JSON RVR Data Example</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="rcv_artifact">
<section id="section-7.3.6">
          <h4 id="name-response-artifact-registrar">
<a href="#section-7.3.6" class="section-number selfRef">7.3.6. </a><a href="#name-response-artifact-registrar" class="section-name selfRef">Response Artifact: Registrar-Countersigned Voucher</a>
          </h4>
<p id="section-7.3.6-1">The Registrar-Countersigned Voucher (Voucher') artifact <span class="bcp14">SHALL</span> be an extended Voucher artifact based on <span><a href="https://rfc-editor.org/rfc/rfc8995#section-5.6" class="relref">Section 5.6</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span> using the format defined in <a href="#voucher_artifact" class="auto internal xref">Section 7.3.5</a>.<a href="#section-7.3.6-1" class="pilcrow">¶</a></p>
<p id="section-7.3.6-2">For BRSKI-PRM, the domain registrar <span class="bcp14">MUST</span> add an JWS Protected Header and JWS Signature to the MASA-provided Voucher.
<a href="#rcv_representation" class="auto internal xref">Figure 23</a> summarizes the serialization of the JWS-signed JSON Voucher' artifact:<a href="#section-7.3.6-2" class="pilcrow">¶</a></p>
<span id="name-voucher-representation-in-g"></span><div id="rcv_representation">
<figure id="figure-23">
            <div class="alignLeft art-text artwork" id="section-7.3.6-3.1">
<pre>
{
  "payload": BASE64URL(JSON Voucher Data),
  "signatures": [
    {
      "protected": BASE64URL(UTF8(JWS Protected Header (MASA))),
      "signature": BASE64URL(JWS Signature (MASA))
    },
    {
      "protected": BASE64URL(UTF8(JWS Protected Header (Registrar))),
      "signature": BASE64URL(JWS Signature (Registrar))
    }
  ]
}
</pre>
</div>
<figcaption><a href="#figure-23" class="selfRef">Figure 23</a>:
<a href="#name-voucher-representation-in-g" class="selfRef">Voucher' Representation in General JWS JSON Serialization Syntax</a>
            </figcaption></figure>
</div>
<p id="section-7.3.6-4">In BRSKI <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>, the registrar proves possession of its credential through the server authentication within the TLS session with the pledge.
While the pledge cannot verify the registrar certificate at the time of TLS session establishment, it can verify the TLS server certificate through the certificate in the <code>pinned-domain-cert</code> field upon receiving the Voucher artifact (see <span><a href="https://rfc-editor.org/rfc/rfc8995#section-5.6.2" class="relref">Section 5.6.2</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>).<a href="#section-7.3.6-4" class="pilcrow">¶</a></p>
<p id="section-7.3.6-5">In BRSKI-PRM with the Registrar-Agent mediating all communication, this second signature provides verification and POP of the private key for the registrar EE certificate provided in the initial tPVR artifact from the Registrar-Agent (see <a href="#tpvr_artifact" class="auto internal xref">Section 7.1.1</a>).<a href="#section-7.3.6-5" class="pilcrow">¶</a></p>
<p id="section-7.3.6-6">Depending on the security policy of the operator, this signature can also be interpreted as explicit authorization of the registrar to install the contained trust anchor (i.e., pinned domain certificate).<a href="#section-7.3.6-6" class="pilcrow">¶</a></p>
<div id="json-voucher-data">
<section id="section-7.3.6.1">
            <h5 id="name-json-voucher-data">
<a href="#section-7.3.6.1" class="section-number selfRef">7.3.6.1. </a><a href="#name-json-voucher-data" class="section-name selfRef">JSON Voucher Data</a>
            </h5>
<p id="section-7.3.6.1-1">As provided by the MASA inside the JWS Payload.
The domain registrar <span class="bcp14">MUST NOT</span> modify the JWS Payload.<a href="#section-7.3.6.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="jws-protected-header-registrar">
<section id="section-7.3.6.2">
            <h5 id="name-jws-protected-header-regist">
<a href="#section-7.3.6.2" class="section-number selfRef">7.3.6.2. </a><a href="#name-jws-protected-header-regist" class="section-name selfRef">JWS Protected Header (Registrar)</a>
            </h5>
<p id="section-7.3.6.2-1">The registrar-added JWS Protected Header (Registrar) <span class="bcp14">MUST</span> contain the following standard Header Parameters as defined in <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>:<a href="#section-7.3.6.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.3.6.2-2.1">
                <p id="section-7.3.6.2-2.1.1"><code>alg</code>: <span class="bcp14">SHALL</span> contain the algorithm type used to create the signature, e.g., <code>ES256</code>, as defined in <span><a href="https://rfc-editor.org/rfc/rfc7515#section-4.1.1" class="relref">Section 4.1.1</a> of [<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.<a href="#section-7.3.6.2-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.3.6.2-2.2">
                <p id="section-7.3.6.2-2.2.1"><code>x5c</code>: <span class="bcp14">SHALL</span> contain the base64-encoded registrar EE certificate used to sign the voucher as well as the certificate chain up to (but not including) the pinned domain certificate (the initial domain trust anchor);
the pinned domain certificate is already contained in the JSON Voucher Data.<a href="#section-7.3.6.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-7.3.6.2-3">Note that for many installations with a single registrar credential, the registrar EE certificate is pinned.<a href="#section-7.3.6.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="jws-signature-registrar">
<section id="section-7.3.6.3">
            <h5 id="name-jws-signature-registrar">
<a href="#section-7.3.6.3" class="section-number selfRef">7.3.6.3. </a><a href="#name-jws-signature-registrar" class="section-name selfRef">JWS Signature (Registrar)</a>
            </h5>
<p id="section-7.3.6.3-1">The signature is created by signing the registrar-added JWS Protected Header (Registrar) and the original JWS Payload produced by the MASA as described in <span><a href="https://rfc-editor.org/rfc/rfc7515#section-5.1" class="relref">Section 5.1</a> of [<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.
The registrar <span class="bcp14">MUST</span> use its EE credentials to sign.<a href="#section-7.3.6.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3.6.3-2">Note that the credentials need to be the same as used for server authentication in the TLS session with the Registrar-Agent receiving this artifact (see <a href="#registrar_component" class="auto internal xref">Section 6.3</a>).<a href="#section-7.3.6.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="per">
<section id="section-7.4">
        <h3 id="name-supply-per-to-registrar-inc">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-supply-per-to-registrar-inc" class="section-name selfRef">Supply PER to Registrar (including Key Infrastructure interaction; requestenroll)</a>
        </h3>
<p id="section-7.4-1">After receiving the Voucher artifact, the Registrar-Agent sends the PER to the domain registrar within the same TLS session.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<p id="section-7.4-2">In case the TLS session to the registrar is already closed, the Registrar-Agent establishes a new session as described in <a href="#pvr" class="auto internal xref">Section 7.3</a>.
The registrar is able to correlate the PVR and PER artifacts based on the signatures and the contained product-serial-number.
Note that this also addresses situations in which a nonceless voucher is used and may be pre-provisioned to the pledge.<a href="#section-7.4-2" class="pilcrow">¶</a></p>
<p id="section-7.4-3"><a href="#exchangesfig_uc2_4" class="auto internal xref">Figure 24</a> depicts exchanges for the PER-request handling and the following subsections describe the corresponding artifacts.
Note that "Request" and "Certificate" do not denote BRSKI-PRM defined artifacts, but are data objects depending on the certificate management protocol used by the domain Key Infrastructure.<a href="#section-7.4-3" class="pilcrow">¶</a></p>
<span id="name-enroll-exchange"></span><div id="exchangesfig_uc2_4">
<figure id="figure-24">
          <div id="section-7.4-4.1">
            <div class="alignCenter art-svg artwork" id="section-7.4-4.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="288" width="576" viewBox="0 0 576 288" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,32 L 8,80" fill="none" stroke="black"></path>
                <path d="M 16,160 L 16,256" fill="none" stroke="black"></path>
                <path d="M 80,32 L 80,80" fill="none" stroke="black"></path>
                <path d="M 120,32 L 120,80" fill="none" stroke="black"></path>
                <path d="M 168,160 L 168,256" fill="none" stroke="black"></path>
                <path d="M 224,32 L 224,80" fill="none" stroke="black"></path>
                <path d="M 264,32 L 264,80" fill="none" stroke="black"></path>
                <path d="M 312,160 L 312,256" fill="none" stroke="black"></path>
                <path d="M 360,32 L 360,80" fill="none" stroke="black"></path>
                <path d="M 400,32 L 400,80" fill="none" stroke="black"></path>
                <path d="M 456,160 L 456,256" fill="none" stroke="black"></path>
                <path d="M 472,32 L 472,80" fill="none" stroke="black"></path>
                <path d="M 512,32 L 512,80" fill="none" stroke="black"></path>
                <path d="M 560,160 L 560,256" fill="none" stroke="black"></path>
                <path d="M 568,32 L 568,80" fill="none" stroke="black"></path>
                <path d="M 8,32 L 80,32" fill="none" stroke="black"></path>
                <path d="M 120,32 L 224,32" fill="none" stroke="black"></path>
                <path d="M 264,32 L 360,32" fill="none" stroke="black"></path>
                <path d="M 400,32 L 472,32" fill="none" stroke="black"></path>
                <path d="M 512,32 L 568,32" fill="none" stroke="black"></path>
                <path d="M 8,80 L 80,80" fill="none" stroke="black"></path>
                <path d="M 120,80 L 224,80" fill="none" stroke="black"></path>
                <path d="M 264,80 L 360,80" fill="none" stroke="black"></path>
                <path d="M 400,80 L 472,80" fill="none" stroke="black"></path>
                <path d="M 512,80 L 568,80" fill="none" stroke="black"></path>
                <path d="M 176,176 L 216,176" fill="none" stroke="black"></path>
                <path d="M 256,176 L 304,176" fill="none" stroke="black"></path>
                <path d="M 176,192 L 224,192" fill="none" stroke="black"></path>
                <path d="M 256,192 L 304,192" fill="none" stroke="black"></path>
                <path d="M 320,208 L 344,208" fill="none" stroke="black"></path>
                <path d="M 424,208 L 448,208" fill="none" stroke="black"></path>
                <path d="M 320,224 L 336,224" fill="none" stroke="black"></path>
                <path d="M 176,240 L 192,240" fill="none" stroke="black"></path>
                <path d="M 288,240 L 304,240" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="456,208 444,202.4 444,213.6" fill="black" transform="rotate(0,448,208)"></polygon>
                <polygon class="arrowhead" points="328,224 316,218.4 316,229.6" fill="black" transform="rotate(180,320,224)"></polygon>
                <polygon class="arrowhead" points="312,192 300,186.4 300,197.6" fill="black" transform="rotate(0,304,192)"></polygon>
                <polygon class="arrowhead" points="312,176 300,170.4 300,181.6" fill="black" transform="rotate(0,304,176)"></polygon>
                <polygon class="arrowhead" points="184,240 172,234.4 172,245.6" fill="black" transform="rotate(180,176,240)"></polygon>
                <polygon class="arrowhead" points="184,176 172,170.4 172,181.6" fill="black" transform="rotate(180,176,176)"></polygon>
                <g class="text">
                  <text x="44" y="52">Pledge</text>
                  <text x="172" y="52">Registrar-</text>
                  <text x="308" y="52">Domain</text>
                  <text x="432" y="52">Key</text>
                  <text x="540" y="52">MASA</text>
                  <text x="168" y="68">Agent</text>
                  <text x="312" y="68">Registrar</text>
                  <text x="436" y="68">Infra.</text>
                  <text x="16" y="100">|</text>
                  <text x="168" y="100">|</text>
                  <text x="312" y="100">|</text>
                  <text x="456" y="100">|</text>
                  <text x="516" y="100">Internet</text>
                  <text x="560" y="100">|</text>
                  <text x="16" y="116">~</text>
                  <text x="168" y="116">~</text>
                  <text x="312" y="116">~</text>
                  <text x="456" y="116">~</text>
                  <text x="560" y="116">~</text>
                  <text x="16" y="132">(4)</text>
                  <text x="60" y="132">Supply</text>
                  <text x="104" y="132">PER</text>
                  <text x="132" y="132">to</text>
                  <text x="184" y="132">Registrar</text>
                  <text x="268" y="132">(including</text>
                  <text x="328" y="132">Key</text>
                  <text x="404" y="132">Infrastructure</text>
                  <text x="516" y="132">interaction)</text>
                  <text x="16" y="148">~</text>
                  <text x="168" y="148">~</text>
                  <text x="312" y="148">~</text>
                  <text x="456" y="148">~</text>
                  <text x="560" y="148">~</text>
                  <text x="236" y="180">mTLS</text>
                  <text x="240" y="196">PER</text>
                  <text x="384" y="212">[Request]</text>
                  <text x="396" y="228">[Certificate]-</text>
                  <text x="240" y="244">Enroll-Resp</text>
                  <text x="16" y="276">~</text>
                  <text x="168" y="276">~</text>
                  <text x="312" y="276">~</text>
                  <text x="456" y="276">~</text>
                  <text x="560" y="276">~</text>
                </g>
              </svg><a href="#section-7.4-4.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-24" class="selfRef">Figure 24</a>:
<a href="#name-enroll-exchange" class="selfRef">Enroll exchange</a>
          </figcaption></figure>
</div>
<p id="section-7.4-5">As a second step of the interaction with the domain registrar, the Registrar-Agent <span class="bcp14">SHALL</span> supply the PER artifact(s) to the registrar via HTTP-over-TLS POST to the registrar endpoint at <code>/.well-known/brski/requestenroll</code>.
The request body <span class="bcp14">MUST</span> contain one previously acquired PER artifact as defined in <a href="#per_artifact" class="auto internal xref">Section 7.2.2</a>.
In the request header, the Content-Type field <span class="bcp14">MUST</span> be set to <code>application/jose+json</code> and the Accept field <span class="bcp14">SHOULD</span> be set to <code>application/jose+json</code>.<a href="#section-7.4-5" class="pilcrow">¶</a></p>
<p id="section-7.4-6">Note that this is different from the EST <span>[<a href="#RFC7030" class="cite xref">RFC7030</a>]</span> endpoint used in BRSKI, as the PER artifact is signature-wrapped.
Hence, upon receiving a PER artifact, the registrar <span class="bcp14">MUST</span> verify that<a href="#section-7.4-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.4-7.1">
            <p id="section-7.4-7.1.1">the PER was signed with the private key corresponding to the pledge EE certificate, which is contained in the JWS Protected Header of the PER.<a href="#section-7.4-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.4-7.2">
            <p id="section-7.4-7.2.1">the pledge identified by its EE certificate is accepted to join the domain after successful validation of the corresponding PVR.<a href="#section-7.4-7.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.4-8">If the registrar is unable to process the request or validate the PER, it <span class="bcp14">MUST</span> respond with an HTTP client error status code to the Registrar-Agent.
The following client error status codes <span class="bcp14">SHOULD</span> be used:<a href="#section-7.4-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.4-9.1">
            <p id="section-7.4-9.1.1">400 Bad Request: if the registrar detects an error in the format of the request.<a href="#section-7.4-9.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.4-9.2">
            <p id="section-7.4-9.2.1">401 Unauthorized: if the signature of the PER cannot be verified.<a href="#section-7.4-9.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.4-9.3">
            <p id="section-7.4-9.3.1">404 Not Found: if the PER is for a device that is not known to the registrar.<a href="#section-7.4-9.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.4-9.4">
            <p id="section-7.4-9.4.1">406 Not Acceptable: if the Accept request header field indicates a type that is unknown or unsupported, e.g., a type other than <code>application/jose+json</code>.<a href="#section-7.4-9.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.4-9.5">
            <p id="section-7.4-9.5.1">415 Unsupported Media Type: if the PER uses an artifact format that is not supported by the registrar, e.g., a type other than <code>application/jose+json</code>.<a href="#section-7.4-9.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.4-10">Otherwise, the registrar extracts the PKCS#10 Certificate Signing Request (CSR) inside the PER (see <a href="#per_artifact" class="auto internal xref">Section 7.2.2</a>) and uses the CSR to request a new pledge EE certificate from the domain Key Infrastructure.
The exact interaction and exchanged data objects depends on the certificate management protocol used by the Key Infrastructure, and is out of scope for this document.<a href="#section-7.4-10" class="pilcrow">¶</a></p>
<p id="section-7.4-11">A successful interaction with the Key Infrastructure will result in a pledge EE certificate signed by the domain owner (e.g., LDevID certificate).
The registrar <span class="bcp14">MUST</span> reply to the Registrar-Agent with the Enroll-Response (Enroll-Resp) as defined in <a href="#er_artifact" class="auto internal xref">Section 7.4.2</a> in the body of an HTTP 200 OK response.
In the response header, the Content-Type field <span class="bcp14">MUST</span> be set to <code>application/pkcs7-mime</code>.<a href="#section-7.4-11" class="pilcrow">¶</a></p>
<p id="section-7.4-12">If the domain registrar is unable to return the Enroll-Resp, it <span class="bcp14">MUST</span> respond with an HTTP server error status code to the Registrar-Agent.
The following server error status codes <span class="bcp14">SHOULD</span> be used:<a href="#section-7.4-12" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.4-13.1">
            <p id="section-7.4-13.1.1">500 Internal Server Error: if the Key Infrastructure response is valid, but the registrar still failed to return the Enroll-Resp, e.g., due to missing configuration or a program failure.<a href="#section-7.4-13.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.4-13.2">
            <p id="section-7.4-13.2.1">502 Bad Gateway: if the registrar received an invalid response from the Key Infrastructure.<a href="#section-7.4-13.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.4-13.3">
            <p id="section-7.4-13.3.1">503 Service Unavailable: if a simple retry of the Registrar-Agent request might lead to a successful response; this error response <span class="bcp14">SHOULD</span> include the Retry-After response header field with an appropriate value.<a href="#section-7.4-13.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.4-13.4">
            <p id="section-7.4-13.4.1">504 Gateway Timeout: if the backend request to the Key Infrastructure timed out.<a href="#section-7.4-13.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.4-14">Note that while BRSKI-PRM targets the initial enrollment, re-enrollment may be supported similarly with the exception that the current, potentially application-related pledge EE certificate is used instead of the IDevID certificate to sign the PER artifact (see also <a href="#tper" class="auto internal xref">Section 7.2</a>).
Hence, there is no verification whether the pledge is accepted to join the domain, as the still valid EE certificate signed by the domain owner identifies the pledge as already accepted component of the domain.<a href="#section-7.4-14" class="pilcrow">¶</a></p>
<div id="request-artifact-pledge-enroll-request-per">
<section id="section-7.4.1">
          <h4 id="name-request-artifact-pledge-enro">
<a href="#section-7.4.1" class="section-number selfRef">7.4.1. </a><a href="#name-request-artifact-pledge-enro" class="section-name selfRef">Request Artifact: Pledge Enroll-Request (PER)</a>
          </h4>
<p id="section-7.4.1-1">Identical to the PER artifact defined in <a href="#per_artifact" class="auto internal xref">Section 7.2.2</a>.
The Registrar-Agent <span class="bcp14">MUST NOT</span> modify PERs received from pledges.<a href="#section-7.4.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="er_artifact">
<section id="section-7.4.2">
          <h4 id="name-response-artifact-registrar-">
<a href="#section-7.4.2" class="section-number selfRef">7.4.2. </a><a href="#name-response-artifact-registrar-" class="section-name selfRef">Response Artifact: Registrar Enroll-Response (Enroll-Resp)</a>
          </h4>
<p id="section-7.4.2-1">The Enroll-Response (Enroll-Resp) artifact <span class="bcp14">SHALL</span> be an authenticated self-contained object signed by the domain owner, containing a pledge EE certificate.<a href="#section-7.4.2-1" class="pilcrow">¶</a></p>
<p id="section-7.4.2-2">For this specification, the Enroll-Resp artifact <span class="bcp14">MUST</span> be a certs-only CMC Simple PKI Response (PKCS#7) as defined in <span><a href="https://rfc-editor.org/rfc/rfc5272#section-4.1" class="relref">Section 4.1</a> of [<a href="#RFC5272" class="cite xref">RFC5272</a>]</span> (following EST <span>[<a href="#RFC7030" class="cite xref">RFC7030</a>]</span>).
Note that it only contains the pledge EE certificate, but not the certificate chain.
The chain is provided with the CA certificates.<a href="#section-7.4.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="obtain_cacerts">
<section id="section-7.5">
        <h3 id="name-obtain-ca-certificates-wrap">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-obtain-ca-certificates-wrap" class="section-name selfRef">Obtain CA Certificates (wrappedcacerts)</a>
        </h3>
<p id="section-7.5-1">The pinned domain certificate in the voucher is only the initial trust anchor for only the domain registrar.
To fully trust the domain and also to verify its own EE certificate, the pledge also needs the corresponding domain CA certificate(s).
A bag of CA certificates signed by the registrar will allow the pledge to verify the authorization to install the received CA certificate(s) through the pinned domain certificate in the voucher.<a href="#section-7.5-1" class="pilcrow">¶</a></p>
<p id="section-7.5-2">Note that this is a deviation from EST <span>[<a href="#RFC7030" class="cite xref">RFC7030</a>]</span> used in BRSKI <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>.<a href="#section-7.5-2" class="pilcrow">¶</a></p>
<p id="section-7.5-3">The Registrar-Agent obtains this artifact within the same TLS session.
In case the TLS session to the registrar is already closed, the Registrar-Agent establishes a new session as described in <a href="#pvr" class="auto internal xref">Section 7.3</a>.
The CA certificates do not need to be correlated to a specific voucher or Enroll-Response; they only need to be fresh.<a href="#section-7.5-3" class="pilcrow">¶</a></p>
<p id="section-7.5-4"><a href="#exchangesfig_uc2_5" class="auto internal xref">Figure 25</a> shows the acquisition of the CA certificate(s) and the following subsections describe the corresponding artifact.<a href="#section-7.5-4" class="pilcrow">¶</a></p>
<span id="name-ca-certificates-retrieval-e"></span><div id="exchangesfig_uc2_5">
<figure id="figure-25">
          <div id="section-7.5-5.1">
            <div class="alignCenter art-svg artwork" id="section-7.5-5.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="240" width="576" viewBox="0 0 576 240" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,32 L 8,80" fill="none" stroke="black"></path>
                <path d="M 16,160 L 16,208" fill="none" stroke="black"></path>
                <path d="M 80,32 L 80,80" fill="none" stroke="black"></path>
                <path d="M 120,32 L 120,80" fill="none" stroke="black"></path>
                <path d="M 168,160 L 168,208" fill="none" stroke="black"></path>
                <path d="M 224,32 L 224,80" fill="none" stroke="black"></path>
                <path d="M 264,32 L 264,80" fill="none" stroke="black"></path>
                <path d="M 312,160 L 312,208" fill="none" stroke="black"></path>
                <path d="M 360,32 L 360,80" fill="none" stroke="black"></path>
                <path d="M 400,32 L 400,80" fill="none" stroke="black"></path>
                <path d="M 456,160 L 456,208" fill="none" stroke="black"></path>
                <path d="M 472,32 L 472,80" fill="none" stroke="black"></path>
                <path d="M 512,32 L 512,80" fill="none" stroke="black"></path>
                <path d="M 560,160 L 560,208" fill="none" stroke="black"></path>
                <path d="M 568,32 L 568,80" fill="none" stroke="black"></path>
                <path d="M 8,32 L 80,32" fill="none" stroke="black"></path>
                <path d="M 120,32 L 224,32" fill="none" stroke="black"></path>
                <path d="M 264,32 L 360,32" fill="none" stroke="black"></path>
                <path d="M 400,32 L 472,32" fill="none" stroke="black"></path>
                <path d="M 512,32 L 568,32" fill="none" stroke="black"></path>
                <path d="M 8,80 L 80,80" fill="none" stroke="black"></path>
                <path d="M 120,80 L 224,80" fill="none" stroke="black"></path>
                <path d="M 264,80 L 360,80" fill="none" stroke="black"></path>
                <path d="M 400,80 L 472,80" fill="none" stroke="black"></path>
                <path d="M 512,80 L 568,80" fill="none" stroke="black"></path>
                <path d="M 176,176 L 216,176" fill="none" stroke="black"></path>
                <path d="M 256,176 L 304,176" fill="none" stroke="black"></path>
                <path d="M 176,192 L 208,192" fill="none" stroke="black"></path>
                <path d="M 272,192 L 304,192" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="312,176 300,170.4 300,181.6" fill="black" transform="rotate(0,304,176)"></polygon>
                <polygon class="arrowhead" points="184,192 172,186.4 172,197.6" fill="black" transform="rotate(180,176,192)"></polygon>
                <polygon class="arrowhead" points="184,176 172,170.4 172,181.6" fill="black" transform="rotate(180,176,176)"></polygon>
                <g class="text">
                  <text x="44" y="52">Pledge</text>
                  <text x="172" y="52">Registrar-</text>
                  <text x="308" y="52">Domain</text>
                  <text x="432" y="52">Key</text>
                  <text x="540" y="52">MASA</text>
                  <text x="168" y="68">Agent</text>
                  <text x="312" y="68">Registrar</text>
                  <text x="436" y="68">Infra.</text>
                  <text x="16" y="100">|</text>
                  <text x="168" y="100">|</text>
                  <text x="312" y="100">|</text>
                  <text x="456" y="100">|</text>
                  <text x="516" y="100">Internet</text>
                  <text x="560" y="100">|</text>
                  <text x="16" y="116">~</text>
                  <text x="168" y="116">~</text>
                  <text x="312" y="116">~</text>
                  <text x="456" y="116">~</text>
                  <text x="560" y="116">~</text>
                  <text x="16" y="132">(5)</text>
                  <text x="60" y="132">Obtain</text>
                  <text x="100" y="132">CA</text>
                  <text x="164" y="132">Certificates</text>
                  <text x="16" y="148">~</text>
                  <text x="168" y="148">~</text>
                  <text x="312" y="148">~</text>
                  <text x="456" y="148">~</text>
                  <text x="560" y="148">~</text>
                  <text x="236" y="180">mTLS</text>
                  <text x="240" y="196">caCerts</text>
                  <text x="16" y="228">~</text>
                  <text x="168" y="228">~</text>
                  <text x="312" y="228">~</text>
                  <text x="456" y="228">~</text>
                  <text x="560" y="228">~</text>
                </g>
              </svg><a href="#section-7.5-5.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-25" class="selfRef">Figure 25</a>:
<a href="#name-ca-certificates-retrieval-e" class="selfRef">CA certificates retrieval exchange</a>
          </figcaption></figure>
</div>
<p id="section-7.5-6">As a third step of the interaction with the domain registrar, the Registrar-Agent <span class="bcp14">SHALL</span> obtain the CA-Certificates artifact from the registrar via HTTP-over-TLS GET to the registrar endpoint at <code>/.well-known/brski/wrappedcacerts</code>.
In the request header, the Accept field <span class="bcp14">SHOULD</span> be set to <code>application/jose+json</code>.<a href="#section-7.5-6" class="pilcrow">¶</a></p>
<p id="section-7.5-7">Upon receiving a GET request at <code>/.well-known/brski/wrappedcacerts</code>, the domain registrar <span class="bcp14">MUST</span> reply with the CA-Certificates artifact as defined in <a href="#cacerts_artifact" class="auto internal xref">Section 7.5.2</a> in the body of an HTTP 200 OK response.
In the response header, the Content-Type field <span class="bcp14">MUST</span> be set to <code>application/jose+json</code>.<a href="#section-7.5-7" class="pilcrow">¶</a></p>
<div id="request-no-artifact">
<section id="section-7.5.1">
          <h4 id="name-request-no-artifact">
<a href="#section-7.5.1" class="section-number selfRef">7.5.1. </a><a href="#name-request-no-artifact" class="section-name selfRef">Request (no artifact)</a>
          </h4>
<p id="section-7.5.1-1">In this exchange, the request is a result of the HTTP(S) default transport for this specification.
There is no artifact provided to the registrar.<a href="#section-7.5.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cacerts_artifact">
<section id="section-7.5.2">
          <h4 id="name-response-artifact-ca-certif">
<a href="#section-7.5.2" class="section-number selfRef">7.5.2. </a><a href="#name-response-artifact-ca-certif" class="section-name selfRef">Response Artifact: CA-Certificates (caCerts)</a>
          </h4>
<p id="section-7.5.2-1">The CA-Certificates (caCerts) artifact <span class="bcp14">SHALL</span> be an authenticated self-contained object signed by the registrar, containing the domain trust anchors and the certificate chain for the pledge domain EE certificate, i.e., the root CA certificate(s) and possibly intermediate certificate(s) as described in <span><a href="https://rfc-editor.org/rfc/rfc7030#section-4.1.3" class="relref">Section 4.1.3</a> of [<a href="#RFC7030" class="cite xref">RFC7030</a>]</span>.<a href="#section-7.5.2-1" class="pilcrow">¶</a></p>
<p id="section-7.5.2-2">For the JWS-signed JSON format used by this specification, the caCerts artifact <span class="bcp14">MUST</span> use the "General JWS JSON Serialization Syntax" defined in <span><a href="https://rfc-editor.org/rfc/rfc7515#section-7.2.1" class="relref">Section 7.2.1</a> of [<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>, which <span class="bcp14">MUST</span> contain the JSON CA Data defined in <a href="#cacerts_data" class="auto internal xref">Section 7.5.2.1</a> in the JWS Payload.<a href="#section-7.5.2-2" class="pilcrow">¶</a></p>
<p id="section-7.5.2-3"><a href="#cacerts_representation" class="auto internal xref">Figure 26</a> summarizes the serialization of the JWS-signed JSON caCerts artifact:<a href="#section-7.5.2-3" class="pilcrow">¶</a></p>
<span id="name-voucher-representation-in-ge"></span><div id="cacerts_representation">
<figure id="figure-26">
            <div class="alignLeft art-text artwork" id="section-7.5.2-4.1">
<pre>
{
  "payload": BASE64URL(UTF8(JSON CA Data)),
  "signatures": [
    {
      "protected": BASE64URL(UTF8(JWS Protected Header)),
      "signature": BASE64URL(JWS Signature)
    }
  ]
}
</pre>
</div>
<figcaption><a href="#figure-26" class="selfRef">Figure 26</a>:
<a href="#name-voucher-representation-in-ge" class="selfRef">Voucher' Representation in General JWS JSON Serialization Syntax</a>
            </figcaption></figure>
</div>
<p id="section-7.5.2-5">The JSON CA Data <span class="bcp14">MUST</span> be UTF-8 encoded to become the octet-based JWS Payload defined in <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.
The JWS Payload is further base64url-encoded to become the string value of the <code>payload</code> member as described in <span><a href="https://rfc-editor.org/rfc/rfc7515#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.
The octets of the UTF-8 representation of the JWS Protected Header are base64url-encoded to become the string value of the <code>protected</code> member.
The generated JWS Signature is base64url-encoded to become the string value of the <code>signature</code> member.<a href="#section-7.5.2-5" class="pilcrow">¶</a></p>
<div id="cacerts_data">
<section id="section-7.5.2.1">
            <h5 id="name-json-ca-data">
<a href="#section-7.5.2.1" class="section-number selfRef">7.5.2.1. </a><a href="#name-json-ca-data" class="section-name selfRef">JSON CA Data</a>
            </h5>
<p id="section-7.5.2.1-1">The JSON CA Data <span class="bcp14">SHALL</span> be a JSON document <span>[<a href="#RFC8259" class="cite xref">RFC8259</a>]</span> that <span class="bcp14">MUST</span> conform with the CDDL <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> data model defined in <a href="#cacerts_CDDL_def" class="auto internal xref">Figure 27</a>:<a href="#section-7.5.2.1-1" class="pilcrow">¶</a></p>
<span id="name-cddl-for-json-ca-data-cacer"></span><div id="cacerts_CDDL_def">
<figure id="figure-27">
              <div class="alignLeft art-cddl art-text artwork" id="section-7.5.2.1-2.1">
<pre>
cacerts = {
        "x5bag": bytes / [2* bytes]
}
</pre>
</div>
<figcaption><a href="#figure-27" class="selfRef">Figure 27</a>:
<a href="#name-cddl-for-json-ca-data-cacer" class="selfRef">CDDL for JSON CA Data (cacerts)</a>
              </figcaption></figure>
</div>
<p id="section-7.5.2.1-3">The <code>x5bag</code> member <span class="bcp14">MUST</span> follow the definition of the <code>x5bag</code> COSE Header Parameter in <span><a href="https://rfc-editor.org/rfc/rfc9360#section-2" class="relref">Section 2</a> of [<a href="#RFC9360" class="cite xref">RFC9360</a>]</span>.
It is either a single X.509 v3 certificate or an array of at least two X.509 v3 certificates in DER format.
For JSON syntax, the octet-based certificates <span class="bcp14">MUST</span> be base64-encoded.
It <span class="bcp14">SHALL</span> contain one or more domain CA (root or issuing) certificates.<a href="#section-7.5.2.1-3" class="pilcrow">¶</a></p>
<p id="section-7.5.2.1-4">Note that as per <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>, the domain registrar acts as EST server, and hence is expected to possess the CA certificates applicable for the domain and can thus deliver them to the pledge (see <a href="#registrar_component" class="auto internal xref">Section 6.3</a>).<a href="#section-7.5.2.1-4" class="pilcrow">¶</a></p>
<p id="section-7.5.2.1-5"><a href="#cacerts_data_example" class="auto internal xref">Figure 28</a> below shows an example for the JSON CA Data:<a href="#section-7.5.2.1-5" class="pilcrow">¶</a></p>
<span id="name-json-ca-data-example"></span><div id="cacerts_data_example">
<figure id="figure-28">
              <div class="alignLeft art-text artwork" id="section-7.5.2.1-6.1">
<pre>
{
  "x5bag": [
    "base64encodedvalue==",
    "base64encodedvalue=="
  ]
}
</pre>
</div>
<figcaption><a href="#figure-28" class="selfRef">Figure 28</a>:
<a href="#name-json-ca-data-example" class="selfRef">JSON CA Data Example</a>
              </figcaption></figure>
</div>
</section>
</div>
<div id="jws-protected-header-4">
<section id="section-7.5.2.2">
            <h5 id="name-jws-protected-header-5">
<a href="#section-7.5.2.2" class="section-number selfRef">7.5.2.2. </a><a href="#name-jws-protected-header-5" class="section-name selfRef">JWS Protected Header</a>
            </h5>
<p id="section-7.5.2.2-1">The JWS Protected Header of the caCerts artifact <span class="bcp14">MUST</span> contain the following standard Header Parameters as defined in <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>:<a href="#section-7.5.2.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.5.2.2-2.1">
                <p id="section-7.5.2.2-2.1.1"><code>alg</code>: <span class="bcp14">SHALL</span> contain the algorithm type used to create the signature, e.g., <code>ES256</code>, as defined in <span><a href="https://rfc-editor.org/rfc/rfc7515#section-4.1.1" class="relref">Section 4.1.1</a> of [<a href="#RFC7515" class="cite xref">RFC7515</a>]</span><a href="#section-7.5.2.2-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.5.2.2-2.2">
                <p id="section-7.5.2.2-2.2.1"><code>x5c</code>: <span class="bcp14">SHALL</span> contain the base64-encoded registrar EE certificate used to sign the caCerts artifact as well as the certificate chain up to (but not including) the pinned domain certificate<a href="#section-7.5.2.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-7.5.2.2-3"><a href="#cacerts_header" class="auto internal xref">Figure 29</a> below shows an example for this JWS Protected Header:<a href="#section-7.5.2.2-3" class="pilcrow">¶</a></p>
<span id="name-jws-protected-header-example-"></span><div id="cacerts_header">
<figure id="figure-29">
              <div class="alignLeft art-text artwork" id="section-7.5.2.2-4.1">
<pre>
{
  "alg": "ES256",
  "x5c": [
    "base64encodedvalue==",
    "base64encodedvalue=="
  ]
}
</pre>
</div>
<figcaption><a href="#figure-29" class="selfRef">Figure 29</a>:
<a href="#name-jws-protected-header-example-" class="selfRef">JWS Protected Header Example within PER</a>
              </figcaption></figure>
</div>
</section>
</div>
<div id="jws-signature-4">
<section id="section-7.5.2.3">
            <h5 id="name-jws-signature-5">
<a href="#section-7.5.2.3" class="section-number selfRef">7.5.2.3. </a><a href="#name-jws-signature-5" class="section-name selfRef">JWS Signature</a>
            </h5>
<p id="section-7.5.2.3-1">The registrar <span class="bcp14">MUST</span> sign the caCerts artifact using its EE credentials.
The JWS Signature is generated over the JWS Protected Header and the JWS Payload as described in <span><a href="https://rfc-editor.org/rfc/rfc7515#section-5.1" class="relref">Section 5.1</a> of [<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.<a href="#section-7.5.2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="voucher">
<section id="section-7.6">
        <h3 id="name-supply-voucher-to-pledge-sv">
<a href="#section-7.6" class="section-number selfRef">7.6. </a><a href="#name-supply-voucher-to-pledge-sv" class="section-name selfRef">Supply Voucher to Pledge (svr)</a>
        </h3>
<p id="section-7.6-1">Once the Registrar-Agent has acquired the following three bootstrapping artifacts, it can supply them to the pledge starting with the Voucher':<a href="#section-7.6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.6-2.1">
            <p id="section-7.6-2.1.1">Voucher': voucher countersigned by the registrar (from MASA via Registrar)<a href="#section-7.6-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.6-2.2">
            <p id="section-7.6-2.2.1">Enroll-Resp: pledge EE certificate signed by the domain owner (from Key Infrastructure via registrar)<a href="#section-7.6-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.6-2.3">
            <p id="section-7.6-2.3.1">caCerts: domain trust anchors (from Key Infrastructure via Registrar)<a href="#section-7.6-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.6-3">Reconnecting to the pledge might require to re-discover the pledge as described in <a href="#discovery_uc2_ppa" class="auto internal xref">Section 6.1.2</a>.
The Registrar-Agent <span class="bcp14">MAY</span> store information from the first connection with the pledge to optimize.<a href="#section-7.6-3" class="pilcrow">¶</a></p>
<p id="section-7.6-4">TLS <span class="bcp14">MAY</span> be used to provide privacy for this exchange between the Registrar-Agent and the pledge (see <a href="#pledgehttps" class="auto internal xref">Appendix B</a>).<a href="#section-7.6-4" class="pilcrow">¶</a></p>
<p id="section-7.6-5"><a href="#exchangesfig_uc2_6" class="auto internal xref">Figure 30</a> shows the provisioning of the voucher to the pledge and the following subsections describe the corresponding artifacts.<a href="#section-7.6-5" class="pilcrow">¶</a></p>
<span id="name-voucher-exchange"></span><div id="exchangesfig_uc2_6">
<figure id="figure-30">
          <div id="section-7.6-6.1">
            <div class="alignCenter art-svg artwork" id="section-7.6-6.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="256" width="576" viewBox="0 0 576 256" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,32 L 8,80" fill="none" stroke="black"></path>
                <path d="M 16,160 L 16,224" fill="none" stroke="black"></path>
                <path d="M 80,32 L 80,80" fill="none" stroke="black"></path>
                <path d="M 120,32 L 120,80" fill="none" stroke="black"></path>
                <path d="M 168,160 L 168,224" fill="none" stroke="black"></path>
                <path d="M 224,32 L 224,80" fill="none" stroke="black"></path>
                <path d="M 264,32 L 264,80" fill="none" stroke="black"></path>
                <path d="M 312,160 L 312,224" fill="none" stroke="black"></path>
                <path d="M 360,32 L 360,80" fill="none" stroke="black"></path>
                <path d="M 400,32 L 400,80" fill="none" stroke="black"></path>
                <path d="M 456,160 L 456,224" fill="none" stroke="black"></path>
                <path d="M 472,32 L 472,80" fill="none" stroke="black"></path>
                <path d="M 512,32 L 512,80" fill="none" stroke="black"></path>
                <path d="M 560,160 L 560,224" fill="none" stroke="black"></path>
                <path d="M 568,32 L 568,80" fill="none" stroke="black"></path>
                <path d="M 8,32 L 80,32" fill="none" stroke="black"></path>
                <path d="M 120,32 L 224,32" fill="none" stroke="black"></path>
                <path d="M 264,32 L 360,32" fill="none" stroke="black"></path>
                <path d="M 400,32 L 472,32" fill="none" stroke="black"></path>
                <path d="M 512,32 L 568,32" fill="none" stroke="black"></path>
                <path d="M 8,80 L 80,80" fill="none" stroke="black"></path>
                <path d="M 120,80 L 224,80" fill="none" stroke="black"></path>
                <path d="M 264,80 L 360,80" fill="none" stroke="black"></path>
                <path d="M 400,80 L 472,80" fill="none" stroke="black"></path>
                <path d="M 512,80 L 568,80" fill="none" stroke="black"></path>
                <path d="M 24,176 L 56,176" fill="none" stroke="black"></path>
                <path d="M 128,176 L 160,176" fill="none" stroke="black"></path>
                <path d="M 24,192 L 64,192" fill="none" stroke="black"></path>
                <path d="M 136,192 L 160,192" fill="none" stroke="black"></path>
                <path d="M 24,208 L 64,208" fill="none" stroke="black"></path>
                <path d="M 128,208 L 160,208" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="168,208 156,202.4 156,213.6" fill="black" transform="rotate(0,160,208)"></polygon>
                <polygon class="arrowhead" points="168,176 156,170.4 156,181.6" fill="black" transform="rotate(0,160,176)"></polygon>
                <polygon class="arrowhead" points="32,192 20,186.4 20,197.6" fill="black" transform="rotate(180,24,192)"></polygon>
                <polygon class="arrowhead" points="32,176 20,170.4 20,181.6" fill="black" transform="rotate(180,24,176)"></polygon>
                <g class="text">
                  <text x="44" y="52">Pledge</text>
                  <text x="172" y="52">Registrar-</text>
                  <text x="308" y="52">Domain</text>
                  <text x="432" y="52">Key</text>
                  <text x="540" y="52">MASA</text>
                  <text x="168" y="68">Agent</text>
                  <text x="312" y="68">Registrar</text>
                  <text x="436" y="68">Infra.</text>
                  <text x="16" y="100">|</text>
                  <text x="168" y="100">|</text>
                  <text x="312" y="100">|</text>
                  <text x="456" y="100">|</text>
                  <text x="516" y="100">Internet</text>
                  <text x="560" y="100">|</text>
                  <text x="16" y="116">~</text>
                  <text x="168" y="116">~</text>
                  <text x="312" y="116">~</text>
                  <text x="456" y="116">~</text>
                  <text x="560" y="116">~</text>
                  <text x="16" y="132">(6)</text>
                  <text x="60" y="132">Supply</text>
                  <text x="120" y="132">Voucher</text>
                  <text x="164" y="132">to</text>
                  <text x="204" y="132">Pledge</text>
                  <text x="16" y="148">~</text>
                  <text x="168" y="148">~</text>
                  <text x="312" y="148">~</text>
                  <text x="456" y="148">~</text>
                  <text x="560" y="148">~</text>
                  <text x="76" y="180">opt.</text>
                  <text x="112" y="180">TLS</text>
                  <text x="100" y="196">Voucher'</text>
                  <text x="96" y="212">vStatus</text>
                  <text x="16" y="244">~</text>
                  <text x="168" y="244">~</text>
                  <text x="312" y="244">~</text>
                  <text x="456" y="244">~</text>
                  <text x="560" y="244">~</text>
                </g>
              </svg><a href="#section-7.6-6.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-30" class="selfRef">Figure 30</a>:
<a href="#name-voucher-exchange" class="selfRef">Voucher exchange</a>
          </figcaption></figure>
</div>
<p id="section-7.6-7">The Registrar-Agent <span class="bcp14">SHALL</span> supply the voucher to the pledge via HTTP(S) POST to the pledge endpoint at <code>/.well-known/brski/svr</code>.
The request body <span class="bcp14">MUST</span> contain the Registrar-Countersigned Voucher (Voucher') artifact previously acquired from the domain registrar as defined in <a href="#rcv_artifact" class="auto internal xref">Section 7.3.6</a>.
In the request header, the Content-Type field <span class="bcp14">MUST</span> be set to <code>application/voucher-jws+json</code> as defined in <span>[<a href="#I-D.ietf-anima-jws-voucher" class="cite xref">I-D.ietf-anima-jws-voucher</a>]</span> and the Accept field <span class="bcp14">SHOULD</span> be set to <code>application/jose+json</code>.<a href="#section-7.6-7" class="pilcrow">¶</a></p>
<p id="section-7.6-8">Upon receiving the voucher, the pledge <span class="bcp14">SHALL</span> perform the signature verification in the following order:<a href="#section-7.6-8" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7.6-9">
<li id="section-7.6-9.1">
            <p id="section-7.6-9.1.1">Verify the MASA signature as described in <span><a href="https://rfc-editor.org/rfc/rfc8995#section-5.6.1" class="relref">Section 5.6.1</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span> against the pre-installed manufacturer trust anchor (e.g., IDevID).<a href="#section-7.6-9.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.6-9.2">
            <p id="section-7.6-9.2.1">Provisionally install the initial domain trust anchor contained in the <code>pinned-domain-cert</code> field of the voucher.<a href="#section-7.6-9.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.6-9.3">
            <p id="section-7.6-9.3.1">Validate the registrar EE certificate received in the <code>agent-provided-proximity-registrar-cert</code> field of the previously received tPVR artifact using the pinned domain certificate;
this terminates the "provisional state" for the object security within the authenticated self-contained objects that in BRSKI-PRM replace the direct TLS connection to the registrar in BRSKI <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span> (see <a href="#agt_prx" class="auto internal xref">Section 5.4</a>).<a href="#section-7.6-9.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.6-9.4">
            <p id="section-7.6-9.4.1">Verify registrar signature of the Voucher' artifact similar as described in <span><a href="https://rfc-editor.org/rfc/rfc8995#section-5.6.1" class="relref">Section 5.6.1</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>, but using the pinned domain certificate instead of the MASA certificate for the verification.<a href="#section-7.6-9.4.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-7.6-10">If all steps above complete successfully, the pledge <span class="bcp14">SHALL</span> terminate the "provisional state" for the initial domain trust anchor (i.e., the pinned domain certificate).<a href="#section-7.6-10" class="pilcrow">¶</a></p>
<p id="section-7.6-11">A nonceless voucher <span class="bcp14">MAY</span> be accepted as in <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span> if allowed by the pledge implementation of the manufacturer.
A manufacturer may opt to provide the acceptance of nonceless voucher  as configurable item.<a href="#section-7.6-11" class="pilcrow">¶</a></p>
<p id="section-7.6-12">After voucher validation and verification, the pledge needs to reply with a status telemetry message as defined in <span><a href="https://rfc-editor.org/rfc/rfc8995#section-5.7" class="relref">Section 5.7</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>.
The pledge <span class="bcp14">MUST</span> generate the Voucher Status (vStatus) artifact as defined in <a href="#vstatus_artifact" class="auto internal xref">Section 7.6.2</a> and <span class="bcp14">MUST</span> provide it to the Registrar-Agent in the body of an HTTP 200 OK response.
In the response header, the Content-Type field <span class="bcp14">MUST</span> be set to <code>application/jose+json</code>.<a href="#section-7.6-12" class="pilcrow">¶</a></p>
<p id="section-7.6-13">If the pledge is unable to validate or verify the voucher, it <span class="bcp14">MUST</span> report the reason in the corresponding field of the Voucher Status.<a href="#section-7.6-13" class="pilcrow">¶</a></p>
<p id="section-7.6-14">If the pledge did not provide voucher status telemetry information after processing the voucher, the Registrar-Agent <span class="bcp14">MAY</span> query the pledge status explicitly as described in <a href="#query" class="auto internal xref">Section 7.11</a>.
It <span class="bcp14">MAY</span> resend the voucher depending on the Pledge status following the same procedure.<a href="#section-7.6-14" class="pilcrow">¶</a></p>
<div id="request-artifact-registrar-countersigned-voucher">
<section id="section-7.6.1">
          <h4 id="name-request-artifact-registrar-">
<a href="#section-7.6.1" class="section-number selfRef">7.6.1. </a><a href="#name-request-artifact-registrar-" class="section-name selfRef">Request Artifact: Registrar-Countersigned Voucher</a>
          </h4>
<p id="section-7.6.1-1">Identical to the Registrar-Countersigned Voucher (Voucher') artifact received from the registrar as defined in <a href="#rcv_artifact" class="auto internal xref">Section 7.3.6</a>.
The Registrar-Agent <span class="bcp14">MUST NOT</span> modify countersigned vouchers.<a href="#section-7.6.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="vstatus_artifact">
<section id="section-7.6.2">
          <h4 id="name-response-artifact-voucher-s">
<a href="#section-7.6.2" class="section-number selfRef">7.6.2. </a><a href="#name-response-artifact-voucher-s" class="section-name selfRef">Response Artifact: Voucher Status (vStatus)</a>
          </h4>
<p id="section-7.6.2-1">The Voucher Status (vStatus) artifact <span class="bcp14">SHALL</span> be an authenticated self-contained object signed by the pledge, containing status telemetry as defined in <span><a href="https://rfc-editor.org/rfc/rfc8995#section-5.7" class="relref">Section 5.7</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>.<a href="#section-7.6.2-1" class="pilcrow">¶</a></p>
<p id="section-7.6.2-2">For the JWS-signed JSON format used by this specification, the vStatus artifact <span class="bcp14">MUST</span> use the "General JWS JSON Serialization Syntax" defined in <span><a href="https://rfc-editor.org/rfc/rfc7515#section-7.2.1" class="relref">Section 7.2.1</a> of [<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>, which <span class="bcp14">MUST</span> contain the JSON Voucher Status Data defined in <a href="#vstatus_data" class="auto internal xref">Section 7.6.2.1</a> in the JWS Payload.
<a href="#vstatus_representation" class="auto internal xref">Figure 31</a> summarizes the serialization of the JWS-signed JSON vStatus artifact:<a href="#section-7.6.2-2" class="pilcrow">¶</a></p>
<span id="name-vstatus-representation-in-g"></span><div id="vstatus_representation">
<figure id="figure-31">
            <div class="alignLeft art-text artwork" id="section-7.6.2-3.1">
<pre>
{
  "payload": BASE64URL(UTF8(JSON Voucher Status Data)),
  "signatures": [
    {
      "protected": BASE64URL(UTF8(JWS Protected Header)),
      "signature": BASE64URL(JWS Signature)
    }
  ]
}
</pre>
</div>
<figcaption><a href="#figure-31" class="selfRef">Figure 31</a>:
<a href="#name-vstatus-representation-in-g" class="selfRef">vStatus Representation in General JWS JSON Serialization Syntax</a>
            </figcaption></figure>
</div>
<p id="section-7.6.2-4">The JSON Status Data <span class="bcp14">MUST</span> be UTF-8 encoded to become the octet-based JWS Payload defined in <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.
The JWS Payload is further base64url-encoded to become the string value of the <code>payload</code> member as described in <span><a href="https://rfc-editor.org/rfc/rfc7515#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.
The octets of the UTF-8 representation of the JWS Protected Header are base64url-encoded to become the string value of the <code>protected</code> member.
The generated JWS Signature is base64url-encoded to become the string value of the <code>signature</code> member.<a href="#section-7.6.2-4" class="pilcrow">¶</a></p>
<div id="vstatus_data">
<section id="section-7.6.2.1">
            <h5 id="name-json-voucher-status-data">
<a href="#section-7.6.2.1" class="section-number selfRef">7.6.2.1. </a><a href="#name-json-voucher-status-data" class="section-name selfRef">JSON Voucher Status Data</a>
            </h5>
<p id="section-7.6.2.1-1">The JSON Status Data <span class="bcp14">SHALL</span> be a JSON document <span>[<a href="#RFC8259" class="cite xref">RFC8259</a>]</span> that <span class="bcp14">MUST</span> conform with the <code>voucherstatus-post</code> CDDL <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> data model defined in <span><a href="https://rfc-editor.org/rfc/rfc8995#section-5.7" class="relref">Section 5.7</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>:<a href="#section-7.6.2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.6.2.1-2.1">
                <p id="section-7.6.2.1-2.1.1"><code>version</code>: contains a version number for the format and semantics of the other fields;
this specification assumes version <code>1</code> just like BRSKI <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>.<a href="#section-7.6.2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.6.2.1-2.2">
                <p id="section-7.6.2.1-2.2.1"><code>status</code>: contains the boolean value <code>true</code> in case of success and <code>false</code> in case of failure.<a href="#section-7.6.2.1-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.6.2.1-2.3">
                <p id="section-7.6.2.1-2.3.1"><code>reason</code>: contains a human-readable message;
<span class="bcp14">SHOULD NOT</span> provide information beneficial to an attacker.<a href="#section-7.6.2.1-2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.6.2.1-2.4">
                <p id="section-7.6.2.1-2.4.1"><code>reason-context</code>: contains a JSON object that provides additional information specific to a failure;
in contrast to <span><a href="https://rfc-editor.org/rfc/rfc8995#section-5.7" class="relref">Section 5.7</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>, <span class="bcp14">MUST</span> be provided;
<span class="bcp14">SHOULD NOT</span> provide information beneficial to an attacker.<a href="#section-7.6.2.1-2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-7.6.2.1-3">BRSKI-PRM implementations utilize the <code>reason-context</code> field to provide a distinguishable token, which enables the registrar to detect status artifacts provided to the wrong endpoint.
For vStatus artifacts, the JSON object in the <code>reason-context</code> field <span class="bcp14">MUST</span> contain the member <code>pvs-details</code>.<a href="#section-7.6.2.1-3" class="pilcrow">¶</a></p>
<p id="section-7.6.2.1-4"><a href="#vstatus_data_example_success" class="auto internal xref">Figure 32</a> shows an example for the JSON Voucher Status Data in case of success and <a href="#vstatus_data_example_error" class="auto internal xref">Figure 33</a> in case of failure:<a href="#section-7.6.2.1-4" class="pilcrow">¶</a></p>
<span id="name-json-voucher-status-data-su"></span><div id="vstatus_data_example_success">
<figure id="figure-32">
              <div class="alignLeft art-json art-text artwork" id="section-7.6.2.1-5.1">
<pre>
{
  "version": 1,
  "status": true,
  "reason": "Voucher successfully processed.",
  "reason-context": {
    "pvs-details": "Current date 5/23/2024"
  }
}
</pre>
</div>
<figcaption><a href="#figure-32" class="selfRef">Figure 32</a>:
<a href="#name-json-voucher-status-data-su" class="selfRef">JSON Voucher Status Data Success Example</a>
              </figcaption></figure>
</div>
<span id="name-json-voucher-status-data-fa"></span><div id="vstatus_data_example_error">
<figure id="figure-33">
              <div class="alignLeft art-json art-text artwork" id="section-7.6.2.1-6.1">
<pre>
{
  "version": 1,
  "status": false,
  "reason": "Failed to authenticate MASA certificate.",
  "reason-context": {
    "pvs-details": "Current date 1/1/1970 &lt; valid from 1/1/2023"
  }
}
</pre>
</div>
<figcaption><a href="#figure-33" class="selfRef">Figure 33</a>:
<a href="#name-json-voucher-status-data-fa" class="selfRef">JSON Voucher Status Data Failure Example</a>
              </figcaption></figure>
</div>
</section>
</div>
<div id="jws-protected-header-5">
<section id="section-7.6.2.2">
            <h5 id="name-jws-protected-header-6">
<a href="#section-7.6.2.2" class="section-number selfRef">7.6.2.2. </a><a href="#name-jws-protected-header-6" class="section-name selfRef">JWS Protected Header</a>
            </h5>
<p id="section-7.6.2.2-1">The JWS Protected Header of the vStatus artifact <span class="bcp14">MUST</span> contain the following standard Header Parameters as defined in <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>:<a href="#section-7.6.2.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.6.2.2-2.1">
                <p id="section-7.6.2.2-2.1.1"><code>alg</code>: <span class="bcp14">SHALL</span> contain the algorithm type used to create the signature, e.g., <code>ES256</code>, as defined in <span><a href="https://rfc-editor.org/rfc/rfc7515#section-4.1.1" class="relref">Section 4.1.1</a> of [<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.<a href="#section-7.6.2.2-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.6.2.2-2.2">
                <p id="section-7.6.2.2-2.2.1"><code>x5c</code>: <span class="bcp14">SHALL</span> contain the base64-encoded pledge IDevID certificate used to sign the vStatus artifact;
it <span class="bcp14">SHOULD</span> also contain the certificate chain for this certificate;
if the certificate chain is not included in the <code>x5c</code> Header Parameter, it <span class="bcp14">MUST</span> be available at the domain registrar for verification.<a href="#section-7.6.2.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-7.6.2.2-3"><a href="#vstatus_header" class="auto internal xref">Figure 34</a> shows an example for this JWS Protected Header:<a href="#section-7.6.2.2-3" class="pilcrow">¶</a></p>
<span id="name-jws-protected-header-example-w"></span><div id="vstatus_header">
<figure id="figure-34">
              <div class="alignLeft art-json art-text artwork" id="section-7.6.2.2-4.1">
<pre>
{
  "alg": "ES256",
  "x5c": [
    "base64encodedvalue==",
    "base64encodedvalue=="
  ]
}
</pre>
</div>
<figcaption><a href="#figure-34" class="selfRef">Figure 34</a>:
<a href="#name-jws-protected-header-example-w" class="selfRef">JWS Protected Header Example within vStatus</a>
              </figcaption></figure>
</div>
</section>
</div>
<div id="jws-signature-5">
<section id="section-7.6.2.3">
            <h5 id="name-jws-signature-6">
<a href="#section-7.6.2.3" class="section-number selfRef">7.6.2.3. </a><a href="#name-jws-signature-6" class="section-name selfRef">JWS Signature</a>
            </h5>
<p id="section-7.6.2.3-1">The pledge <span class="bcp14">MUST</span> sign the vStatus artifact using its IDevID credential.
The JWS Signature is generated over the JWS Protected Header and the JWS Payload as described in <span><a href="https://rfc-editor.org/rfc/rfc7515#section-5.1" class="relref">Section 5.1</a> of [<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.<a href="#section-7.6.2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="cacerts">
<section id="section-7.7">
        <h3 id="name-supply-ca-certificates-to-p">
<a href="#section-7.7" class="section-number selfRef">7.7. </a><a href="#name-supply-ca-certificates-to-p" class="section-name selfRef">Supply CA Certificates to Pledge (scac)</a>
        </h3>
<p id="section-7.7-1">Before supplying the pledge EE certificate, the Registrar-Agent supplies the domain CA certificates to the pledge, so the pledge can verify its EE certificate in the next exchange.
As the CA certificate provisioning is crucial from a security perspective, this exchange <span class="bcp14">SHOULD</span> only be done, if supplying the voucher in the previous exchange (<a href="#voucher" class="auto internal xref">Section 7.6</a>) has been successfully processed by the pledge as reflected in the vStatus artifact.<a href="#section-7.7-1" class="pilcrow">¶</a></p>
<p id="section-7.7-2">TLS <span class="bcp14">MAY</span> be used to provide privacy for this exchange between the Registrar-Agent and the pledge (see <a href="#pledgehttps" class="auto internal xref">Appendix B</a>).<a href="#section-7.7-2" class="pilcrow">¶</a></p>
<p id="section-7.7-3"><a href="#exchangesfig_uc2_7" class="auto internal xref">Figure 35</a> shows the provisioning of the CA certificates to the pledge and the following subsections describe the corresponding artifacts.<a href="#section-7.7-3" class="pilcrow">¶</a></p>
<span id="name-certificate-provisioning-ex"></span><div id="exchangesfig_uc2_7">
<figure id="figure-35">
          <div id="section-7.7-4.1">
            <div class="alignCenter art-svg artwork" id="section-7.7-4.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="240" width="576" viewBox="0 0 576 240" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,32 L 8,80" fill="none" stroke="black"></path>
                <path d="M 16,160 L 16,208" fill="none" stroke="black"></path>
                <path d="M 80,32 L 80,80" fill="none" stroke="black"></path>
                <path d="M 120,32 L 120,80" fill="none" stroke="black"></path>
                <path d="M 168,160 L 168,208" fill="none" stroke="black"></path>
                <path d="M 224,32 L 224,80" fill="none" stroke="black"></path>
                <path d="M 264,32 L 264,80" fill="none" stroke="black"></path>
                <path d="M 312,160 L 312,208" fill="none" stroke="black"></path>
                <path d="M 360,32 L 360,80" fill="none" stroke="black"></path>
                <path d="M 400,32 L 400,80" fill="none" stroke="black"></path>
                <path d="M 456,160 L 456,208" fill="none" stroke="black"></path>
                <path d="M 472,32 L 472,80" fill="none" stroke="black"></path>
                <path d="M 512,32 L 512,80" fill="none" stroke="black"></path>
                <path d="M 560,160 L 560,208" fill="none" stroke="black"></path>
                <path d="M 568,32 L 568,80" fill="none" stroke="black"></path>
                <path d="M 8,32 L 80,32" fill="none" stroke="black"></path>
                <path d="M 120,32 L 224,32" fill="none" stroke="black"></path>
                <path d="M 264,32 L 360,32" fill="none" stroke="black"></path>
                <path d="M 400,32 L 472,32" fill="none" stroke="black"></path>
                <path d="M 512,32 L 568,32" fill="none" stroke="black"></path>
                <path d="M 8,80 L 80,80" fill="none" stroke="black"></path>
                <path d="M 120,80 L 224,80" fill="none" stroke="black"></path>
                <path d="M 264,80 L 360,80" fill="none" stroke="black"></path>
                <path d="M 400,80 L 472,80" fill="none" stroke="black"></path>
                <path d="M 512,80 L 568,80" fill="none" stroke="black"></path>
                <path d="M 24,176 L 56,176" fill="none" stroke="black"></path>
                <path d="M 128,176 L 160,176" fill="none" stroke="black"></path>
                <path d="M 24,192 L 64,192" fill="none" stroke="black"></path>
                <path d="M 128,192 L 160,192" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="168,176 156,170.4 156,181.6" fill="black" transform="rotate(0,160,176)"></polygon>
                <polygon class="arrowhead" points="32,192 20,186.4 20,197.6" fill="black" transform="rotate(180,24,192)"></polygon>
                <polygon class="arrowhead" points="32,176 20,170.4 20,181.6" fill="black" transform="rotate(180,24,176)"></polygon>
                <g class="text">
                  <text x="44" y="52">Pledge</text>
                  <text x="172" y="52">Registrar-</text>
                  <text x="308" y="52">Domain</text>
                  <text x="432" y="52">Key</text>
                  <text x="540" y="52">MASA</text>
                  <text x="168" y="68">Agent</text>
                  <text x="312" y="68">Registrar</text>
                  <text x="436" y="68">Infra.</text>
                  <text x="16" y="100">|</text>
                  <text x="168" y="100">|</text>
                  <text x="312" y="100">|</text>
                  <text x="456" y="100">|</text>
                  <text x="516" y="100">Internet</text>
                  <text x="560" y="100">|</text>
                  <text x="16" y="116">~</text>
                  <text x="168" y="116">~</text>
                  <text x="312" y="116">~</text>
                  <text x="456" y="116">~</text>
                  <text x="560" y="116">~</text>
                  <text x="16" y="132">(7)</text>
                  <text x="60" y="132">Supply</text>
                  <text x="100" y="132">CA</text>
                  <text x="164" y="132">Certificates</text>
                  <text x="228" y="132">to</text>
                  <text x="268" y="132">Pledge</text>
                  <text x="16" y="148">~</text>
                  <text x="168" y="148">~</text>
                  <text x="312" y="148">~</text>
                  <text x="456" y="148">~</text>
                  <text x="560" y="148">~</text>
                  <text x="76" y="180">opt.</text>
                  <text x="112" y="180">TLS</text>
                  <text x="96" y="196">caCerts</text>
                  <text x="16" y="228">~</text>
                  <text x="168" y="228">~</text>
                  <text x="312" y="228">~</text>
                  <text x="456" y="228">~</text>
                  <text x="560" y="228">~</text>
                </g>
              </svg><a href="#section-7.7-4.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-35" class="selfRef">Figure 35</a>:
<a href="#name-certificate-provisioning-ex" class="selfRef">Certificate provisioning exchange</a>
          </figcaption></figure>
</div>
<p id="section-7.7-5">The Registrar-Agent <span class="bcp14">SHALL</span> provide the bag of CA certificates requested from and signed by the registrar to the pledge by HTTP(S) POST to the pledge endpoint at <code>/.well-known/brski/scac</code>.
The request body <span class="bcp14">MUST</span> contain the caCerts artifact as defined in <a href="#cacerts_artifact" class="auto internal xref">Section 7.5.2</a>.
In the request header, the Content-Type field <span class="bcp14">MUST</span> be set to <code>application/jose+json</code>.<a href="#section-7.7-5" class="pilcrow">¶</a></p>
<p id="section-7.7-6">Upon receiving valid caCerts artifact, the pledge <span class="bcp14">MUST</span> first verify the signature of the registrar using the initial trust anchor (pinned domain certificate).
In the case of success, the pledge <span class="bcp14">MUST</span> install the contained CA certificates as trust anchors as described in <span><a href="https://rfc-editor.org/rfc/rfc7030#section-4.1.3" class="relref">Section 4.1.3</a> of [<a href="#RFC7030" class="cite xref">RFC7030</a>]</span>.
This includes the verification of all intermediate CA certificates (i.e., not self-signed CA certificates).<a href="#section-7.7-6" class="pilcrow">¶</a></p>
<p id="section-7.7-7">If the pledge is unable to process the caCerts, it <span class="bcp14">SHOULD</span> respond with an HTTP error status code to the Registrar-Agent.
The following client error status codes <span class="bcp14">SHOULD</span> be used:<a href="#section-7.7-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.7-8.1">
            <p id="section-7.7-8.1.1">400 Bad Request: if the pledge detects an error in the format of the request.<a href="#section-7.7-8.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.7-8.2">
            <p id="section-7.7-8.2.1">401 Unauthorized: if the signature of the registrar cannot be verified against the installed initial trust anchor (pinned domain certificate).<a href="#section-7.7-8.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.7-8.3">
            <p id="section-7.7-8.3.1">403 Forbidden: if one of the intermediate CA certificates cannot be verified against the available trust anchors (e.g., self-signed CA certificates).<a href="#section-7.7-8.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.7-8.4">
            <p id="section-7.7-8.4.1">415 Unsupported Media Type: if the Content-Type request header field indicates a type that is unknown or unsupported, e.g., a type other than <code>application/jose+json</code>.<a href="#section-7.7-8.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.7-9">Otherwise, if processing completes successfully, the pledge <span class="bcp14">SHOULD</span> reply with HTTP 200 OK without a response body.
The pledge <span class="bcp14">MAY</span> use the response body to signal success/failure details to the service technician operating the Registrar-Agent.<a href="#section-7.7-9" class="pilcrow">¶</a></p>
<div id="request-artifact-ca-certificates-cacerts">
<section id="section-7.7.1">
          <h4 id="name-request-artifact-ca-certifi">
<a href="#section-7.7.1" class="section-number selfRef">7.7.1. </a><a href="#name-request-artifact-ca-certifi" class="section-name selfRef">Request Artifact: CA-Certificates (caCerts)</a>
          </h4>
<p id="section-7.7.1-1">Identical to the CA-Certificates (caCerts) artifact received from the registrar as defined in <a href="#cacerts_artifact" class="auto internal xref">Section 7.5.2</a>.
The Registrar-Agent <span class="bcp14">MUST NOT</span> modify CA-Certificates artifacts.<a href="#section-7.7.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="response-no-artifact">
<section id="section-7.7.2">
          <h4 id="name-response-no-artifact">
<a href="#section-7.7.2" class="section-number selfRef">7.7.2. </a><a href="#name-response-no-artifact" class="section-name selfRef">Response (no artifact)</a>
          </h4>
<p id="section-7.7.2-1">In this exchange, the response is a result of the HTTP(S) default transport for this specification.
There is no artifact provided to the Registrar-Agent.<a href="#section-7.7.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="enroll_response">
<section id="section-7.8">
        <h3 id="name-supply-enroll-response-to-p">
<a href="#section-7.8" class="section-number selfRef">7.8. </a><a href="#name-supply-enroll-response-to-p" class="section-name selfRef">Supply Enroll-Response to Pledge (ser)</a>
        </h3>
<p id="section-7.8-1">After supplying the CA certificates, the Registrar-Agent supplies the pledge EE certificate to the pledge.<a href="#section-7.8-1" class="pilcrow">¶</a></p>
<p id="section-7.8-2">TLS <span class="bcp14">MAY</span> be used to provide privacy for this exchange between the Registrar-Agent and the pledge (see <a href="#pledgehttps" class="auto internal xref">Appendix B</a>).<a href="#section-7.8-2" class="pilcrow">¶</a></p>
<p id="section-7.8-3"><a href="#exchangesfig_uc2_8" class="auto internal xref">Figure 36</a> shows the provisioning of the domain-owner signed EE certificate to the pledge and the following subsections describe the corresponding artifacts.<a href="#section-7.8-3" class="pilcrow">¶</a></p>
<span id="name-enroll-response-exchange"></span><div id="exchangesfig_uc2_8">
<figure id="figure-36">
          <div id="section-7.8-4.1">
            <div class="alignCenter art-svg artwork" id="section-7.8-4.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="256" width="576" viewBox="0 0 576 256" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,32 L 8,80" fill="none" stroke="black"></path>
                <path d="M 16,160 L 16,224" fill="none" stroke="black"></path>
                <path d="M 80,32 L 80,80" fill="none" stroke="black"></path>
                <path d="M 120,32 L 120,80" fill="none" stroke="black"></path>
                <path d="M 168,160 L 168,224" fill="none" stroke="black"></path>
                <path d="M 224,32 L 224,80" fill="none" stroke="black"></path>
                <path d="M 264,32 L 264,80" fill="none" stroke="black"></path>
                <path d="M 312,160 L 312,224" fill="none" stroke="black"></path>
                <path d="M 360,32 L 360,80" fill="none" stroke="black"></path>
                <path d="M 400,32 L 400,80" fill="none" stroke="black"></path>
                <path d="M 456,160 L 456,224" fill="none" stroke="black"></path>
                <path d="M 472,32 L 472,80" fill="none" stroke="black"></path>
                <path d="M 512,32 L 512,80" fill="none" stroke="black"></path>
                <path d="M 560,160 L 560,224" fill="none" stroke="black"></path>
                <path d="M 568,32 L 568,80" fill="none" stroke="black"></path>
                <path d="M 8,32 L 80,32" fill="none" stroke="black"></path>
                <path d="M 120,32 L 224,32" fill="none" stroke="black"></path>
                <path d="M 264,32 L 360,32" fill="none" stroke="black"></path>
                <path d="M 400,32 L 472,32" fill="none" stroke="black"></path>
                <path d="M 512,32 L 568,32" fill="none" stroke="black"></path>
                <path d="M 8,80 L 80,80" fill="none" stroke="black"></path>
                <path d="M 120,80 L 224,80" fill="none" stroke="black"></path>
                <path d="M 264,80 L 360,80" fill="none" stroke="black"></path>
                <path d="M 400,80 L 472,80" fill="none" stroke="black"></path>
                <path d="M 512,80 L 568,80" fill="none" stroke="black"></path>
                <path d="M 24,176 L 56,176" fill="none" stroke="black"></path>
                <path d="M 128,176 L 160,176" fill="none" stroke="black"></path>
                <path d="M 24,192 L 48,192" fill="none" stroke="black"></path>
                <path d="M 144,192 L 160,192" fill="none" stroke="black"></path>
                <path d="M 24,208 L 56,208" fill="none" stroke="black"></path>
                <path d="M 120,208 L 160,208" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="168,208 156,202.4 156,213.6" fill="black" transform="rotate(0,160,208)"></polygon>
                <polygon class="arrowhead" points="168,176 156,170.4 156,181.6" fill="black" transform="rotate(0,160,176)"></polygon>
                <polygon class="arrowhead" points="32,192 20,186.4 20,197.6" fill="black" transform="rotate(180,24,192)"></polygon>
                <polygon class="arrowhead" points="32,176 20,170.4 20,181.6" fill="black" transform="rotate(180,24,176)"></polygon>
                <g class="text">
                  <text x="44" y="52">Pledge</text>
                  <text x="172" y="52">Registrar-</text>
                  <text x="308" y="52">Domain</text>
                  <text x="432" y="52">Key</text>
                  <text x="540" y="52">MASA</text>
                  <text x="168" y="68">Agent</text>
                  <text x="312" y="68">Registrar</text>
                  <text x="436" y="68">Infra.</text>
                  <text x="16" y="100">|</text>
                  <text x="168" y="100">|</text>
                  <text x="312" y="100">|</text>
                  <text x="456" y="100">|</text>
                  <text x="516" y="100">Internet</text>
                  <text x="560" y="100">|</text>
                  <text x="16" y="116">~</text>
                  <text x="168" y="116">~</text>
                  <text x="312" y="116">~</text>
                  <text x="456" y="116">~</text>
                  <text x="560" y="116">~</text>
                  <text x="16" y="132">(8)</text>
                  <text x="60" y="132">Supply</text>
                  <text x="152" y="132">Enroll-Response</text>
                  <text x="228" y="132">to</text>
                  <text x="268" y="132">Pledge</text>
                  <text x="16" y="148">~</text>
                  <text x="168" y="148">~</text>
                  <text x="312" y="148">~</text>
                  <text x="456" y="148">~</text>
                  <text x="560" y="148">~</text>
                  <text x="76" y="180">opt.</text>
                  <text x="112" y="180">TLS</text>
                  <text x="96" y="196">Enroll-Resp</text>
                  <text x="88" y="212">eStatus</text>
                  <text x="16" y="244">~</text>
                  <text x="168" y="244">~</text>
                  <text x="312" y="244">~</text>
                  <text x="456" y="244">~</text>
                  <text x="560" y="244">~</text>
                </g>
              </svg><a href="#section-7.8-4.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-36" class="selfRef">Figure 36</a>:
<a href="#name-enroll-response-exchange" class="selfRef">Enroll-Response exchange</a>
          </figcaption></figure>
</div>
<p id="section-7.8-5">The Registrar-Agent <span class="bcp14">SHALL</span> send the domain-owner signed EE certificate to the pledge by HTTP(S) POST to the pledge endpoint at <code>/.well-known/brski/ser</code>.
The request body <span class="bcp14">MUST</span> contain the Enroll-Response (Enroll-Resp) artifact previously acquired from the domain registrar as defined in <a href="#er_artifact" class="auto internal xref">Section 7.4.2</a>.
In the request header, the Content-Type field <span class="bcp14">MUST</span> be set to <code>application/pkcs7-mime</code> and the Accept field <span class="bcp14">SHOULD</span> be set to <code>application/jose+json</code>.<a href="#section-7.8-5" class="pilcrow">¶</a></p>
<p id="section-7.8-6">Upon reception, the pledge <span class="bcp14">SHALL</span> verify the received EE certificate using the installed trust anchors.
After Enroll-Resp validation and verification, the pledge needs to reply with a status telemetry message as defined in <span><a href="https://rfc-editor.org/rfc/rfc8995#section-5.9.4" class="relref">Section 5.9.4</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>.
The pledge <span class="bcp14">MUST</span> generate the Enroll Status (eStatus) artifact as defined in <a href="#estatus_artifact" class="auto internal xref">Section 7.8.2</a> and <span class="bcp14">MUST</span> provide it to the Registrar-Agent in the body of an HTTP 200 OK response.
In the response header, the Content-Type field <span class="bcp14">MUST</span> be set to <code>application/jose+json</code>.<a href="#section-7.8-6" class="pilcrow">¶</a></p>
<p id="section-7.8-7">If the pledge is unable to validate or verify the Enroll-Response, it <span class="bcp14">MUST</span> report the reason in the corresponding field of the Enroll Status.<a href="#section-7.8-7" class="pilcrow">¶</a></p>
<div id="request-artifact-enroll-response-enroll-resp">
<section id="section-7.8.1">
          <h4 id="name-request-artifact-enroll-res">
<a href="#section-7.8.1" class="section-number selfRef">7.8.1. </a><a href="#name-request-artifact-enroll-res" class="section-name selfRef">Request Artifact: Enroll-Response (Enroll-Resp)</a>
          </h4>
<p id="section-7.8.1-1">Identical to the Enroll-Response (Enroll-Resp) artifact received from the registrar as defined in <a href="#er_artifact" class="auto internal xref">Section 7.4.2</a>.
The Registrar-Agent <span class="bcp14">MUST NOT</span> modify Enroll-Response artifacts.<a href="#section-7.8.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="estatus_artifact">
<section id="section-7.8.2">
          <h4 id="name-response-artifact-enroll-st">
<a href="#section-7.8.2" class="section-number selfRef">7.8.2. </a><a href="#name-response-artifact-enroll-st" class="section-name selfRef">Response Artifact: Enroll Status (eStatus)</a>
          </h4>
<p id="section-7.8.2-1">The Enroll Status (eStatus) artifact <span class="bcp14">SHALL</span> be an authenticated self-contained object signed by the pledge, containing status telemetry as defined in <span><a href="https://rfc-editor.org/rfc/rfc8995#section-5.9.4" class="relref">Section 5.9.4</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>.<a href="#section-7.8.2-1" class="pilcrow">¶</a></p>
<p id="section-7.8.2-2">For the JWS-signed JSON format used by this specification, the eStatus artifact <span class="bcp14">MUST</span> use the "General JWS JSON Serialization Syntax" defined in <span><a href="https://rfc-editor.org/rfc/rfc7515#section-7.2.1" class="relref">Section 7.2.1</a> of [<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>, which <span class="bcp14">MUST</span> contain the JSON Enroll Status Data defined in <a href="#estatus_data" class="auto internal xref">Section 7.8.2.1</a> in the JWS Payload.
<a href="#estatus_representation" class="auto internal xref">Figure 37</a> summarizes the serialization of the JWS-signed JSON eStatus artifact:<a href="#section-7.8.2-2" class="pilcrow">¶</a></p>
<span id="name-estatus-representation-in-g"></span><div id="estatus_representation">
<figure id="figure-37">
            <div class="alignLeft art-text artwork" id="section-7.8.2-3.1">
<pre>
{
  "payload": BASE64URL(UTF8(JSON Enroll Status Data)),
  "signatures": [
    {
      "protected": BASE64URL(UTF8(JWS Protected Header)),
      "signature": BASE64URL(JWS Signature)
    }
  ]
}
</pre>
</div>
<figcaption><a href="#figure-37" class="selfRef">Figure 37</a>:
<a href="#name-estatus-representation-in-g" class="selfRef">eStatus Representation in General JWS JSON Serialization Syntax</a>
            </figcaption></figure>
</div>
<p id="section-7.8.2-4">The JSON Enroll Status Data <span class="bcp14">MUST</span> be UTF-8 encoded to become the octet-based JWS Payload defined in <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.
The JWS Payload is further base64url-encoded to become the string value of the <code>payload</code> member as described in <span><a href="https://rfc-editor.org/rfc/rfc7515#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.
The octets of the UTF-8 representation of the JWS Protected Header are base64url-encoded to become the string value of the <code>protected</code> member.
The generated JWS Signature is base64url-encoded to become the string value of the <code>signature</code> member.<a href="#section-7.8.2-4" class="pilcrow">¶</a></p>
<div id="estatus_data">
<section id="section-7.8.2.1">
            <h5 id="name-json-enroll-status-data">
<a href="#section-7.8.2.1" class="section-number selfRef">7.8.2.1. </a><a href="#name-json-enroll-status-data" class="section-name selfRef">JSON Enroll Status Data</a>
            </h5>
<p id="section-7.8.2.1-1">The JSON Status Data <span class="bcp14">SHALL</span> be a JSON document <span>[<a href="#RFC8259" class="cite xref">RFC8259</a>]</span> that <span class="bcp14">MUST</span> conform with the <code>enrollstatus-post</code> CDDL <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> data model defined in <span><a href="https://rfc-editor.org/rfc/rfc8995#section-5.9.4" class="relref">Section 5.9.4</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>.
The members are the same as for the JSON Voucher Status Data and follow the same definitions as given in <a href="#vstatus_data" class="auto internal xref">Section 7.6.2.1</a> (incl. making <code>reason-context</code> mandatory).<a href="#section-7.8.2.1-1" class="pilcrow">¶</a></p>
<p id="section-7.8.2.1-2">BRSKI-PRM implementations again utilize the <code>reason-context</code> field to provide a distinguishable token.
For eStatus artifacts, the JSON object in the <code>reason-context</code> field <span class="bcp14">MUST</span> contain the member <code>pes-details</code>.<a href="#section-7.8.2.1-2" class="pilcrow">¶</a></p>
<p id="section-7.8.2.1-3"><a href="#estatus_data_example_success" class="auto internal xref">Figure 38</a> below shows an example for the JSON Enroll Status Data in case of success and <a href="#estatus_data_example_error" class="auto internal xref">Figure 39</a> in case of failure:<a href="#section-7.8.2.1-3" class="pilcrow">¶</a></p>
<span id="name-json-enroll-status-data-suc"></span><div id="estatus_data_example_success">
<figure id="figure-38">
              <div class="alignLeft art-json art-text artwork" id="section-7.8.2.1-4.1">
<pre>
{
  "version": 1,
  "status": true,
  "reason": "Enroll-Response successfully processed.",
  "reason-context": {
    "pes-details": "Success"
  }
}
</pre>
</div>
<figcaption><a href="#figure-38" class="selfRef">Figure 38</a>:
<a href="#name-json-enroll-status-data-suc" class="selfRef">JSON Enroll Status Data Success Example</a>
              </figcaption></figure>
</div>
<span id="name-json-enroll-status-data-fai"></span><div id="estatus_data_example_error">
<figure id="figure-39">
              <div class="alignLeft art-json art-text artwork" id="section-7.8.2.1-5.1">
<pre>
{
  "version": 1,
  "status": false,
  "reason": "Enroll-Response could not be verified.",
  "reason-context": {
    "pes-details": "No matching trust anchor"
  }
}
</pre>
</div>
<figcaption><a href="#figure-39" class="selfRef">Figure 39</a>:
<a href="#name-json-enroll-status-data-fai" class="selfRef">JSON Enroll Status Data Failure Example</a>
              </figcaption></figure>
</div>
</section>
</div>
<div id="jws-protected-header-6">
<section id="section-7.8.2.2">
            <h5 id="name-jws-protected-header-7">
<a href="#section-7.8.2.2" class="section-number selfRef">7.8.2.2. </a><a href="#name-jws-protected-header-7" class="section-name selfRef">JWS Protected Header</a>
            </h5>
<p id="section-7.8.2.2-1">The JWS Protected Header of the eStatus artifact <span class="bcp14">MUST</span> contain the following standard Header Parameters as defined in <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>:<a href="#section-7.8.2.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.8.2.2-2.1">
                <p id="section-7.8.2.2-2.1.1"><code>alg</code>: <span class="bcp14">SHALL</span> contain the algorithm type used to create the signature, e.g., <code>ES256</code>, as defined in <span><a href="https://rfc-editor.org/rfc/rfc7515#section-4.1.1" class="relref">Section 4.1.1</a> of [<a href="#RFC7515" class="cite xref">RFC7515</a>]</span><a href="#section-7.8.2.2-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.8.2.2-2.2">
                <p id="section-7.8.2.2-2.2.1"><code>x5c</code>: <span class="bcp14">SHALL</span> contain the base64-encoded pledge EE certificate used to sign the eStatus artifact;
it <span class="bcp14">SHOULD</span> also contain the certificate chain for this certificate;
if the certificate chain is not included in the <code>x5c</code> Header Parameter, it <span class="bcp14">MUST</span> be available at the domain registrar for verification<a href="#section-7.8.2.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-7.8.2.2-3"><a href="#estatus_header" class="auto internal xref">Figure 40</a> below shows an example for this JWS Protected Header:<a href="#section-7.8.2.2-3" class="pilcrow">¶</a></p>
<span id="name-jws-protected-header-example-wi"></span><div id="estatus_header">
<figure id="figure-40">
              <div class="alignLeft art-json art-text artwork" id="section-7.8.2.2-4.1">
<pre>
{
  "alg": "ES256",
  "x5c": [
    "base64encodedvalue==",
    "base64encodedvalue=="
  ]
}
</pre>
</div>
<figcaption><a href="#figure-40" class="selfRef">Figure 40</a>:
<a href="#name-jws-protected-header-example-wi" class="selfRef">JWS Protected Header Example within eStatus</a>
              </figcaption></figure>
</div>
</section>
</div>
<div id="jws-signature-6">
<section id="section-7.8.2.3">
            <h5 id="name-jws-signature-7">
<a href="#section-7.8.2.3" class="section-number selfRef">7.8.2.3. </a><a href="#name-jws-signature-7" class="section-name selfRef">JWS Signature</a>
            </h5>
<p id="section-7.8.2.3-1">If the pledge verified the received EE certificate successfully, it <span class="bcp14">MUST</span> sign the eStatus artifact using its new EE credentials.
In failure case, the pledge <span class="bcp14">MUST</span> sign it using its IDevID credentials.
The JWS Signature is generated over the JWS Protected Header and the JWS Payload as described in <span><a href="https://rfc-editor.org/rfc/rfc7515#section-5.1" class="relref">Section 5.1</a> of [<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.<a href="#section-7.8.2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="vstatus">
<section id="section-7.9">
        <h3 id="name-voucher-status-telemetry-in">
<a href="#section-7.9" class="section-number selfRef">7.9. </a><a href="#name-voucher-status-telemetry-in" class="section-name selfRef">Voucher Status Telemetry (including MASA interaction)</a>
        </h3>
<p id="section-7.9-1">Once the Registrar-Agent has collected both status artifacts from one or more pledges, it <span class="bcp14">SHALL</span> provide the status information to the domain registrar for further processing, beginning with the voucher status telemetry.<a href="#section-7.9-1" class="pilcrow">¶</a></p>
<p id="section-7.9-2">In case the TLS session to the registrar is closed, the Registrar-Agent establishes a new session as described in <a href="#pvr" class="auto internal xref">Section 7.3</a>.<a href="#section-7.9-2" class="pilcrow">¶</a></p>
<p id="section-7.9-3"><a href="#exchangesfig_uc2_9" class="auto internal xref">Figure 41</a> shows the provisioning of the voucher status information from the pledge(s) to the registrar and the following subsections describe the corresponding artifact and MASA interaction.<a href="#section-7.9-3" class="pilcrow">¶</a></p>
<span id="name-voucher-status-telemetry-ex"></span><div id="exchangesfig_uc2_9">
<figure id="figure-41">
          <div id="section-7.9-4.1">
            <div class="alignCenter art-svg artwork" id="section-7.9-4.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="320" width="576" viewBox="0 0 576 320" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,32 L 8,80" fill="none" stroke="black"></path>
                <path d="M 16,160 L 16,288" fill="none" stroke="black"></path>
                <path d="M 80,32 L 80,80" fill="none" stroke="black"></path>
                <path d="M 120,32 L 120,80" fill="none" stroke="black"></path>
                <path d="M 168,160 L 168,288" fill="none" stroke="black"></path>
                <path d="M 224,32 L 224,80" fill="none" stroke="black"></path>
                <path d="M 264,32 L 264,80" fill="none" stroke="black"></path>
                <path d="M 312,160 L 312,256" fill="none" stroke="black"></path>
                <path d="M 360,32 L 360,80" fill="none" stroke="black"></path>
                <path d="M 400,32 L 400,80" fill="none" stroke="black"></path>
                <path d="M 456,160 L 456,200" fill="none" stroke="black"></path>
                <path d="M 456,256 L 456,288" fill="none" stroke="black"></path>
                <path d="M 472,32 L 472,80" fill="none" stroke="black"></path>
                <path d="M 512,32 L 512,80" fill="none" stroke="black"></path>
                <path d="M 560,160 L 560,288" fill="none" stroke="black"></path>
                <path d="M 568,32 L 568,80" fill="none" stroke="black"></path>
                <path d="M 8,32 L 80,32" fill="none" stroke="black"></path>
                <path d="M 120,32 L 224,32" fill="none" stroke="black"></path>
                <path d="M 264,32 L 360,32" fill="none" stroke="black"></path>
                <path d="M 400,32 L 472,32" fill="none" stroke="black"></path>
                <path d="M 512,32 L 568,32" fill="none" stroke="black"></path>
                <path d="M 8,80 L 80,80" fill="none" stroke="black"></path>
                <path d="M 120,80 L 224,80" fill="none" stroke="black"></path>
                <path d="M 264,80 L 360,80" fill="none" stroke="black"></path>
                <path d="M 400,80 L 472,80" fill="none" stroke="black"></path>
                <path d="M 512,80 L 568,80" fill="none" stroke="black"></path>
                <path d="M 176,176 L 216,176" fill="none" stroke="black"></path>
                <path d="M 256,176 L 304,176" fill="none" stroke="black"></path>
                <path d="M 176,192 L 208,192" fill="none" stroke="black"></path>
                <path d="M 272,192 L 304,192" fill="none" stroke="black"></path>
                <path d="M 320,208 L 416,208" fill="none" stroke="black"></path>
                <path d="M 456,208 L 552,208" fill="none" stroke="black"></path>
                <path d="M 320,224 L 352,224" fill="none" stroke="black"></path>
                <path d="M 520,224 L 552,224" fill="none" stroke="black"></path>
                <path d="M 320,240 L 368,240" fill="none" stroke="black"></path>
                <path d="M 504,240 L 552,240" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="560,224 548,218.4 548,229.6" fill="black" transform="rotate(0,552,224)"></polygon>
                <polygon class="arrowhead" points="560,208 548,202.4 548,213.6" fill="black" transform="rotate(0,552,208)"></polygon>
                <polygon class="arrowhead" points="328,240 316,234.4 316,245.6" fill="black" transform="rotate(180,320,240)"></polygon>
                <polygon class="arrowhead" points="328,208 316,202.4 316,213.6" fill="black" transform="rotate(180,320,208)"></polygon>
                <polygon class="arrowhead" points="312,192 300,186.4 300,197.6" fill="black" transform="rotate(0,304,192)"></polygon>
                <polygon class="arrowhead" points="312,176 300,170.4 300,181.6" fill="black" transform="rotate(0,304,176)"></polygon>
                <polygon class="arrowhead" points="184,176 172,170.4 172,181.6" fill="black" transform="rotate(180,176,176)"></polygon>
                <g class="text">
                  <text x="44" y="52">Pledge</text>
                  <text x="172" y="52">Registrar-</text>
                  <text x="308" y="52">Domain</text>
                  <text x="432" y="52">Key</text>
                  <text x="540" y="52">MASA</text>
                  <text x="168" y="68">Agent</text>
                  <text x="312" y="68">Registrar</text>
                  <text x="436" y="68">Infra.</text>
                  <text x="16" y="100">|</text>
                  <text x="168" y="100">|</text>
                  <text x="312" y="100">|</text>
                  <text x="456" y="100">|</text>
                  <text x="516" y="100">Internet</text>
                  <text x="560" y="100">|</text>
                  <text x="16" y="116">~</text>
                  <text x="168" y="116">~</text>
                  <text x="312" y="116">~</text>
                  <text x="456" y="116">~</text>
                  <text x="560" y="116">~</text>
                  <text x="16" y="132">(9)</text>
                  <text x="64" y="132">Voucher</text>
                  <text x="124" y="132">Status</text>
                  <text x="192" y="132">Telemetry</text>
                  <text x="276" y="132">(including</text>
                  <text x="352" y="132">backend</text>
                  <text x="436" y="132">interaction)</text>
                  <text x="16" y="148">~</text>
                  <text x="168" y="148">~</text>
                  <text x="312" y="148">~</text>
                  <text x="456" y="148">~</text>
                  <text x="560" y="148">~</text>
                  <text x="236" y="180">mTLS</text>
                  <text x="240" y="196">vStatus</text>
                  <text x="436" y="212">mTLS</text>
                  <text x="368" y="228">req</text>
                  <text x="412" y="228">device</text>
                  <text x="480" y="228">audit-log</text>
                  <text x="396" y="244">device</text>
                  <text x="464" y="244">audit-log</text>
                  <text x="264" y="276">[verify</text>
                  <text x="340" y="276">audit-log]</text>
                  <text x="312" y="292">|</text>
                  <text x="16" y="308">~</text>
                  <text x="168" y="308">~</text>
                  <text x="312" y="308">~</text>
                  <text x="456" y="308">~</text>
                  <text x="560" y="308">~</text>
                </g>
              </svg><a href="#section-7.9-4.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-41" class="selfRef">Figure 41</a>:
<a href="#name-voucher-status-telemetry-ex" class="selfRef">Voucher Status telemetry exchange</a>
          </figcaption></figure>
</div>
<p id="section-7.9-5">First, the Registrar-Agent <span class="bcp14">SHALL</span> supply the voucher status telemetry to the registrar via HTTP-over-TLS POST to the registrar endpoint at <code>/.well-known/brski/voucher_status</code>.
The request body <span class="bcp14">MUST</span> contain one previously acquired vStatus artifact as defined in <a href="#vstatus_artifact" class="auto internal xref">Section 7.6.2</a>.
In the request header, the Content-Type field <span class="bcp14">MUST</span> be set to <code>application/jose+json</code>.<a href="#section-7.9-5" class="pilcrow">¶</a></p>
<p id="section-7.9-6">Upon receiving a vStatus artifact, the registrar <span class="bcp14">MUST</span> process it as described in <span><a href="https://rfc-editor.org/rfc/rfc8995#section-5.7" class="relref">Section 5.7</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>.
Due to the Registrar-Agent in the middle, the registrar <span class="bcp14">MUST</span> in addition verify the signature of the vStatus and that it belongs to an accepted device of the domain based on the <code>serial-number</code> field of the IDevID certificate contained in the JWS Protected Header of the vStatus.<a href="#section-7.9-6" class="pilcrow">¶</a></p>
<p id="section-7.9-7">According to <span><a href="https://rfc-editor.org/rfc/rfc8995#section-5.7" class="relref">Section 5.7</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>, the registrar <span class="bcp14">SHOULD</span> respond with an HTTP 200 OK without a response body in the success case or fail with an HTTP error status code.
The registrar <span class="bcp14">MAY</span> use the response body to signal success/failure details to the service technician operating the Registrar-Agent.<a href="#section-7.9-7" class="pilcrow">¶</a></p>
<p id="section-7.9-8">The registrar <span class="bcp14">SHOULD</span> proceed with the audit-log request to the MASA as in BRSKI described in <span><a href="https://rfc-editor.org/rfc/rfc8995#section-5.8" class="relref">Section 5.8</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>.<a href="#section-7.9-8" class="pilcrow">¶</a></p>
<div id="request-artifact-voucher-status-vstatus">
<section id="section-7.9.1">
          <h4 id="name-request-artifact-voucher-st">
<a href="#section-7.9.1" class="section-number selfRef">7.9.1. </a><a href="#name-request-artifact-voucher-st" class="section-name selfRef">Request Artifact: Voucher Status (vStatus)</a>
          </h4>
<p id="section-7.9.1-1">Identical to the Voucher Status (vStatus) artifact received from the pledge as defined in <a href="#vstatus_artifact" class="auto internal xref">Section 7.6.2</a>.
The Registrar-Agent <span class="bcp14">MUST NOT</span> modify vStatus artifacts.<a href="#section-7.9.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="response-no-artifact-1">
<section id="section-7.9.2">
          <h4 id="name-response-no-artifact-2">
<a href="#section-7.9.2" class="section-number selfRef">7.9.2. </a><a href="#name-response-no-artifact-2" class="section-name selfRef">Response (no artifact)</a>
          </h4>
<p id="section-7.9.2-1">In this exchange, the response is a result of the HTTP(S) default transport for this specification.
There is no artifact provided to the Registrar-Agent.<a href="#section-7.9.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="estatus">
<section id="section-7.10">
        <h3 id="name-enroll-status-telemetry">
<a href="#section-7.10" class="section-number selfRef">7.10. </a><a href="#name-enroll-status-telemetry" class="section-name selfRef">Enroll Status Telemetry</a>
        </h3>
<p id="section-7.10-1">The Registrar-Agent <span class="bcp14">SHALL</span> complete the sequence of exchanges for bootstrapping with providing the enroll status telemetry to the domain registrar.
This status indicates whether the pledge could process the Enroll-Response (pledge EE certificate signed by the domain owner) and holds the corresponding private key.<a href="#section-7.10-1" class="pilcrow">¶</a></p>
<p id="section-7.10-2">In case the TLS session to the registrar is already closed, the Registrar-Agent establishes a new session as described in <a href="#pvr" class="auto internal xref">Section 7.3</a>.<a href="#section-7.10-2" class="pilcrow">¶</a></p>
<p id="section-7.10-3"><a href="#exchangesfig_uc2_10" class="auto internal xref">Figure 42</a> shows the provisioning of the enroll status information from the pledge(s) to the registrar and the following subsections describe the corresponding artifact.<a href="#section-7.10-3" class="pilcrow">¶</a></p>
<span id="name-enroll-status-telemetry-exc"></span><div id="exchangesfig_uc2_10">
<figure id="figure-42">
          <div id="section-7.10-4.1">
            <div class="alignCenter art-svg artwork" id="section-7.10-4.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="240" width="576" viewBox="0 0 576 240" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,32 L 8,80" fill="none" stroke="black"></path>
                <path d="M 16,160 L 16,208" fill="none" stroke="black"></path>
                <path d="M 80,32 L 80,80" fill="none" stroke="black"></path>
                <path d="M 120,32 L 120,80" fill="none" stroke="black"></path>
                <path d="M 168,160 L 168,208" fill="none" stroke="black"></path>
                <path d="M 224,32 L 224,80" fill="none" stroke="black"></path>
                <path d="M 264,32 L 264,80" fill="none" stroke="black"></path>
                <path d="M 312,160 L 312,208" fill="none" stroke="black"></path>
                <path d="M 360,32 L 360,80" fill="none" stroke="black"></path>
                <path d="M 400,32 L 400,80" fill="none" stroke="black"></path>
                <path d="M 456,160 L 456,208" fill="none" stroke="black"></path>
                <path d="M 472,32 L 472,80" fill="none" stroke="black"></path>
                <path d="M 512,32 L 512,80" fill="none" stroke="black"></path>
                <path d="M 560,160 L 560,208" fill="none" stroke="black"></path>
                <path d="M 568,32 L 568,80" fill="none" stroke="black"></path>
                <path d="M 8,32 L 80,32" fill="none" stroke="black"></path>
                <path d="M 120,32 L 224,32" fill="none" stroke="black"></path>
                <path d="M 264,32 L 360,32" fill="none" stroke="black"></path>
                <path d="M 400,32 L 472,32" fill="none" stroke="black"></path>
                <path d="M 512,32 L 568,32" fill="none" stroke="black"></path>
                <path d="M 8,80 L 80,80" fill="none" stroke="black"></path>
                <path d="M 120,80 L 224,80" fill="none" stroke="black"></path>
                <path d="M 264,80 L 360,80" fill="none" stroke="black"></path>
                <path d="M 400,80 L 472,80" fill="none" stroke="black"></path>
                <path d="M 512,80 L 568,80" fill="none" stroke="black"></path>
                <path d="M 176,176 L 216,176" fill="none" stroke="black"></path>
                <path d="M 256,176 L 304,176" fill="none" stroke="black"></path>
                <path d="M 176,192 L 208,192" fill="none" stroke="black"></path>
                <path d="M 272,192 L 304,192" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="312,192 300,186.4 300,197.6" fill="black" transform="rotate(0,304,192)"></polygon>
                <polygon class="arrowhead" points="312,176 300,170.4 300,181.6" fill="black" transform="rotate(0,304,176)"></polygon>
                <polygon class="arrowhead" points="184,176 172,170.4 172,181.6" fill="black" transform="rotate(180,176,176)"></polygon>
                <g class="text">
                  <text x="44" y="52">Pledge</text>
                  <text x="172" y="52">Registrar-</text>
                  <text x="308" y="52">Domain</text>
                  <text x="432" y="52">Key</text>
                  <text x="540" y="52">MASA</text>
                  <text x="168" y="68">Agent</text>
                  <text x="312" y="68">Registrar</text>
                  <text x="436" y="68">Infra.</text>
                  <text x="16" y="100">|</text>
                  <text x="168" y="100">|</text>
                  <text x="312" y="100">|</text>
                  <text x="456" y="100">|</text>
                  <text x="516" y="100">Internet</text>
                  <text x="560" y="100">|</text>
                  <text x="16" y="116">~</text>
                  <text x="168" y="116">~</text>
                  <text x="312" y="116">~</text>
                  <text x="456" y="116">~</text>
                  <text x="560" y="116">~</text>
                  <text x="20" y="132">(10)</text>
                  <text x="68" y="132">Enroll</text>
                  <text x="124" y="132">Status</text>
                  <text x="192" y="132">Telemetry</text>
                  <text x="16" y="148">~</text>
                  <text x="168" y="148">~</text>
                  <text x="312" y="148">~</text>
                  <text x="456" y="148">~</text>
                  <text x="560" y="148">~</text>
                  <text x="236" y="180">mTLS</text>
                  <text x="240" y="196">eStatus</text>
                  <text x="16" y="228">~</text>
                  <text x="168" y="228">~</text>
                  <text x="312" y="228">~</text>
                  <text x="456" y="228">~</text>
                  <text x="560" y="228">~</text>
                </g>
              </svg><a href="#section-7.10-4.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-42" class="selfRef">Figure 42</a>:
<a href="#name-enroll-status-telemetry-exc" class="selfRef">Enroll Status telemetry exchange</a>
          </figcaption></figure>
</div>
<p id="section-7.10-5">The Registrar-Agent <span class="bcp14">SHALL</span> supply the enroll status telemetry to the registrar via HTTP-over-TLS POST to the registrar endpoint at <code>/.well-known/brski/enrollstatus</code>.
The request body <span class="bcp14">MUST</span> contain one previously acquired eStatus artifact as defined in <a href="#estatus_artifact" class="auto internal xref">Section 7.8.2</a>.
In the request header, the Content-Type field <span class="bcp14">MUST</span> be set to <code>application/jose+json</code>.<a href="#section-7.10-5" class="pilcrow">¶</a></p>
<p id="section-7.10-6">Upon receiving an eStatus artifact, the registrar <span class="bcp14">MUST</span> process it as described in <span><a href="https://rfc-editor.org/rfc/rfc8995#section-5.9.4" class="relref">Section 5.9.4</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>.
Due to the Registrar-Agent in the middle, instead of the BRSKI TLS session with the pledge, the registrar <span class="bcp14">MUST</span> verify the signature of the eStatus artifact and that it belongs to an accepted device of the domain based on the <code>serial-number</code> field of the EE certificate contained in the JWS Protected Header of the eStatus.
Note that if the Enroll Status indicates success, the eStatus artifact is signed with the new pledge EE credentials;
if it indicates failure, the pledge was unable to process the supplied EE certificate and therefore signed with its IDevID credentials.<a href="#section-7.10-6" class="pilcrow">¶</a></p>
<p id="section-7.10-7">According to <span><a href="https://rfc-editor.org/rfc/rfc8995#section-5.9.4" class="relref">Section 5.9.4</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>, the registrar <span class="bcp14">SHOULD</span> respond with an HTTP 200 OK in the success case or <span class="bcp14">MAY</span> fail with an HTTP 404 client error status code.
The registrar <span class="bcp14">MAY</span> use the response body to signal success/failure details to the service technician operating the Registrar-Agent.<a href="#section-7.10-7" class="pilcrow">¶</a></p>
<p id="section-7.10-8">If the eStatus indicates failure, the registrar <span class="bcp14">MAY</span> decide that for security reasons the pledge is not allowed to reside in the domain.
In this case, the registrar <span class="bcp14">MUST</span> revoke the pledge EE certificate.
An example case for the registrar revoking the issued certificate is when the pledge was not able to verify the received EE certificate and therefore did not accept it for installation.<a href="#section-7.10-8" class="pilcrow">¶</a></p>
<div id="request-artifact-enroll-status-estatus">
<section id="section-7.10.1">
          <h4 id="name-request-artifact-enroll-sta">
<a href="#section-7.10.1" class="section-number selfRef">7.10.1. </a><a href="#name-request-artifact-enroll-sta" class="section-name selfRef">Request Artifact: Enroll Status (eStatus)</a>
          </h4>
<p id="section-7.10.1-1">Identical to the Enroll Status (eStatus) artifact received from the pledge as defined in <a href="#estatus_artifact" class="auto internal xref">Section 7.8.2</a>.
The Registrar-Agent <span class="bcp14">MUST NOT</span> modify eStatus artifacts.<a href="#section-7.10.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="response-no-artifact-2">
<section id="section-7.10.2">
          <h4 id="name-response-no-artifact-3">
<a href="#section-7.10.2" class="section-number selfRef">7.10.2. </a><a href="#name-response-no-artifact-3" class="section-name selfRef">Response (no artifact)</a>
          </h4>
<p id="section-7.10.2-1">In this exchange, the response is a result of the HTTP(S) default transport for this specification.
There is no artifact provided to the Registrar-Agent.<a href="#section-7.10.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="query">
<section id="section-7.11">
        <h3 id="name-query-pledge-status-qps">
<a href="#section-7.11" class="section-number selfRef">7.11. </a><a href="#name-query-pledge-status-qps" class="section-name selfRef">Query Pledge Status (qps)</a>
        </h3>
<p id="section-7.11-1">The following assumes that a Registrar-Agent may need to query the overall status of a pledge.
This information can be useful to solve errors, when the pledge was not able to connect to the target domain during bootstrapping.
A pledge <span class="bcp14">MAY</span> omit the dedicated endpoint for the Query Pledge Status operation (see <a href="#pledge_component" class="auto internal xref">Section 6.2</a>).<a href="#section-7.11-1" class="pilcrow">¶</a></p>
<p id="section-7.11-2">TLS <span class="bcp14">MAY</span> be used to provide privacy for this exchange between the Registrar-Agent and the pledge (see <a href="#pledgehttps" class="auto internal xref">Appendix B</a>).<a href="#section-7.11-2" class="pilcrow">¶</a></p>
<p id="section-7.11-3"><a href="#exchangesfig_uc2_11" class="auto internal xref">Figure 43</a> shows the query and response for the overall pledge status and the following subsections describe the corresponding artifacts.<a href="#section-7.11-3" class="pilcrow">¶</a></p>
<span id="name-pledge-status-exchange"></span><div id="exchangesfig_uc2_11">
<figure id="figure-43">
          <div id="section-7.11-4.1">
            <div class="alignCenter art-svg artwork" id="section-7.11-4.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="256" width="576" viewBox="0 0 576 256" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,32 L 8,80" fill="none" stroke="black"></path>
                <path d="M 16,160 L 16,224" fill="none" stroke="black"></path>
                <path d="M 80,32 L 80,80" fill="none" stroke="black"></path>
                <path d="M 120,32 L 120,80" fill="none" stroke="black"></path>
                <path d="M 168,160 L 168,224" fill="none" stroke="black"></path>
                <path d="M 224,32 L 224,80" fill="none" stroke="black"></path>
                <path d="M 264,32 L 264,80" fill="none" stroke="black"></path>
                <path d="M 312,160 L 312,224" fill="none" stroke="black"></path>
                <path d="M 360,32 L 360,80" fill="none" stroke="black"></path>
                <path d="M 400,32 L 400,80" fill="none" stroke="black"></path>
                <path d="M 456,160 L 456,224" fill="none" stroke="black"></path>
                <path d="M 472,32 L 472,80" fill="none" stroke="black"></path>
                <path d="M 512,32 L 512,80" fill="none" stroke="black"></path>
                <path d="M 560,160 L 560,224" fill="none" stroke="black"></path>
                <path d="M 568,32 L 568,80" fill="none" stroke="black"></path>
                <path d="M 8,32 L 80,32" fill="none" stroke="black"></path>
                <path d="M 120,32 L 224,32" fill="none" stroke="black"></path>
                <path d="M 264,32 L 360,32" fill="none" stroke="black"></path>
                <path d="M 400,32 L 472,32" fill="none" stroke="black"></path>
                <path d="M 512,32 L 568,32" fill="none" stroke="black"></path>
                <path d="M 8,80 L 80,80" fill="none" stroke="black"></path>
                <path d="M 120,80 L 224,80" fill="none" stroke="black"></path>
                <path d="M 264,80 L 360,80" fill="none" stroke="black"></path>
                <path d="M 400,80 L 472,80" fill="none" stroke="black"></path>
                <path d="M 512,80 L 568,80" fill="none" stroke="black"></path>
                <path d="M 24,176 L 56,176" fill="none" stroke="black"></path>
                <path d="M 128,176 L 160,176" fill="none" stroke="black"></path>
                <path d="M 24,192 L 64,192" fill="none" stroke="black"></path>
                <path d="M 128,192 L 160,192" fill="none" stroke="black"></path>
                <path d="M 24,208 L 64,208" fill="none" stroke="black"></path>
                <path d="M 128,208 L 160,208" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="168,208 156,202.4 156,213.6" fill="black" transform="rotate(0,160,208)"></polygon>
                <polygon class="arrowhead" points="168,176 156,170.4 156,181.6" fill="black" transform="rotate(0,160,176)"></polygon>
                <polygon class="arrowhead" points="32,192 20,186.4 20,197.6" fill="black" transform="rotate(180,24,192)"></polygon>
                <polygon class="arrowhead" points="32,176 20,170.4 20,181.6" fill="black" transform="rotate(180,24,176)"></polygon>
                <g class="text">
                  <text x="44" y="52">Pledge</text>
                  <text x="172" y="52">Registrar-</text>
                  <text x="308" y="52">Domain</text>
                  <text x="432" y="52">Key</text>
                  <text x="540" y="52">MASA</text>
                  <text x="168" y="68">Agent</text>
                  <text x="312" y="68">Registrar</text>
                  <text x="436" y="68">Infra.</text>
                  <text x="16" y="100">|</text>
                  <text x="168" y="100">|</text>
                  <text x="312" y="100">|</text>
                  <text x="456" y="100">|</text>
                  <text x="516" y="100">Internet</text>
                  <text x="560" y="100">|</text>
                  <text x="16" y="116">~</text>
                  <text x="168" y="116">~</text>
                  <text x="312" y="116">~</text>
                  <text x="456" y="116">~</text>
                  <text x="560" y="116">~</text>
                  <text x="20" y="132">(11)</text>
                  <text x="64" y="132">Query</text>
                  <text x="116" y="132">Pledge</text>
                  <text x="172" y="132">Status</text>
                  <text x="16" y="148">~</text>
                  <text x="168" y="148">~</text>
                  <text x="312" y="148">~</text>
                  <text x="456" y="148">~</text>
                  <text x="560" y="148">~</text>
                  <text x="76" y="180">opt.</text>
                  <text x="112" y="180">TLS</text>
                  <text x="96" y="196">tStatus</text>
                  <text x="96" y="212">pStatus</text>
                  <text x="16" y="244">~</text>
                  <text x="168" y="244">~</text>
                  <text x="312" y="244">~</text>
                  <text x="456" y="244">~</text>
                  <text x="560" y="244">~</text>
                </g>
              </svg><a href="#section-7.11-4.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-43" class="selfRef">Figure 43</a>:
<a href="#name-pledge-status-exchange" class="selfRef">Pledge Status exchange</a>
          </figcaption></figure>
</div>
<p id="section-7.11-5">The Registrar-Agent <span class="bcp14">SHALL</span> query the pledge via HTTP(S) POST to the pledge endpoint at <code>/.well-known/brski/qps</code>.
The request body <span class="bcp14">MUST</span> contain the Status Trigger (tStatus) artifact as defined in <a href="#tstatus_artifact" class="auto internal xref">Section 7.11.1</a>.
In the request header, the Content-Type field <span class="bcp14">MUST</span> be set to <code>application/jose+json</code> and the Accept field <span class="bcp14">SHOULD</span> be set to <code>application/jose+json</code>.<a href="#section-7.11-5" class="pilcrow">¶</a></p>
<p id="section-7.11-6">If the pledge implements the Query Pledge Status endpoint, it <span class="bcp14">MUST</span> first verify the signature of the tStatus artifact using its trust anchors.
If the pledge does not possess any domain trust anchor yet, it <span class="bcp14">MAY</span> skip the signature verification and choose to reply without it.
In the case of success, it <span class="bcp14">MUST</span> reply with the Pledge Status (pStatus) artifact as defined in <a href="#pstatus_artifact" class="auto internal xref">Section 7.11.2</a> in the body of an HTTP 200 OK response.
In the response header, the Content-Type field <span class="bcp14">MUST</span> be set to <code>application/jose+json</code>.<a href="#section-7.11-6" class="pilcrow">¶</a></p>
<p id="section-7.11-7">If the pledge is unable to create the pStatus artifact, the pledge <span class="bcp14">SHOULD</span> respond with an HTTP error status code to the Registrar-Agent.
The following client error status codes <span class="bcp14">SHOULD</span> be used:<a href="#section-7.11-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.11-8.1">
            <p id="section-7.11-8.1.1">400 Bad Request: if the pledge detects an error in the format of the request.<a href="#section-7.11-8.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.11-8.2">
            <p id="section-7.11-8.2.1">401 Unauthorized: if the signature of the Registrar-Agent cannot be verified using the installed trust anchors.<a href="#section-7.11-8.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.11-8.3">
            <p id="section-7.11-8.3.1">406 Not Acceptable: if the Accept request header field indicates a type that is unknown or unsupported, e.g., a type other than <code>application/jose+json</code>.<a href="#section-7.11-8.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.11-8.4">
            <p id="section-7.11-8.4.1">415 Unsupported Media Type: if the Content-Type request header field indicates a type that is unknown or unsupported, e.g., a type other than <code>application/jose+json</code>.<a href="#section-7.11-8.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.11-9">The pledge <span class="bcp14">MAY</span> use the response body to signal failure details to the service technician operating the Registrar-Agent.<a href="#section-7.11-9" class="pilcrow">¶</a></p>
<div id="tstatus_artifact">
<section id="section-7.11.1">
          <h4 id="name-request-artifact-status-tri">
<a href="#section-7.11.1" class="section-number selfRef">7.11.1. </a><a href="#name-request-artifact-status-tri" class="section-name selfRef">Request Artifact: Status Trigger (tStatus)</a>
          </h4>
<p id="section-7.11.1-1">The Status Query (tStatus) artifact <span class="bcp14">SHALL</span> be an authenticated self-contained object signed by the pledge, providing status query parameters.<a href="#section-7.11.1-1" class="pilcrow">¶</a></p>
<p id="section-7.11.1-2">For the JWS-signed JSON format used by this specification, the tStatus artifact <span class="bcp14">MUST</span> use the "General JWS JSON Serialization Syntax" defined in <span><a href="https://rfc-editor.org/rfc/rfc7515#section-7.2.1" class="relref">Section 7.2.1</a> of [<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>, which <span class="bcp14">MUST</span> contain the JSON Status Trigger Data defined in <a href="#tstatus_data" class="auto internal xref">Section 7.11.1.1</a> in the JWS Payload.
<a href="#tstatus_representation" class="auto internal xref">Figure 44</a> summarizes the serialization of the JWS-signed JSON PER artifact:<a href="#section-7.11.1-2" class="pilcrow">¶</a></p>
<span id="name-tstatus-representation-in-g"></span><div id="tstatus_representation">
<figure id="figure-44">
            <div class="alignLeft art-text artwork" id="section-7.11.1-3.1">
<pre>
{
  "payload": BASE64URL(UTF8(JSON Status Trigger Data)),
  "signatures": [
    {
      "protected": BASE64URL(UTF8(JWS Protected Header)),
      "signature": BASE64URL(JWS Signature)
    }
  ]
}
</pre>
</div>
<figcaption><a href="#figure-44" class="selfRef">Figure 44</a>:
<a href="#name-tstatus-representation-in-g" class="selfRef">tStatus Representation in General JWS JSON Serialization Syntax</a>
            </figcaption></figure>
</div>
<p id="section-7.11.1-4">The JSON Status Trigger Data <span class="bcp14">MUST</span> be UTF-8 encoded to become the octet-based JWS Payload defined in <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.
The JWS Payload is further base64url-encoded to become the string value of the <code>payload</code> member as described in <span><a href="https://rfc-editor.org/rfc/rfc7515#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.
The octets of the UTF-8 representation of the JWS Protected Header are base64url-encoded to become the string value of the <code>protected</code> member.
The generated JWS Signature is base64url-encoded to become the string value of the <code>signature</code> member.<a href="#section-7.11.1-4" class="pilcrow">¶</a></p>
<div id="tstatus_data">
<section id="section-7.11.1.1">
            <h5 id="name-json-status-trigger-data">
<a href="#section-7.11.1.1" class="section-number selfRef">7.11.1.1. </a><a href="#name-json-status-trigger-data" class="section-name selfRef">JSON Status Trigger Data</a>
            </h5>
<p id="section-7.11.1.1-1">The JSON Status Trigger Data <span class="bcp14">SHALL</span> be a JSON document <span>[<a href="#RFC8259" class="cite xref">RFC8259</a>]</span> that <span class="bcp14">MUST</span> conform with the CDDL <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> data model defined in <a href="#stat_req_def" class="auto internal xref">Figure 45</a>:<a href="#section-7.11.1.1-1" class="pilcrow">¶</a></p>
<span id="name-cddl-for-json-status-trigge"></span><div id="stat_req_def">
<figure id="figure-45">
              <div class="alignLeft art-cddl art-text artwork" id="section-7.11.1.1-2.1">
<pre>
  statustrigger = {
      "version": uint,
      "serial-number": text,
      "created-on": tdate,
      "status-type": $status-type
  }

  $status-type /= "bootstrap"
  $status-type /= "operation"
</pre>
</div>
<figcaption><a href="#figure-45" class="selfRef">Figure 45</a>:
<a href="#name-cddl-for-json-status-trigge" class="selfRef">CDDL for JSON Status Trigger Data (statustrigger)</a>
              </figcaption></figure>
</div>
<p id="section-7.11.1.1-3">The <code>version</code> member is included to permit significant changes to the pledge status artifacts in the future.
The format and semantics in this document follow the status telemetry definitions of <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>.
Hence, the <code>version</code> <span class="bcp14">SHALL</span> be set to <code>1</code>.
A pledge (or Registrar-Agent) that receives a version larger than it knows about <span class="bcp14">SHOULD</span> log the contents and emit an operational notification.<a href="#section-7.11.1.1-3" class="pilcrow">¶</a></p>
<p id="section-7.11.1.1-4">The <code>serial-number</code> member <span class="bcp14">SHALL</span> contain the product-serial-number corresponding to the X520SerialNumber field of the pledge IDevID certificate;
it can be correlated with the product-serial-number in the signing certificate contained in the JWS Protected Header of the Pledge Status response artifact.<a href="#section-7.11.1.1-4" class="pilcrow">¶</a></p>
<p id="section-7.11.1.1-5">The <code>created-on</code> member <span class="bcp14">SHALL</span> contain the current date and time at tStatus creation as standard date/time string as defined in <span><a href="https://rfc-editor.org/rfc/rfc3339#section-5.6" class="relref">Section 5.6</a> of [<a href="#RFC3339" class="cite xref">RFC3339</a>]</span>;
it can be used as reference time for the corresponding Pledge Status response artifact after correlating via the product-serial-number;
note that pledges may not have synchronized time to provide the created-on date and time on their own.<a href="#section-7.11.1.1-5" class="pilcrow">¶</a></p>
<p id="section-7.11.1.1-6">The <code>status-type</code> allows for specifying which status information is to be returned.
As shown in <a href="#stat_req_def" class="auto internal xref">Figure 45</a>, BRSKI-PRM defines two enumeration values:<a href="#section-7.11.1.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.11.1.1-7.1">
                <p id="section-7.11.1.1-7.1.1"><code>bootstrap</code> to query current status information regarding the bootstrapping status (e.g., voucher processing and enrollment of the pledge into a domain).<a href="#section-7.11.1.1-7.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.11.1.1-7.2">
                <p id="section-7.11.1.1-7.2.1"><code>operation</code> to query current status information regarding the operational status (e.g., utilization of the bootstrapped EE credentials in communication with other peers).<a href="#section-7.11.1.1-7.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-7.11.1.1-8">Other specifications using this artifact may define further enumeration values, e.g., to query application-related status.<a href="#section-7.11.1.1-8" class="pilcrow">¶</a></p>
<p id="section-7.11.1.1-9"><a href="#stat_req_data" class="auto internal xref">Figure 46</a> shows an example for the JSON Status Trigger Data using the status type <code>bootstrap</code>:<a href="#section-7.11.1.1-9" class="pilcrow">¶</a></p>
<span id="name-json-status-trigger-data-ex"></span><div id="stat_req_data">
<figure id="figure-46">
              <div class="alignLeft art-json art-text artwork" id="section-7.11.1.1-10.1">
<pre>
{
  "version": 1,
  "created-on": "2022-08-12T02:37:39.235Z",
  "serial-number": "vendor-pledge4711",
  "status-type": "bootstrap"
}
</pre>
</div>
<figcaption><a href="#figure-46" class="selfRef">Figure 46</a>:
<a href="#name-json-status-trigger-data-ex" class="selfRef">JSON Status Trigger Data Example</a>
              </figcaption></figure>
</div>
</section>
</div>
<div id="jws-protected-header-7">
<section id="section-7.11.1.2">
            <h5 id="name-jws-protected-header-8">
<a href="#section-7.11.1.2" class="section-number selfRef">7.11.1.2. </a><a href="#name-jws-protected-header-8" class="section-name selfRef">JWS Protected Header</a>
            </h5>
<p id="section-7.11.1.2-1">The JWS Protected Header of the tStatus artifact <span class="bcp14">MUST</span> contain the following standard Header Parameters as defined in <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>:<a href="#section-7.11.1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.11.1.2-2.1">
                <p id="section-7.11.1.2-2.1.1"><code>alg</code>: <span class="bcp14">SHALL</span> contain the algorithm type used to create the signature, e.g., <code>ES256</code>, as defined in <span><a href="https://rfc-editor.org/rfc/rfc7515#section-4.1.1" class="relref">Section 4.1.1</a> of [<a href="#RFC7515" class="cite xref">RFC7515</a>]</span><a href="#section-7.11.1.2-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.11.1.2-2.2">
                <p id="section-7.11.1.2-2.2.1"><code>x5c</code>: <span class="bcp14">SHALL</span> contain the base64-encoded Registrar-Agent EE certificate used to sign the tStatus artifact as well as the certificate chain<a href="#section-7.11.1.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-7.11.1.2-3"><a href="#tstatus_header" class="auto internal xref">Figure 47</a> shows an example for this JWS Protected Header:<a href="#section-7.11.1.2-3" class="pilcrow">¶</a></p>
<span id="name-jws-protected-header-example-wit"></span><div id="tstatus_header">
<figure id="figure-47">
              <div class="alignLeft art-json art-text artwork" id="section-7.11.1.2-4.1">
<pre>
{
  "alg": "ES256",
  "x5c": [
    "base64encodedvalue==",
    "base64encodedvalue=="
  ]
}
</pre>
</div>
<figcaption><a href="#figure-47" class="selfRef">Figure 47</a>:
<a href="#name-jws-protected-header-example-wit" class="selfRef">JWS Protected Header Example within tStatus</a>
              </figcaption></figure>
</div>
</section>
</div>
<div id="jws-signature-7">
<section id="section-7.11.1.3">
            <h5 id="name-jws-signature-8">
<a href="#section-7.11.1.3" class="section-number selfRef">7.11.1.3. </a><a href="#name-jws-signature-8" class="section-name selfRef">JWS Signature</a>
            </h5>
<p id="section-7.11.1.3-1">The Registrar-Agent <span class="bcp14">MUST</span> sign the tStatus artifact using its EE credentials.
The JWS Signature is generated over the JWS Protected Header and the JWS Payload as described in <span><a href="https://rfc-editor.org/rfc/rfc7515#section-5.1" class="relref">Section 5.1</a> of [<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.<a href="#section-7.11.1.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="pstatus_artifact">
<section id="section-7.11.2">
          <h4 id="name-response-artifact-pledge-st">
<a href="#section-7.11.2" class="section-number selfRef">7.11.2. </a><a href="#name-response-artifact-pledge-st" class="section-name selfRef">Response Artifact: Pledge Status (pStatus)</a>
          </h4>
<p id="section-7.11.2-1">The Pledge Status (pStatus) artifact <span class="bcp14">SHALL</span> be an authenticated self-contained object signed by the pledge, containing status telemetry information.
The exact content depends on the Status Trigger parameter <code>status-type</code>.<a href="#section-7.11.2-1" class="pilcrow">¶</a></p>
<p id="section-7.11.2-2">For the JWS-signed JSON format used by this specification, the pStatus artifact <span class="bcp14">MUST</span> use the "General JWS JSON Serialization Syntax" defined in <span><a href="https://rfc-editor.org/rfc/rfc7515#section-7.2.1" class="relref">Section 7.2.1</a> of [<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>, which <span class="bcp14">MUST</span> contain the JSON Pledge Status Data defined in <a href="#pstatus_data" class="auto internal xref">Section 7.11.2.1</a> in the JWS Payload.
<a href="#pstatus_representation" class="auto internal xref">Figure 48</a> summarizes the serialization of the JWS-signed JSON PER artifact:<a href="#section-7.11.2-2" class="pilcrow">¶</a></p>
<span id="name-pstatus-representation-in-g"></span><div id="pstatus_representation">
<figure id="figure-48">
            <div class="alignLeft art-text artwork" id="section-7.11.2-3.1">
<pre>
{
  "payload": BASE64URL(UTF8(JSON Pledge Status Data)),
  "signatures": [
    {
      "protected": BASE64URL(UTF8(JWS Protected Header)),
      "signature": BASE64URL(JWS Signature)
    }
  ]
}
</pre>
</div>
<figcaption><a href="#figure-48" class="selfRef">Figure 48</a>:
<a href="#name-pstatus-representation-in-g" class="selfRef">pStatus Representation in General JWS JSON Serialization Syntax</a>
            </figcaption></figure>
</div>
<p id="section-7.11.2-4">The JSON Pledge Status Data <span class="bcp14">MUST</span> be UTF-8 encoded to become the octet-based JWS Payload defined in <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.
The JWS Payload is further base64url-encoded to become the string value of the <code>payload</code> member as described in <span><a href="https://rfc-editor.org/rfc/rfc7515#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.
The octets of the UTF-8 representation of the JWS Protected Header are base64url-encoded to become the string value of the <code>protected</code> member.
The generated JWS Signature is base64url-encoded to become the string value of the <code>signature</code> member.<a href="#section-7.11.2-4" class="pilcrow">¶</a></p>
<div id="pstatus_data">
<section id="section-7.11.2.1">
            <h5 id="name-json-pledge-status-data">
<a href="#section-7.11.2.1" class="section-number selfRef">7.11.2.1. </a><a href="#name-json-pledge-status-data" class="section-name selfRef">JSON Pledge Status Data</a>
            </h5>
<p id="section-7.11.2.1-1">The JSON Pledge Status Data <span class="bcp14">SHALL</span> be a JSON document <span>[<a href="#RFC8259" class="cite xref">RFC8259</a>]</span> that <span class="bcp14">MUST</span> conform with the CDDL <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> data model defined in <a href="#stat_res_def" class="auto internal xref">Figure 49</a>, which has the same members as the <code>voucherstatus-post</code> CDDL defined in <span><a href="https://rfc-editor.org/rfc/rfc8995#section-5.7" class="relref">Section 5.7</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span> and the <code>enrollstatus-post</code> CDDL defined in <span><a href="https://rfc-editor.org/rfc/rfc8995#section-5.9.4" class="relref">Section 5.9.4</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>.<a href="#section-7.11.2.1-1" class="pilcrow">¶</a></p>
<span id="name-cddl-for-json-pledge-status"></span><div id="stat_res_def">
<figure id="figure-49">
              <div class="alignLeft art-cddl art-text artwork" id="section-7.11.2.1-2.1">
<pre>
  pledgestatus = {
    "version": uint,
    "status": bool,
    ?"reason" : text,
    "reason-context": { * $$arbitrary-map }
  }
</pre>
</div>
<figcaption><a href="#figure-49" class="selfRef">Figure 49</a>:
<a href="#name-cddl-for-json-pledge-status" class="selfRef">CDDL for JSON Pledge Status Data (pledgestatus)</a>
              </figcaption></figure>
</div>
<p id="section-7.11.2.1-3">The <code>version</code> member follows the definition in <a href="#tstatus_data" class="auto internal xref">Section 7.11.1.1</a> (same as in JSON Status Query Data).<a href="#section-7.11.2.1-3" class="pilcrow">¶</a></p>
<p id="section-7.11.2.1-4">The <code>reason</code> and <code>reason-context</code> members follow the definitions in <a href="#vstatus_data" class="auto internal xref">Section 7.6.2.1</a>, i.e., in contrast to <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>, <code>reason-context</code> <span class="bcp14">MUST</span> be provided.<a href="#section-7.11.2.1-4" class="pilcrow">¶</a></p>
<p id="section-7.11.2.1-5">The new pStatus artifact also utilizes the <code>reason-context</code> field to provide a distinguishable token.
For pStatus artifacts, the JSON object in the <code>reason-context</code> field <span class="bcp14">MUST</span> contain either the<a href="#section-7.11.2.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.11.2.1-6.1">
                <p id="section-7.11.2.1-6.1.1"><code>pbs-details</code> member for status information corresponding to the status-type <code>bootstrap</code>, or the<a href="#section-7.11.2.1-6.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.11.2.1-6.2">
                <p id="section-7.11.2.1-6.2.1"><code>pos-details</code> member for status information corresponding to the status-type <code>operation</code> (see <a href="#tstatus_data" class="auto internal xref">Section 7.11.1.1</a>)<a href="#section-7.11.2.1-6.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-7.11.2.1-7">Other documents may add additional <code>reason-context</code> members correlating to other <code>statustrigger</code> status-types or to include further status information.<a href="#section-7.11.2.1-7" class="pilcrow">¶</a></p>
<p id="section-7.11.2.1-8">For the <code>pbs-details</code> member, the following values with the given semantics are defined, while additional information <span class="bcp14">MAY</span> be provided in the top-level <code>reason</code> member:<a href="#section-7.11.2.1-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.11.2.1-9.1">
                <p id="section-7.11.2.1-9.1.1"><code>factory-default</code>: Pledge has not been bootstrapped.
The pledge signs the response message using its IDevID certificate/credentials.<a href="#section-7.11.2.1-9.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.11.2.1-9.2">
                <p id="section-7.11.2.1-9.2.1"><code>voucher-success</code>: Pledge processed the voucher exchange successfully.
The pledge signs the response message using its IDevID certificate/credentials.<a href="#section-7.11.2.1-9.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.11.2.1-9.3">
                <p id="section-7.11.2.1-9.3.1"><code>voucher-error</code>: Pledge voucher processing terminated with error.
Additional information may be provided in the <code>reason</code> or <code>reason-context</code> members.
The pledge signs the response message using its IDevID certificate/credentials.<a href="#section-7.11.2.1-9.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.11.2.1-9.4">
                <p id="section-7.11.2.1-9.4.1"><code>enroll-success</code>: Pledge processed the enrollment exchange successfully.
Additional information may be provided in the <code>reason</code> or <code>reason-context</code> members.
The pledge signs the response message using its domain-owner signed EE certificate/credentials.<a href="#section-7.11.2.1-9.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.11.2.1-9.5">
                <p id="section-7.11.2.1-9.5.1"><code>enroll-error</code>: Pledge enrollment-response processing terminated with error.
Additional information may be provided in the <code>reason</code> or <code>reason-context</code> members.
The pledge signs the response message using its IDevID certificate/credentials.<a href="#section-7.11.2.1-9.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-7.11.2.1-10">The <code>pbs-details</code> values <span class="bcp14">SHALL</span> be cumulative in the sense that <code>enroll-success</code> and <code>enroll-error</code> imply <code>voucher-success</code>.
<a href="#stat_example_bootstrap" class="auto internal xref">Figure 50</a> below provides an example for bootstrap status information in the JSON Pledge Status Data:<a href="#section-7.11.2.1-10" class="pilcrow">¶</a></p>
<span id="name-status-bootstrap-json-pledg"></span><div id="stat_example_bootstrap">
<figure id="figure-50">
              <div class="alignLeft art-json art-text artwork" id="section-7.11.2.1-11.1">
<pre>
{
  "version": 1,
  "status": true,
  "reason": "Pledge processed enrollment exchange successfully.",
  "reason-context": {
    "pbs-details": "Pledge processed enrollment exchange successfully."
  }
}
</pre>
</div>
<figcaption><a href="#figure-50" class="selfRef">Figure 50</a>:
<a href="#name-status-bootstrap-json-pledg" class="selfRef">status-bootstrap JSON Pledge Status Data Example</a>
              </figcaption></figure>
</div>
<p id="section-7.11.2.1-12">For the <code>pos-details</code> member, the following values with the given semantics are defined, while additional information <span class="bcp14">MAY</span> be provided in the top-level <code>reason</code> member:<a href="#section-7.11.2.1-12" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.11.2.1-13.1">
                <p id="section-7.11.2.1-13.1.1"><code>connect-success</code>: Pledge could successfully establish a connection to another peer.
The pledge signs the response message using its domain-owner signed EE certificate/credentials.<a href="#section-7.11.2.1-13.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.11.2.1-13.2">
                <p id="section-7.11.2.1-13.2.1"><code>connect-error</code>: Pledge connection establishment terminated with error.
The pledge signs the response message using its domain-owner signed EE certificate/credentials.<a href="#section-7.11.2.1-13.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-7.11.2.1-14"><a href="#stat_example_operation" class="auto internal xref">Figure 51</a> provides an example for operational status information in the JSON Pledge Status Data:<a href="#section-7.11.2.1-14" class="pilcrow">¶</a></p>
<span id="name-status-operation-json-pledg"></span><div id="stat_example_operation">
<figure id="figure-51">
              <div class="alignLeft art-json art-text artwork" id="section-7.11.2.1-15.1">
<pre>
{
  "version": 1,
  "status": "connect-error",
  "reason": "TLS certificate could not be verified.",
  "reason-context": {
    "connect-error" : "Connection establishment terminated with error."
  }
}
</pre>
</div>
<figcaption><a href="#figure-51" class="selfRef">Figure 51</a>:
<a href="#name-status-operation-json-pledg" class="selfRef">status-operation JSON Pledge Status Data Example</a>
              </figcaption></figure>
</div>
</section>
</div>
<div id="jws-protected-header-8">
<section id="section-7.11.2.2">
            <h5 id="name-jws-protected-header-9">
<a href="#section-7.11.2.2" class="section-number selfRef">7.11.2.2. </a><a href="#name-jws-protected-header-9" class="section-name selfRef">JWS Protected Header</a>
            </h5>
<p id="section-7.11.2.2-1">The JWS Protected Header of the pStatus artifact <span class="bcp14">MUST</span> contain the following standard Header Parameters as defined in <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>:<a href="#section-7.11.2.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.11.2.2-2.1">
                <p id="section-7.11.2.2-2.1.1"><code>alg</code>: <span class="bcp14">SHALL</span> contain the algorithm type used to create the signature, e.g., <code>ES256</code>, as defined in <span><a href="https://rfc-editor.org/rfc/rfc7515#section-4.1.1" class="relref">Section 4.1.1</a> of [<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.<a href="#section-7.11.2.2-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.11.2.2-2.2">
                <p id="section-7.11.2.2-2.2.1"><code>x5c</code>: <span class="bcp14">SHALL</span> contain the base64-encoded pledge EE certificate used to sign the pStatus artifact;
it <span class="bcp14">SHOULD</span> also contain the certificate chain for this certificate;
if the certificate chain is not included in the x5c Header Parameter, it <span class="bcp14">MUST</span> be available at the Registrar-Agent for verification.<a href="#section-7.11.2.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-7.11.2.2-3"><a href="#pstatus_header" class="auto internal xref">Figure 52</a> shows an example for this JWS Protected Header:<a href="#section-7.11.2.2-3" class="pilcrow">¶</a></p>
<span id="name-jws-protected-header-example-with"></span><div id="pstatus_header">
<figure id="figure-52">
              <div class="alignLeft art-json art-text artwork" id="section-7.11.2.2-4.1">
<pre>
{
  "alg": "ES256",
  "x5c": [
    "base64encodedvalue==",
    "base64encodedvalue=="
  ]
}
</pre>
</div>
<figcaption><a href="#figure-52" class="selfRef">Figure 52</a>:
<a href="#name-jws-protected-header-example-with" class="selfRef">JWS Protected Header Example within pStatus</a>
              </figcaption></figure>
</div>
</section>
</div>
<div id="jws-signature-8">
<section id="section-7.11.2.3">
            <h5 id="name-jws-signature-9">
<a href="#section-7.11.2.3" class="section-number selfRef">7.11.2.3. </a><a href="#name-jws-signature-9" class="section-name selfRef">JWS Signature</a>
            </h5>
<p id="section-7.11.2.3-1">The pledge <span class="bcp14">MUST</span> sign the tStatus artifact using its IDevID or domain-owner signed EE credentials according to its bootstrapping status as defined in <a href="#pstatus_data" class="auto internal xref">Section 7.11.2.1</a>.
The JWS Signature is generated over the JWS Protected Header and the JWS Payload as described in <span><a href="https://rfc-editor.org/rfc/rfc7515#section-5.1" class="relref">Section 5.1</a> of [<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.<a href="#section-7.11.2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="log_hints">
<section id="section-8">
      <h2 id="name-logging-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-logging-considerations" class="section-name selfRef">Logging Considerations</a>
      </h2>
<p id="section-8-1">The registrar <span class="bcp14">SHOULD</span> log certain events to provide an audit trail for the onboarding of pledges into its domain.
This audit trail may support the root cause analysis in case of device or system failures.
Recommend key events for logging comprise:<a href="#section-8-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-2.1">
          <p id="section-8-2.1.1">Communication attempts between the pledge, Registrar-Agent, and registrar.<a href="#section-8-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-2.2">
          <p id="section-8-2.2.1">Protocol handshakes and onboarding steps.<a href="#section-8-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-2.3">
          <p id="section-8-2.3.1">Voucher requests and responses.<a href="#section-8-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-2.4">
          <p id="section-8-2.4.1">Authentication successes or failures.<a href="#section-8-2.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-8-3">The logging <span class="bcp14">SHOULD</span> include the identity of the pledge, the identity of the Registrar-Agent that was interacting with the pledge, and relevant artifact fields, in particular telemetry information:<a href="#section-8-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-4.1">
          <p id="section-8-4.1.1">PVR received from Registrar-Agent<a href="#section-8-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-4.2">
          <p id="section-8-4.2.1">Acceptance of a pledge into the domain<a href="#section-8-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-4.3">
          <p id="section-8-4.3.1">Voucher provided to Registrar-Agent<a href="#section-8-4.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-4.4">
          <p id="section-8-4.4.1">PER received from Registrar-Agent<a href="#section-8-4.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-4.5">
          <p id="section-8-4.5.1">Pledge EE certificate requested<a href="#section-8-4.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-4.6">
          <p id="section-8-4.6.1">Pledge EE certificate received from Domain CA<a href="#section-8-4.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-4.7">
          <p id="section-8-4.7.1">Pledge EE certificate provided to Registrar-Agent<a href="#section-8-4.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-4.8">
          <p id="section-8-4.8.1">CA Certificates provided to Registrar-Agent<a href="#section-8-4.8.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-4.9">
          <p id="section-8-4.9.1">Voucher Status received from Registrar-Agent<a href="#section-8-4.9.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-4.10">
          <p id="section-8-4.10.1">Enroll Status received from Registrar-Agent<a href="#section-8-4.10.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-4.11">
          <p id="section-8-4.11.1">Pledge Status received from Registrar-Agent<a href="#section-8-4.11.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-4.12">
          <p id="section-8-4.12.1">Pledge EE certificate revoked<a href="#section-8-4.12.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-8-5">Furthermore, it is recommended to:<a href="#section-8-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-6.1">
          <p id="section-8-6.1.1">support adjustable logging levels (severity) to cater to different operational needs or failure situations.<a href="#section-8-6.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-6.2">
          <p id="section-8-6.2.1">include meta information to distinguish logs that relate to different BRSKI approaches (e.g., BRSKI, BRSKI-AE, BRSKI-PRM, constraint BRSKI) that are likely supported in the same domain in parallel.<a href="#section-8-6.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-6.3">
          <p id="section-8-6.3.1">include detailed error codes and diagnostics information as defined throughout the document or stemming from other used components or libraries also in the logging information.<a href="#section-8-6.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-6.4">
          <p id="section-8-6.4.1">support synchronized time (e.g., via NTP) to include timestamps in logging to enable sequencing and  correlation of events.<a href="#section-8-6.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-6.5">
          <p id="section-8-6.5.1">utilize standard logging formats (e.g., syslog) to allow for easy integration into log analysis tools and SIEM systems.<a href="#section-8-6.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-6.6">
          <p id="section-8-6.6.1">utilize secure transmission of logs to centralized log servers, particularly in cloud or distributed environments (e.g., in case of syslog, <span>[<a href="#RFC9662" class="cite xref">RFC9662</a>]</span> updates the utilized cipher suites for TLS and DTLS).<a href="#section-8-6.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-6.7">
          <p id="section-8-6.7.1">allow for definition of key operational thresholds (e.g., high latency, failed onboarding attempts) to trigger alerts for proactive issue resolution.<a href="#section-8-6.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-6.8">
          <p id="section-8-6.8.1">avoid inclusion of sensitive information (see also <a href="#priv_cons" class="auto internal xref">Section 11</a>)<a href="#section-8-6.8.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-8-7">For log analysis the following may be considered:<a href="#section-8-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-8.1">
          <p id="section-8-8.1.1">The registrar knows which Registrar-Agent collected which PVR from the included agent-signed-data object.<a href="#section-8-8.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-8.2">
          <p id="section-8-8.2.1">The registrar always knows the connecting Registrar-Agent from the TLS client authentication using the Registrar-Agent EE certificate and can log it accordingly.<a href="#section-8-8.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-8.3">
          <p id="section-8-8.3.1">The telemetry information from the pledge can be correlated to the voucher through the product-serial-number in the EE certificate contained in the JWS Protected Header of the status artifacts and the product-serial-number contained in the voucher. By this it can also be related to the PER.<a href="#section-8-8.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-8-9">With this, it can for instance be analyzed if multiple Registrar-Agents are involved in bootstrapping devices.
In addition, within the domain it can be analyzed, if the onboarding involved different Registrar-Agents or if different registrars have been used.<a href="#section-8-9" class="pilcrow">¶</a></p>
<p id="section-8-10">In order to protect the registrar from overload attacks, a rate-limiting may be used by logging events from the same type just once.<a href="#section-8-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="op_cons">
<section id="section-9">
      <h2 id="name-operational-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-operational-considerations" class="section-name selfRef">Operational Considerations</a>
      </h2>
<p id="section-9-1">As outlined in <a href="#architecture" class="auto internal xref">Section 5</a>, BRSKI-PRM introduces an additional component with the Registrar-Agent in the BRSKI architecture in addition to new modes of interaction to facilitate the communication between the pledge and the registrar. 
As outlined in <a href="#colo-regagt" class="auto internal xref">Section 5.3</a> the functional support of BRSKI-PRM can also be achieved using a Registrar-Agent co-located with the Registrar instead of a stand-alone Registrar-Agent, which may reduce operational complexity.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">This has an influence on the configuration and operation not only of the Registrar-Agent, but also for the registrar and the pledge.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">As outlined in <a href="#system-components" class="auto internal xref">Section 6</a>, there are additional configuration items dues to the introduction of the Registrar-Agent. This may increase operational complexity and potential misconfigurations in deploying and managing this entity:<a href="#section-9-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-4.1">
          <p id="section-9-4.1.1">A Registrar-Agent needs to be provided with a Registrar-Agent EE certificate, the domain registrar EE certificate and the list of pledges. BRSKI-PRM is open regarding the selected provisioning method, which may be automated or by configuration.<a href="#section-9-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-9-4.2">
          <p id="section-9-4.2.1">Pledges may support either BRSKI-PRM only or combined with other modes of operation.<a href="#section-9-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-9-4.3">
          <p id="section-9-4.3.1">Registrars may support either BRSKI-PRM only or combined with other BRSKI modes of operation. The distinction of BRSKI and BRSKI-PRM is done based on the provided endpoints of the registrar. An operator deploying pledges with a mixed set of operation need to ensure that the domain registrar supports all necessary options to ensure bootstrapping of pledges depending of the supported operational mode.<a href="#section-9-4.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-9-4.4">
          <p id="section-9-4.4.1">In addition, registrars may  support a co-located Registrar-Agent, if nomadic operation of the Registrar-Agent is not required. This facilitates situations in which an operator wants to deploy BRSKI pledges acting as clients and BSKI pledges acting as servers.<a href="#section-9-4.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-9-5">With the Registrar-Agent enhancement a new component is introduced in the communication path between the pledge and the registrar. 
This likely increases the latency of the communication between the pledge and the registrar.
The increase in latency due to this additional component may be neglected given that the Registrar-Agent operates with nomadic connectivity as outlined in <a href="#arch_nomadic" class="auto internal xref">Section 5.2</a>.<a href="#section-9-5" class="pilcrow">¶</a></p>
<p id="section-9-6">BRSKI-PRM requires pledges to possess an IDevID to enable onboarding in new domains. 
IDevID (and corresponding trust anchors) are expected to have a rather long lifetime. 
This may allow for a longer period between device acquisition and initial onboarding. 
Contrary, if devices that have been provided with an LDevID (and corresponding trust anchors) and temporarily taken out of service, immediate connectivity when bringing them back to operation may not be given, as the LDevIDs typically have a much shorter validity period compared to IDevIDs. 
It is therefore recommended to onboard them as new devices to ensure they possess valid LDevIDs.<a href="#section-9-6" class="pilcrow">¶</a></p>
<p id="section-9-7">The key infrastructure as part of the customer domain discussed in <a href="#architecture" class="auto internal xref">Section 5</a> may be operated locally by the operator of that domain or may be provided as a third party service.<a href="#section-9-7" class="pilcrow">¶</a></p>
<p id="section-9-8">Requirements to the utilized credentials authenticating and artifact signatures on the registrar as outlined in <a href="#registrar_component" class="auto internal xref">Section 6.3</a> may have operational implications when the registrar is part of a scalable framework as described in <span><a href="https://datatracker.ietf.org/doc/html/draft-richardson-anima-registrar-considerations-09#section-1.3.1" class="relref">Section 1.3.1</a> of [<a href="#I-D.richardson-anima-registrar-considerations" class="cite xref">I-D.richardson-anima-registrar-considerations</a>]</span>.<a href="#section-9-8" class="pilcrow">¶</a></p>
<p id="section-9-9">Besides the above, also consider the existing documents on operational modes for<a href="#section-9-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-10.1">
          <p id="section-9-10.1.1">BRSKI registrars in <span>[<a href="#I-D.richardson-anima-registrar-considerations" class="cite xref">I-D.richardson-anima-registrar-considerations</a>]</span><a href="#section-9-10.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-9-10.2">
          <p id="section-9-10.2.1">BRSKI MASA in <span>[<a href="#I-D.richardson-anima-masa-considerations" class="cite xref">I-D.richardson-anima-masa-considerations</a>]</span><a href="#section-9-10.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="iana_con">
<section id="section-10">
      <h2 id="name-iana-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-10-1">This document requires the following IANA actions.<a href="#section-10-1" class="pilcrow">¶</a></p>
<div id="brski-well-known-uris">
<section id="section-10.1">
        <h3 id="name-brski-well-known-uris">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-brski-well-known-uris" class="section-name selfRef">BRSKI Well-Known URIs</a>
        </h3>
<p id="section-10.1-1">IANA is requested to enhance the Registry entitled: "BRSKI Well-Known URIs" with the following endpoints:<a href="#section-10.1-1" class="pilcrow">¶</a></p>
<span id="name-brski-well-known-uris-addit"></span><div id="iana_table_uri">
<table class="center" id="table-3">
          <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-brski-well-known-uris-addit" class="selfRef">BRSKI Well-Known URIs Additions</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Path Segment</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">requestenroll</td>
              <td class="text-left" rowspan="1" colspan="1">Supply PER to registrar</td>
              <td class="text-left" rowspan="1" colspan="1">[THISRFC]</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">wrappedcacerts</td>
              <td class="text-left" rowspan="1" colspan="1">Obtain wrapped CA certificates</td>
              <td class="text-left" rowspan="1" colspan="1">[THISRFC]</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">tpvr</td>
              <td class="text-left" rowspan="1" colspan="1">Trigger Pledge Voucher-Request</td>
              <td class="text-left" rowspan="1" colspan="1">[THISRFC]</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">tper</td>
              <td class="text-left" rowspan="1" colspan="1">Trigger Pledge Enroll-Request</td>
              <td class="text-left" rowspan="1" colspan="1">[THISRFC]</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">svr</td>
              <td class="text-left" rowspan="1" colspan="1">Supply voucher to pledge</td>
              <td class="text-left" rowspan="1" colspan="1">[THISRFC]</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">scac</td>
              <td class="text-left" rowspan="1" colspan="1">Supply CA certificates to pledge</td>
              <td class="text-left" rowspan="1" colspan="1">[THISRFC]</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ser</td>
              <td class="text-left" rowspan="1" colspan="1">Supply Enroll-Response to pledge</td>
              <td class="text-left" rowspan="1" colspan="1">[THISRFC]</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">qps</td>
              <td class="text-left" rowspan="1" colspan="1">Query pledge status</td>
              <td class="text-left" rowspan="1" colspan="1">[THISRFC]</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="sn_reg">
<section id="section-10.2">
        <h3 id="name-service-name-and-transport-">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-service-name-and-transport-" class="section-name selfRef">Service Name and Transport Protocol Port Number Registry</a>
        </h3>
<p id="section-10.2-1">IANA has registered the following service names:<a href="#section-10.2-1" class="pilcrow">¶</a></p>
<p id="section-10.2-2"><strong>Service Name:</strong> brski-pledge<br>
          <strong>Transport Protocol(s):</strong> tcp<br>
          <strong>Assignee:</strong> IESG <a href="mailto:iesg@ietf.org">iesg@ietf.org</a><br>
          <strong>Contact:</strong> IETF Chair <a href="mailto:chair@ietf.org">chair@ietf.org</a><br>
          <strong>Description:</strong> The Bootstrapping Remote Secure Key Infrastructure Pledge<br>
          <strong>Reference:</strong> [THISRFC]<a href="#section-10.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="priv_cons">
<section id="section-11">
      <h2 id="name-privacy-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-11-1">In general, the privacy considerations of <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span> apply for BRSKI-PRM also.
Further privacy aspects need to be considered for:<a href="#section-11-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11-2.1">
          <p id="section-11-2.1.1">the introduction of the additional component Registrar-Agent<a href="#section-11-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-11-2.2">
          <p id="section-11-2.2.1">potentially no transport layer security between Registrar-Agent and pledge<a href="#section-11-2.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-11-3"><a href="#tpvr" class="auto internal xref">Section 7.1</a> describes to optionally apply TLS to protect the communication between the Registrar-Agent and the pledge.
The following is therefore applicable to the communication without the TLS protection.<a href="#section-11-3" class="pilcrow">¶</a></p>
<p id="section-11-4">The credentials used by the Registrar-Agent to sign the data for the pledge <span class="bcp14">SHOULD NOT</span> contain any personal information.
Therefore, it is recommended to use an EE certificate associated with the commissioning device instead of an EE certificate associated with the service technician operating the device.
This avoids revealing potentially included personal information to Registrar and MASA.<a href="#section-11-4" class="pilcrow">¶</a></p>
<p id="section-11-5">As logging is recommended to better handle failure situations, it is necessary to avoid capturing  sensitive or personal data.
Privacy-preserving measures in logs <span class="bcp14">SHOULD</span> be applied, such as:
* Avoid logging personally identifiable information unless unavoidable.
* Anonymize or pseudonymize data where possible.<a href="#section-11-5" class="pilcrow">¶</a></p>
<p id="section-11-6">The communication between the pledge and the Registrar-Agent is performed over plain HTTP.
Therefore, it is subject to disclosure by a Dolev-Yao attacker (an "oppressive observer")<span>[<a href="#onpath" class="cite xref">onpath</a>]</span>.
Depending on the requests and responses, the following information is disclosed.<a href="#section-11-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11-7.1">
          <p id="section-11-7.1.1">the Pledge product-serial-number is contained in the trigger message for the PVR and in all responses from the pledge.
This information reveals the identity of the devices being bootstrapped and allows deduction of which products an operator is using in their environment.
As the communication between the pledge and the Registrar-Agent may be realized over wireless link, this information could easily be eavesdropped, if the wireless network is not encrypted.
Even if the wireless network is encrypted, if it uses a network-wide key, then layer-2 attacks (ARP/ND spoofing) could insert an on-path observer into the path.<a href="#section-11-7.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-11-7.2">
          <p id="section-11-7.2.1">the Timestamp data could reveal the activation time of the device.<a href="#section-11-7.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-11-7.3">
          <p id="section-11-7.3.1">the Status data of the device could reveal information about the current state of the device in the domain network.<a href="#section-11-7.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="sec_cons">
<section id="section-12">
      <h2 id="name-security-considerations">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-12-1">In general, the security considerations of <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span> apply for BRSKI-PRM also.
Further security aspects are considered here related to:<a href="#section-12-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12-2.1">
          <p id="section-12-2.1.1">the introduction of the additional component Registrar-Agent<a href="#section-12-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-12-2.2">
          <p id="section-12-2.2.1">the reversal of the pledge communication direction (push mode, compared to BRSKI)<a href="#section-12-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-12-2.3">
          <p id="section-12-2.3.1">no transport layer security between Registrar-Agent and pledge<a href="#section-12-2.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="sec_cons-dos">
<section id="section-12.1">
        <h3 id="name-denial-of-service-dos-attac">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-denial-of-service-dos-attac" class="section-name selfRef">Denial of Service (DoS) Attack on Pledge</a>
        </h3>
<p id="section-12.1-1">Disrupting the pledge behavior by a DoS attack may prevent the bootstrapping of the pledge to a new domain.
Because in BRSKI-PRM the pledge responds to requests from real or illicit Registrar-Agents, pledges are more subject to DoS-attacks from Registrar-Agents in BRSKI-PRM than they are from illicit registrars in <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>, where pledges do initiate the connections.<a href="#section-12.1-1" class="pilcrow">¶</a></p>
<p id="section-12.1-2">A DoS attack with a faked Registrar-Agent may block the bootstrapping of the pledge due changing state on the pledge (the pledge may produce a voucher-request, and refuse to produce another one).
One mitigation may be that the pledge does not limit the number of voucher-requests it creates until at least one has finished.
An alternative may be that the onboarding state may expire after a certain time, if no further interaction has happened.<a href="#section-12.1-2" class="pilcrow">¶</a></p>
<p id="section-12.1-3">In addition, the pledge may assume that repeated triggering for PVR are the result of a communication error with the Registrar-Agent.
In that case the pledge <span class="bcp14">MAY</span> simply resend the PVR previously sent.
Note that in case of re-sending, a contained nonce and also the contained agent-signed-data in the PVR would consequently be reused.<a href="#section-12.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="misuse-of-acquired-pvr-and-per-by-registrar-agent">
<section id="section-12.2">
        <h3 id="name-misuse-of-acquired-pvr-and-">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-misuse-of-acquired-pvr-and-" class="section-name selfRef">Misuse of acquired PVR and PER by Registrar-Agent</a>
        </h3>
<p id="section-12.2-1">A Registrar-Agent that uses previously requested PVR and PER for domain-A, may attempt to onboard the device into domain-B.  This can be detected by the domain registrar while PVR processing.
The domain registrar needs to verify that the <code>proximity-registrar-cert</code> field in the PVR matches its own registrar EE certificate.
In addition, the domain registrar needs to verify the association of the pledge to its domain based on the product-serial-number contained in the PVR and in the pledge IDevID certificate. (This is just part of the supply chain integration).
Moreover, the domain registrar verifies if the Registrar-Agent is authorized to interact with the pledge for voucher-requests and enroll-requests, based on the Registrar-Agent EE certificate data contained in the PVR.<a href="#section-12.2-1" class="pilcrow">¶</a></p>
<p id="section-12.2-2">Mis-binding of a pledge by a faked domain registrar is countered as described in BRSKI security considerations <span><a href="https://rfc-editor.org/rfc/rfc8995#section-11.4" class="relref">Section 11.4</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>.<a href="#section-12.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec_cons_reg-agt">
<section id="section-12.3">
        <h3 id="name-misuse-of-registrar-agent">
<a href="#section-12.3" class="section-number selfRef">12.3. </a><a href="#name-misuse-of-registrar-agent" class="section-name selfRef">Misuse of Registrar-Agent</a>
        </h3>
<p id="section-12.3-1">Concerns of misuse of a Registrar-Agent with a valid Registrar-Agent EE certificate may be addressed by utilizing short-lived certificates (e.g., valid for a day) to authenticate the Registrar-Agent against the domain registrar.
The Registrar-Agent EE certificate may have been acquired by a prior BRSKI run for the Registrar-Agent, if an IDevID is available on Registrar-Agent.
Alternatively, the Registrar-Agent EE certificate may be acquired by a service technician from the domain PKI system in an authenticated way.<a href="#section-12.3-1" class="pilcrow">¶</a></p>
<p id="section-12.3-2">In addition, it is required that the Registrar-Agent EE certificate is valid for the complete bootstrapping phase.
This avoids that a Registrar-Agent could be misused to create arbitrary "agent-signed-data" objects to perform an authorized bootstrapping of a rogue pledge at a later point in time.
In this misuse "agent-signed-data" could be dated after the validity time of the Registrar-Agent EE certificate, due to missing trusted timestamp in the Registrar-Agents signature.
To address this, the registrar <span class="bcp14">SHOULD</span> verify the certificate used to create the signature on "agent-signed-data".<a href="#section-12.3-2" class="pilcrow">¶</a></p>
<p id="section-12.3-3">Furthermore, the registrar also verifies the Registrar-Agent EE certificate used in the TLS handshake with the Registrar-Agent. 
If both certificates are verified successfully, the Registrar-Agent's signature can be considered as valid.
If the registrar detects a mismatch in the utilized certificates, it may conclude the usage of either an outdated "agent-signed-data" component in the PVR or a man-in-the-middle attack by a potentially unauthorized Registrar-Agent.<a href="#section-12.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec_cons_mDNS">
<section id="section-12.4">
        <h3 id="name-misuse-of-dns-sd-with-mdns-">
<a href="#section-12.4" class="section-number selfRef">12.4. </a><a href="#name-misuse-of-dns-sd-with-mdns-" class="section-name selfRef">Misuse of DNS-SD with mDNS to obtain list of pledges</a>
        </h3>
<p id="section-12.4-1">To discover a specific pledge a Registrar-Agent may query the Service Type in combination with the product-serial-number of a specific pledge, e.g., in the Service Instance Name or Service Subtype.
The pledge reacts on this if its product-serial-number is part of the query message.<a href="#section-12.4-1" class="pilcrow">¶</a></p>
<p id="section-12.4-2">If the Registrar-Agent performs DNS-based Service Discovery without a specific product-serial-number, all pledges in the domain react if the functionality is supported.
This functionality enumerates and reveals the information of devices available in the domain.
The information about this is provided here as a feature to support the commissioning of devices.
A manufacturer may decide to support this feature only for devices not possessing an LDevID or to not support this feature at all, to avoid an enumeration in an operative domain.<a href="#section-12.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="yang-module-security-considerations">
<section id="section-12.5">
        <h3 id="name-yang-module-security-consid">
<a href="#section-12.5" class="section-number selfRef">12.5. </a><a href="#name-yang-module-security-consid" class="section-name selfRef">YANG Module Security Considerations</a>
        </h3>
<p id="section-12.5-1">The enhanced voucher-request described in <span>[<a href="#I-D.ietf-anima-rfc8366bis" class="cite xref">I-D.ietf-anima-rfc8366bis</a>]</span> is based on <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>, but uses a different encoding based on <span>[<a href="#I-D.ietf-anima-jws-voucher" class="cite xref">I-D.ietf-anima-jws-voucher</a>]</span>.
The security considerations as described in <span><a href="https://rfc-editor.org/rfc/rfc8995#section-11.7" class="relref">Section 11.7</a> of [<a href="#RFC8995" class="cite xref">RFC8995</a>]</span> (Security Considerations) apply.<a href="#section-12.5-1" class="pilcrow">¶</a></p>
<p id="section-12.5-2">The YANG module specified in <span>[<a href="#I-D.ietf-anima-rfc8366bis" class="cite xref">I-D.ietf-anima-rfc8366bis</a>]</span> defines the schema for data that is subsequently encapsulated by a JOSE signed-data Content-type as described in <span>[<a href="#I-D.ietf-anima-jws-voucher" class="cite xref">I-D.ietf-anima-jws-voucher</a>]</span>.
As such, all of the YANG-modeled data is protected against modification.<a href="#section-12.5-2" class="pilcrow">¶</a></p>
<p id="section-12.5-3">Documents that define exclusively modules following the extension in <span>[<a href="#RFC8971" class="cite xref">RFC8971</a>]</span> are not required to include the security template in Section 3.7.1.  Likewise, following the template is not required for modules that define YANG extensions such as <span>[<a href="#RFC7952" class="cite xref">RFC7952</a>]</span>.<a href="#section-12.5-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="section-13">
      <h2 id="name-acknowledgments">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-13-1">We would like to thank the various reviewers, in particular Brian E. Carpenter, Charlie Kaufman (Early SECDIR review), Martin Björklund (Early YANGDOCTORS review), Marco Tiloca (Early IOTDIR review), Oskar Camenzind, Hendrik Brockhaus, and Ingo Wenda for their input and discussion on use cases and call flows.
Further review input was provided by Jesser Bouzid, Dominik Tacke, Christian Spindler, and Julian Krieger.
Special thanks to Esko Dijk for the in deep review and the improving proposals.
Another special thanks for the detailed Shepherad review and connected discussions to Matthias Kovatsch.
Support in PoC implementations and comments resulting from the implementation was provided by Hong Rui Li and He Peng Jia.
Review comments in the context of a formal analysis of BRSKI-PRM have been provided by Marco Calipari.<a href="#section-13-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-combined-references">
<section id="section-14">
      <h2 id="name-references">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-14.1">
        <h3 id="name-normative-references">
<a href="#section-14.1" class="section-number selfRef">14.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-anima-jws-voucher">[I-D.ietf-anima-jws-voucher]</dt>
        <dd>
<span class="refAuthor">Werner, T.</span> and <span class="refAuthor">M. Richardson</span>, <span class="refTitle">"JWS signed Voucher Artifacts for Bootstrapping Protocols"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-anima-jws-voucher-16</span>, <time datetime="2025-01-15" class="refDate">15 January 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-anima-jws-voucher-16">https://datatracker.ietf.org/doc/html/draft-ietf-anima-jws-voucher-16</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-anima-rfc8366bis">[I-D.ietf-anima-rfc8366bis]</dt>
        <dd>
<span class="refAuthor">Watsen, K.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Pritikin, M.</span>, <span class="refAuthor">Eckert, T. T.</span>, and <span class="refAuthor">Q. Ma</span>, <span class="refTitle">"A Voucher Artifact for Bootstrapping Protocols"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-anima-rfc8366bis-14</span>, <time datetime="2025-04-01" class="refDate">1 April 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-anima-rfc8366bis-14">https://datatracker.ietf.org/doc/html/draft-ietf-anima-rfc8366bis-14</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3339">[RFC3339]</dt>
        <dd>
<span class="refAuthor">Klyne, G.</span> and <span class="refAuthor">C. Newman</span>, <span class="refTitle">"Date and Time on the Internet: Timestamps"</span>, <span class="seriesInfo">RFC 3339</span>, <span class="seriesInfo">DOI 10.17487/RFC3339</span>, <time datetime="2002-07" class="refDate">July 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3339">https://www.rfc-editor.org/rfc/rfc3339</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5272">[RFC5272]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span> and <span class="refAuthor">M. Myers</span>, <span class="refTitle">"Certificate Management over CMS (CMC)"</span>, <span class="seriesInfo">RFC 5272</span>, <span class="seriesInfo">DOI 10.17487/RFC5272</span>, <time datetime="2008-06" class="refDate">June 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5272">https://www.rfc-editor.org/rfc/rfc5272</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6762">[RFC6762]</dt>
        <dd>
<span class="refAuthor">Cheshire, S.</span> and <span class="refAuthor">M. Krochmal</span>, <span class="refTitle">"Multicast DNS"</span>, <span class="seriesInfo">RFC 6762</span>, <span class="seriesInfo">DOI 10.17487/RFC6762</span>, <time datetime="2013-02" class="refDate">February 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6762">https://www.rfc-editor.org/rfc/rfc6762</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6763">[RFC6763]</dt>
        <dd>
<span class="refAuthor">Cheshire, S.</span> and <span class="refAuthor">M. Krochmal</span>, <span class="refTitle">"DNS-Based Service Discovery"</span>, <span class="seriesInfo">RFC 6763</span>, <span class="seriesInfo">DOI 10.17487/RFC6763</span>, <time datetime="2013-02" class="refDate">February 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6763">https://www.rfc-editor.org/rfc/rfc6763</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7030">[RFC7030]</dt>
        <dd>
<span class="refAuthor">Pritikin, M., Ed.</span>, <span class="refAuthor">Yee, P., Ed.</span>, and <span class="refAuthor">D. Harkins, Ed.</span>, <span class="refTitle">"Enrollment over Secure Transport"</span>, <span class="seriesInfo">RFC 7030</span>, <span class="seriesInfo">DOI 10.17487/RFC7030</span>, <time datetime="2013-10" class="refDate">October 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7030">https://www.rfc-editor.org/rfc/rfc7030</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7515">[RFC7515]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Signature (JWS)"</span>, <span class="seriesInfo">RFC 7515</span>, <span class="seriesInfo">DOI 10.17487/RFC7515</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7515">https://www.rfc-editor.org/rfc/rfc7515</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7951">[RFC7951]</dt>
        <dd>
<span class="refAuthor">Lhotka, L.</span>, <span class="refTitle">"JSON Encoding of Data Modeled with YANG"</span>, <span class="seriesInfo">RFC 7951</span>, <span class="seriesInfo">DOI 10.17487/RFC7951</span>, <time datetime="2016-08" class="refDate">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7951">https://www.rfc-editor.org/rfc/rfc7951</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8259">[RFC8259]</dt>
        <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">STD 90</span>, <span class="seriesInfo">RFC 8259</span>, <span class="seriesInfo">DOI 10.17487/RFC8259</span>, <time datetime="2017-12" class="refDate">December 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8259">https://www.rfc-editor.org/rfc/rfc8259</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8610">[RFC8610]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Vigano, C.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures"</span>, <span class="seriesInfo">RFC 8610</span>, <span class="seriesInfo">DOI 10.17487/RFC8610</span>, <time datetime="2019-06" class="refDate">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8610">https://www.rfc-editor.org/rfc/rfc8610</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8615">[RFC8615]</dt>
        <dd>
<span class="refAuthor">Nottingham, M.</span>, <span class="refTitle">"Well-Known Uniform Resource Identifiers (URIs)"</span>, <span class="seriesInfo">RFC 8615</span>, <span class="seriesInfo">DOI 10.17487/RFC8615</span>, <time datetime="2019-05" class="refDate">May 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8615">https://www.rfc-editor.org/rfc/rfc8615</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8995">[RFC8995]</dt>
        <dd>
<span class="refAuthor">Pritikin, M.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Eckert, T.</span>, <span class="refAuthor">Behringer, M.</span>, and <span class="refAuthor">K. Watsen</span>, <span class="refTitle">"Bootstrapping Remote Secure Key Infrastructure (BRSKI)"</span>, <span class="seriesInfo">RFC 8995</span>, <span class="seriesInfo">DOI 10.17487/RFC8995</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8995">https://www.rfc-editor.org/rfc/rfc8995</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9360">[RFC9360]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Header Parameters for Carrying and Referencing X.509 Certificates"</span>, <span class="seriesInfo">RFC 9360</span>, <span class="seriesInfo">DOI 10.17487/RFC9360</span>, <time datetime="2023-02" class="refDate">February 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9360">https://www.rfc-editor.org/rfc/rfc9360</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9646">[RFC9646]</dt>
      <dd>
<span class="refAuthor">Watsen, K.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Conveying a Certificate Signing Request (CSR) in a Secure Zero-Touch Provisioning (SZTP) Bootstrapping Request"</span>, <span class="seriesInfo">RFC 9646</span>, <span class="seriesInfo">DOI 10.17487/RFC9646</span>, <time datetime="2024-10" class="refDate">October 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9646">https://www.rfc-editor.org/rfc/rfc9646</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-14.2">
        <h3 id="name-informative-references">
<a href="#section-14.2" class="section-number selfRef">14.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="androidnsd">[androidnsd]</dt>
        <dd>
<span class="refTitle">"Android Developer: Connect devices wirelessly"</span>, <span class="seriesInfo">archived at https://web.archive.org/web/20230000000000*/https://developer.android.com/training/connect-devices-wirelessly</span>, <span>n.d.</span>, <span>&lt;<a href="https://developer.android.com/training/connect-devices-wirelessly">https://developer.android.com/training/connect-devices-wirelessly</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="androidtrustfail">[androidtrustfail]</dt>
        <dd>
<span class="refTitle">"Security with Network Protocols"</span>, <span class="seriesInfo">archived at https://web.archive.org/web/20230326153937/https://developer.android.com/training/articles/security-ssl</span>, <span>n.d.</span>, <span>&lt;<a href="https://developer.android.com/training/articles/security-ssl">https://developer.android.com/training/articles/security-ssl</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="BRSKI-PRM-abstract">[BRSKI-PRM-abstract]</dt>
        <dd>
<span class="refTitle">"Abstract BRSKI-PRM Protocol Overview"</span>, <time datetime="2022-03" class="refDate">March 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/meeting/113/materials/slides-113-anima-update-on-brski-with-pledge-in-responder-mode-brski-prm-00">https://datatracker.ietf.org/meeting/113/materials/slides-113-anima-update-on-brski-with-pledge-in-responder-mode-brski-prm-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.draft-ietf-emu-eap-arpa">[I-D.draft-ietf-emu-eap-arpa]</dt>
        <dd>
<span class="refAuthor">DeKok, A.</span>, <span class="refTitle">"The eap.arpa domain and EAP provisioning"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-emu-eap-arpa-06</span>, <time datetime="2025-01-29" class="refDate">29 January 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-emu-eap-arpa-06">https://datatracker.ietf.org/doc/html/draft-ietf-emu-eap-arpa-06</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-anima-brski-discovery">[I-D.ietf-anima-brski-discovery]</dt>
        <dd>
<span class="refAuthor">Eckert, T. T.</span> and <span class="refAuthor">E. Dijk</span>, <span class="refTitle">"BRSKI discovery and variations"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-anima-brski-discovery-05</span>, <time datetime="2024-10-21" class="refDate">21 October 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-anima-brski-discovery-05">https://datatracker.ietf.org/doc/html/draft-ietf-anima-brski-discovery-05</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-uta-require-tls13">[I-D.ietf-uta-require-tls13]</dt>
        <dd>
<span class="refAuthor">Salz, R.</span> and <span class="refAuthor">N. Aviram</span>, <span class="refTitle">"New Protocols Must Require TLS 1.3"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-uta-require-tls13-10</span>, <time datetime="2025-03-27" class="refDate">27 March 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-uta-require-tls13-10">https://datatracker.ietf.org/doc/html/draft-ietf-uta-require-tls13-10</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.irtf-t2trg-taxonomy-manufacturer-anchors">[I-D.irtf-t2trg-taxonomy-manufacturer-anchors]</dt>
        <dd>
<span class="refAuthor">Richardson, M.</span>, <span class="refTitle">"A Taxonomy of operational security considerations for manufacturer installed keys and Trust Anchors"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-t2trg-taxonomy-manufacturer-anchors-07</span>, <time datetime="2025-03-29" class="refDate">29 March 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-irtf-t2trg-taxonomy-manufacturer-anchors-07">https://datatracker.ietf.org/doc/html/draft-irtf-t2trg-taxonomy-manufacturer-anchors-07</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.richardson-anima-masa-considerations">[I-D.richardson-anima-masa-considerations]</dt>
        <dd>
<span class="refAuthor">Richardson, M.</span> and <span class="refAuthor">W. Pan</span>, <span class="refTitle">"Operational Considerations for Voucher infrastructure for BRSKI MASA"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-richardson-anima-masa-considerations-09</span>, <time datetime="2025-01-22" class="refDate">22 January 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-richardson-anima-masa-considerations-09">https://datatracker.ietf.org/doc/html/draft-richardson-anima-masa-considerations-09</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.richardson-anima-registrar-considerations">[I-D.richardson-anima-registrar-considerations]</dt>
        <dd>
<span class="refAuthor">Richardson, M.</span> and <span class="refAuthor">W. Pan</span>, <span class="refTitle">"Operational Considerations for BRSKI Registrar"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-richardson-anima-registrar-considerations-09</span>, <time datetime="2025-01-22" class="refDate">22 January 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-richardson-anima-registrar-considerations-09">https://datatracker.ietf.org/doc/html/draft-richardson-anima-registrar-considerations-09</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IEEE-802.1AR">[IEEE-802.1AR]</dt>
        <dd>
<span class="refAuthor">Institute of Electrical and Electronics Engineers</span>, <span class="refTitle">"IEEE 802.1AR Secure Device Identifier"</span>, <span class="seriesInfo">IEEE 802.1AR</span>, <time datetime="2018-06" class="refDate">June 2018</time>. </dd>
<dd class="break"></dd>
<dt id="onpath">[onpath]</dt>
        <dd>
<span class="refTitle">"can an on-path attacker drop traffic?"</span>, <span>n.d.</span>, <span>&lt;<a href="https://mailarchive.ietf.org/arch/msg/saag/m1r9uo4xYznOcf85Eyk0Rhut598/">https://mailarchive.ietf.org/arch/msg/saag/m1r9uo4xYznOcf85Eyk0Rhut598/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2986">[RFC2986]</dt>
        <dd>
<span class="refAuthor">Nystrom, M.</span> and <span class="refAuthor">B. Kaliski</span>, <span class="refTitle">"PKCS #10: Certification Request Syntax Specification Version 1.7"</span>, <span class="seriesInfo">RFC 2986</span>, <span class="seriesInfo">DOI 10.17487/RFC2986</span>, <time datetime="2000-11" class="refDate">November 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2986">https://www.rfc-editor.org/rfc/rfc2986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3629">[RFC3629]</dt>
        <dd>
<span class="refAuthor">Yergeau, F.</span>, <span class="refTitle">"UTF-8, a transformation format of ISO 10646"</span>, <span class="seriesInfo">STD 63</span>, <span class="seriesInfo">RFC 3629</span>, <span class="seriesInfo">DOI 10.17487/RFC3629</span>, <time datetime="2003-11" class="refDate">November 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3629">https://www.rfc-editor.org/rfc/rfc3629</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4648">[RFC4648]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span>, <span class="refTitle">"The Base16, Base32, and Base64 Data Encodings"</span>, <span class="seriesInfo">RFC 4648</span>, <span class="seriesInfo">DOI 10.17487/RFC4648</span>, <time datetime="2006-10" class="refDate">October 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4648">https://www.rfc-editor.org/rfc/rfc4648</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6241">[RFC6241]</dt>
        <dd>
<span class="refAuthor">Enns, R., Ed.</span>, <span class="refAuthor">Bjorklund, M., Ed.</span>, <span class="refAuthor">Schoenwaelder, J., Ed.</span>, and <span class="refAuthor">A. Bierman, Ed.</span>, <span class="refTitle">"Network Configuration Protocol (NETCONF)"</span>, <span class="seriesInfo">RFC 6241</span>, <span class="seriesInfo">DOI 10.17487/RFC6241</span>, <time datetime="2011-06" class="refDate">June 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6241">https://www.rfc-editor.org/rfc/rfc6241</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7252">[RFC7252]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7252">https://www.rfc-editor.org/rfc/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7952">[RFC7952]</dt>
        <dd>
<span class="refAuthor">Lhotka, L.</span>, <span class="refTitle">"Defining and Using Metadata with YANG"</span>, <span class="seriesInfo">RFC 7952</span>, <span class="seriesInfo">DOI 10.17487/RFC7952</span>, <time datetime="2016-08" class="refDate">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7952">https://www.rfc-editor.org/rfc/rfc7952</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8040">[RFC8040]</dt>
        <dd>
<span class="refAuthor">Bierman, A.</span>, <span class="refAuthor">Bjorklund, M.</span>, and <span class="refAuthor">K. Watsen</span>, <span class="refTitle">"RESTCONF Protocol"</span>, <span class="seriesInfo">RFC 8040</span>, <span class="seriesInfo">DOI 10.17487/RFC8040</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8040">https://www.rfc-editor.org/rfc/rfc8040</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8407">[RFC8407]</dt>
        <dd>
<span class="refAuthor">Bierman, A.</span>, <span class="refTitle">"Guidelines for Authors and Reviewers of Documents Containing YANG Data Models"</span>, <span class="seriesInfo">BCP 216</span>, <span class="seriesInfo">RFC 8407</span>, <span class="seriesInfo">DOI 10.17487/RFC8407</span>, <time datetime="2018-10" class="refDate">October 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8407">https://www.rfc-editor.org/rfc/rfc8407</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8792">[RFC8792]</dt>
        <dd>
<span class="refAuthor">Watsen, K.</span>, <span class="refAuthor">Auerswald, E.</span>, <span class="refAuthor">Farrel, A.</span>, and <span class="refAuthor">Q. Wu</span>, <span class="refTitle">"Handling Long Lines in Content of Internet-Drafts and RFCs"</span>, <span class="seriesInfo">RFC 8792</span>, <span class="seriesInfo">DOI 10.17487/RFC8792</span>, <time datetime="2020-06" class="refDate">June 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8792">https://www.rfc-editor.org/rfc/rfc8792</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8971">[RFC8971]</dt>
        <dd>
<span class="refAuthor">Pallagatti, S., Ed.</span>, <span class="refAuthor">Mirsky, G., Ed.</span>, <span class="refAuthor">Paragiri, S.</span>, <span class="refAuthor">Govindan, V.</span>, and <span class="refAuthor">M. Mudigonda</span>, <span class="refTitle">"Bidirectional Forwarding Detection (BFD) for Virtual eXtensible Local Area Network (VXLAN)"</span>, <span class="seriesInfo">RFC 8971</span>, <span class="seriesInfo">DOI 10.17487/RFC8971</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8971">https://www.rfc-editor.org/rfc/rfc8971</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8990">[RFC8990]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refAuthor">Carpenter, B., Ed.</span>, and <span class="refAuthor">B. Liu, Ed.</span>, <span class="refTitle">"GeneRic Autonomic Signaling Protocol (GRASP)"</span>, <span class="seriesInfo">RFC 8990</span>, <span class="seriesInfo">DOI 10.17487/RFC8990</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8990">https://www.rfc-editor.org/rfc/rfc8990</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9052">[RFC9052]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Structures and Process"</span>, <span class="seriesInfo">STD 96</span>, <span class="seriesInfo">RFC 9052</span>, <span class="seriesInfo">DOI 10.17487/RFC9052</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9052">https://www.rfc-editor.org/rfc/rfc9052</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9110">[RFC9110]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span>, <span class="refAuthor">Nottingham, M., Ed.</span>, and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"HTTP Semantics"</span>, <span class="seriesInfo">STD 97</span>, <span class="seriesInfo">RFC 9110</span>, <span class="seriesInfo">DOI 10.17487/RFC9110</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9110">https://www.rfc-editor.org/rfc/rfc9110</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9238">[RFC9238]</dt>
        <dd>
<span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Latour, J.</span>, and <span class="refAuthor">H. Habibi Gharakheili</span>, <span class="refTitle">"Loading Manufacturer Usage Description (MUD) URLs from QR Codes"</span>, <span class="seriesInfo">RFC 9238</span>, <span class="seriesInfo">DOI 10.17487/RFC9238</span>, <time datetime="2022-05" class="refDate">May 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9238">https://www.rfc-editor.org/rfc/rfc9238</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9483">[RFC9483]</dt>
        <dd>
<span class="refAuthor">Brockhaus, H.</span>, <span class="refAuthor">von Oheimb, D.</span>, and <span class="refAuthor">S. Fries</span>, <span class="refTitle">"Lightweight Certificate Management Protocol (CMP) Profile"</span>, <span class="seriesInfo">RFC 9483</span>, <span class="seriesInfo">DOI 10.17487/RFC9483</span>, <time datetime="2023-11" class="refDate">November 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9483">https://www.rfc-editor.org/rfc/rfc9483</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9525">[RFC9525]</dt>
        <dd>
<span class="refAuthor">Saint-Andre, P.</span> and <span class="refAuthor">R. Salz</span>, <span class="refTitle">"Service Identity in TLS"</span>, <span class="seriesInfo">RFC 9525</span>, <span class="seriesInfo">DOI 10.17487/RFC9525</span>, <time datetime="2023-11" class="refDate">November 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9525">https://www.rfc-editor.org/rfc/rfc9525</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9662">[RFC9662]</dt>
        <dd>
<span class="refAuthor">Lonvick, C.</span>, <span class="refAuthor">Turner, S.</span>, and <span class="refAuthor">J. Salowey</span>, <span class="refTitle">"Updates to the Cipher Suites in Secure Syslog"</span>, <span class="seriesInfo">RFC 9662</span>, <span class="seriesInfo">DOI 10.17487/RFC9662</span>, <time datetime="2024-10" class="refDate">October 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9662">https://www.rfc-editor.org/rfc/rfc9662</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9733">[RFC9733]</dt>
      <dd>
<span class="refAuthor">von Oheimb, D., Ed.</span>, <span class="refAuthor">Fries, S.</span>, and <span class="refAuthor">H. Brockhaus</span>, <span class="refTitle">"BRSKI with Alternative Enrollment (BRSKI-AE)"</span>, <span class="seriesInfo">RFC 9733</span>, <span class="seriesInfo">DOI 10.17487/RFC9733</span>, <time datetime="2025-03" class="refDate">March 2025</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9733">https://www.rfc-editor.org/rfc/rfc9733</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="examples">
<section id="appendix-A">
      <h2 id="name-examples">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
      </h2>
<p id="appendix-A-1">These examples are folded according to <span>[<a href="#RFC8792" class="cite xref">RFC8792</a>]</span> Single Backslash rule.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div id="example-pledge-voucher-request-pvr-from-pledge-to-registrar-agent">
<section id="appendix-A.1">
        <h3 id="name-example-pledge-voucher-requ">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-example-pledge-voucher-requ" class="section-name selfRef">Example Pledge Voucher-Request (PVR) - from Pledge to Registrar-Agent</a>
        </h3>
<p id="appendix-A.1-1">The following is an example request sent from a Pledge to the Registrar-Agent, in "General JWS JSON Serialization".
The message size of this PVR is: 2973 bytes<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<span id="name-example-pledge-voucher-reque"></span><div id="ExamplePledgeVoucherRequestfigure">
<figure id="figure-53">
          <div class="alignLeft art-text artwork" id="appendix-A.1-2.1">
<pre>
=============== NOTE: '\' line wrapping per RFC 8792 ================

{
  "payload": "eyJpZXRmLXZvdWNoZXItcmVxdWVzdC1wcm06dm91Y2hlciI6eyJhc3\
NlcnRpb24iOiJhZ2VudC1wcm94aW1pdHkiLCJzZXJpYWwtbnVtYmVyIjoiMDEyMzQ1Nj\
c4OSIsIm5vbmNlIjoia2hOeUtwTXRoY2NpYTFyWHc0NC92UT09IiwiY3JlYXRlZC1vbi\
I6IjIwMjQtMDYtMjRUMDk6MDE6MjQuNTU2WiIsImFnZW50LXByb3ZpZGVkLXByb3hpbW\
l0eS1yZWdpc3RyYXItY2VydCI6Ik1JSUI0akNDQVlpZ0F3SUJBZ0lHQVhZNzJiYlpNQW\
9HQ0NxR1NNNDlCQU1DTURVeEV6QVJCZ05WQkFvTUNrMTVRblZ6YVc1bGMzTXhEVEFMQm\
dOVkJBY01CRk5wZEdVeER6QU5CZ05WQkFNTUJsUmxjM1JEUVRBZUZ3MHlNREV5TURjd0\
5qRTRNVEphRncwek1ERXlNRGN3TmpFNE1USmFNRDR4RXpBUkJnTlZCQW9NQ2sxNVFuVn\
phVzVsYzNNeERUQUxCZ05WQkFjTUJGTnBkR1V4R0RBV0JnTlZCQU1NRDBSdmJXRnBibE\
psWjJsemRISmhjakJaTUJNR0J5cUdTTTQ5QWdFR0NDcUdTTTQ5QXdFSEEwSUFCQmsxNk\
svaTc5b1JrSzVZYmVQZzhVU1I4L3VzMWRQVWlaSE10b2tTZHFLVzVmbldzQmQrcVJMN1\
dSZmZlV2t5Z2Vib0pmSWxsdXJjaTI1d25oaU9WQ0dqZXpCNU1CMEdBMVVkSlFRV01CUU\
dDQ3NHQVFVRkJ3TUJCZ2dyQmdFRkJRY0RIREFPQmdOVkhROEJBZjhFQkFNQ0I0QXdTQV\
lEVlIwUkJFRXdQNElkY21WbmFYTjBjbUZ5TFhSbGMzUXVjMmxsYldWdWN5MWlkQzV1Wl\
hTQ0huSmxaMmx6ZEhKaGNpMTBaWE4wTmk1emFXVnRaVzV6TFdKMExtNWxkREFLQmdncW\
hrak9QUVFEQWdOSUFEQkZBaUJ4bGRCaFpxMEV2NUpMMlByV0N0eVM2aERZVzF5Q08vUm\
F1YnBDN01hSURnSWhBTFNKYmdMbmdoYmJBZzBkY1dGVVZvL2dHTjAvand6SlowU2wyaD\
R4SVhrMSIsImFnZW50LXNpZ25lZC1kYXRhIjoiZXlKd1lYbHNiMkZrSWpvaVpYbEtjRn\
BZVW0xTVdGcDJaRmRPYjFwWVNYUmpiVlo0WkZkV2VtUkRNWGRqYlRBMldWZGtiR0p1VV\
hSak1teHVZbTFXYTB4WFVtaGtSMFZwVDI1emFWa3pTbXhaV0ZKc1drTXhkbUpwU1RaSm\
FrbDNUV3BKZEUxRWEzUk5ha3BWVFVSVk5rNUVUVFpPVkVGMVRWUkpNVmRwU1hOSmJrNX\
NZMjFzYUdKRE1YVmtWekZwV2xoSmFVOXBTWGROVkVsNlRrUlZNazU2WnpWSmJqRTVJaX\
dpYzJsbmJtRjBkWEpsY3lJNlczc2ljSEp2ZEdWamRHVmtJam9pWlhsS2NtRlhVV2xQYV\
VwVlZFZE5NMWRZYUV4V2JGWldaVzVLTTFKVVRsSlhWRlpEV2xaa2IyTXlNVVZOTW1NNV\
NXbDNhVmxYZUc1SmFtOXBVbFpOZVU1VVdXbG1VU0lzSW5OcFoyNWhkSFZ5WlNJNklrd3\
lZVEJsY3pWZkxXZHNZVjkwTjFVME1VbFJXRmxJU1RSQlMxVldVRkZmTTFSbGQxUTFiMF\
ZWWVVOdFVIQktaMmRyU0c1d09WTk1aVFZ1YWkxbldGbFRiMk5sT1RoeFFXSnROa0YwZF\
MxRlIxUkxZMDVSSW4xZGZRMEsifX0",
  "signatures": [
    {
      "protected": "eyJ4NWMiOlsiTUlJQitUQ0NBYUNnQXdJQkFnSUdBWG5WanNV\
NU1Bb0dDQ3FHU000OUJBTUNNRDB4Q3pBSkJnTlZCQVlUQWtGUk1SVXdFd1lEVlFRS0RB\
eEthVzVuU21sdVowTnZjbkF4RnpBVkJnTlZCQU1NRGtwcGJtZEthVzVuVkdWemRFTkJN\
Q0FYRFRJeE1EWXdOREExTkRZeE5Gb1lEems1T1RreE1qTXhNak0xT1RVNVdqQlNNUXN3\
Q1FZRFZRUUdFd0pCVVRFVk1CTUdBMVVFQ2d3TVNtbHVaMHBwYm1kRGIzSndNUk13RVFZ\
RFZRUUZFd293TVRJek5EVTJOemc1TVJjd0ZRWURWUVFEREE1S2FXNW5TbWx1WjBSbGRt\
bGpaVEJaTUJNR0J5cUdTTTQ5QWdFR0NDcUdTTTQ5QXdFSEEwSUFCQzc5bGlhUmNCalpj\
RUVYdzdyVWVhdnRHSkF1SDRwazRJNDJ2YUJNc1UxMWlMRENDTGtWaHRVVjIxbXZhS0N2\
TXgyWStTTWdROGZmd0wyM3ozVElWQldqZFRCek1Dc0dDQ3NHQVFVRkJ3RWdCQjhXSFcx\
aGMyRXRkR1Z6ZEM1emFXVnRaVzV6TFdKMExtNWxkRG81TkRRek1COEdBMVVkSXdRWU1C\
YUFGRlFMak56UC9TL2tvdWpRd2pnNUU1ZnZ3Y1liTUJNR0ExVWRKUVFNTUFvR0NDc0dB\
UVVGQndNQ01BNEdBMVVkRHdFQi93UUVBd0lIZ0RBS0JnZ3Foa2pPUFFRREFnTkhBREJF\
QWlCdTN3UkJMc0pNUDVzTTA3MEgrVUZyeU5VNmdLekxPUmNGeVJST2xxcUhpZ0lnWENt\
SkxUekVsdkQycG9LNmR4NmwxL3V5bVRuYlFERGZKbGF0dVgyUm9PRT0iXSwidHlwIjoi\
dm91Y2hlci1qd3MranNvbiIsImFsZyI6IkVTMjU2In0",
      "signature": "ntAgC7GT7xIDYcHBXoYej8uIUI6WR2Iv-7T1CaR-J6-xS60D\
iWS1-vfc5Uu5INZS1dyWZ4vVH6uaoPceRxNc8g"
    }
  ]
}
</pre>
</div>
<figcaption><a href="#figure-53" class="selfRef">Figure 53</a>:
<a href="#name-example-pledge-voucher-reque" class="selfRef">Example Pledge-Voucher-Request - PVR</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="example-parboiled-registrar-voucher-request-rvr-from-registrar-to-masa">
<section id="appendix-A.2">
        <h3 id="name-example-parboiled-registrar">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-example-parboiled-registrar" class="section-name selfRef">Example Parboiled Registrar Voucher-Request (RVR) - from Registrar to MASA</a>
        </h3>
<p id="appendix-A.2-1">The term parboiled refers to food which is partially cooked.  In <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>, the term refers to a pledge-voucher-request (PVR) which has
been received by the Registrar, and then has been processed by the Registrar ("cooked"), and is now being forwarded to the MASA.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2-2">The following is an example registrar-voucher-request (RVR) sent from the Registrar to the MASA, in "General JWS JSON Serialization".
Note that the previous PVR can be seen in the payload as "prior-signed-voucher-request".
The message size of this RVR is: 7533 bytes<a href="#appendix-A.2-2" class="pilcrow">¶</a></p>
<span id="name-example-registrar-voucher-r"></span><div id="ExampleRegistrarVoucherRequestfigure">
<figure id="figure-54">
          <div class="alignLeft art-text artwork" id="appendix-A.2-3.1">
<pre>
=============== NOTE: '\' line wrapping per RFC 8792 ================

{
  "payload": "eyJpZXRmLXZvdWNoZXItcmVxdWVzdC1wcm06dm91Y2hlciI6eyJhc3\
NlcnRpb24iOiJhZ2VudC1wcm94aW1pdHkiLCJzZXJpYWwtbnVtYmVyIjoiMDEyMzQ1Nj\
c4OSIsImlkZXZpZC1pc3N1ZXIiOiJCQmd3Rm9BVVZBdU0zTS85TCtTaTZORENPRGtUbC\
svQnhocz0iLCJub25jZSI6ImtoTnlLcE10aGNjaWExclh3NDQvdlE9PSIsInByaW9yLX\
NpZ25lZC12b3VjaGVyLXJlcXVlc3QiOiJleUp3WVhsc2IyRmtJam9pWlhsS2NGcFlVbT\
FNV0ZwMlpGZE9iMXBZU1hSamJWWjRaRmRXZW1SRE1YZGpiVEEyWkcwNU1Wa3lhR3hqYV\
VrMlpYbEthR016VG14amJsSndZakkwYVU5cFNtaGFNbFoxWkVNeGQyTnRPVFJoVnpGd1\
pFaHJhVXhEU25wYVdFcHdXVmQzZEdKdVZuUlpiVlo1U1dwdmFVMUVSWGxOZWxFeFRtcG\
pORTlUU1hOSmJUVjJZbTFPYkVscWIybGhNbWhQWlZWMGQxUllVbTlaTWs1d1dWUkdlVm\
RJWXpCT1F6a3lWVlF3T1VscGQybFpNMHBzV1ZoU2JGcERNWFppYVVrMlNXcEpkMDFxVV\
hSTlJGbDBUV3BTVlUxRWF6Wk5SRVUyVFdwUmRVNVVWVEpYYVVselNXMUdibHBYTlRCTV\
dFSjVZak5hY0ZwSFZtdE1XRUo1WWpOb2NHSlhiREJsVXpGNVdsZGtjR016VW5sWldFbD\
BXVEpXZVdSRFNUWkphekZLVTFWSk1HRnJUa1JSVm14d1dqQkdNMU5WU2tKYU1HeElVVl\
pvV2s1NlNtbFpiSEJPVVZjNVNGRXdUbmhTTVU1T1RrUnNRMUZWTVVSVVZWSldaVVZXTm\
xGV1NrTmFNRFZYVVd0R2RsUlZUbkpOVkZaU1lteGFObGxXWXpGaVIwMTZWRmhvUlZaRl\
JrMVJiV1JQVm10S1Fsa3dNVU5TYXpWM1drVmtWbVZGVWpaUlZUVkRXakExVjFGclJrNV\
VWVXB6VlcxNGFrMHhTa1ZWVmxKQ1dsVmFNMDFJYkU1U1JWWTFWRlZTYW1Rd05YRlNWRk\
pPVmtWd2FGSnVZM2RsYXpGRlVsaHNUbEpIVGpOVWJYQkdUa1V4VlZOdFJrNVNSRkkwVW\
xod1FsVnJTbTVVYkZwRFVWYzVUbEV5YzNoT1ZrWjFWbTV3YUZaNlZuTlplazVPWlVWU1\
ZWRlZlRU5hTURWWFVXdEdhbFJWU2tkVWJrSnJVakZXTkZJd1VrSldNRXB1Vkd4YVExRl\
ZNVTVTUkVKVFpHMUtXRkp1UW1saVJYQnpWMnBLYzJWdFVrbFRiV2hxWVd0S1lWUlZTaz\
VTTUVvMVkxVmtWRlJVVVRWUlYyUkdVakJPUkdOVlpGUlVWRkUxVVZoa1JsTkZSWGRUVl\
VaRFVXMXplRTVyYzNaaFZHTTFZakZLY2xONlZscFpiVlpSV25wb1ZsVXhTVFJNTTFaNl\
RWZFNVVlpYYkdGVFJURXdZakowVkZwSVJreFdlbFp0WW14a2VsRnRVWEpqVmtwTlRqRm\
tVMXB0V214V01uUTFXakpXYVdJd2NHMVRWM2h6WkZoS2FtRlVTVEZrTWpWdllWVTVWMU\
V3WkhGYVdIQkRUbFV4UTAxRlpFSk5WbFpyVTJ4R1VsWXdNVU5WVldSRVVUTk9TRkZXUm\
xaU2Ewb3pWRlZLUTFveVpIbFJiV1JHVW10S1Vsa3dVa2xTUlVaUVVXMWtUMVpyYUZKUF\
JVcENXbXBvUmxGclJrNVJNRWt3VVZoa1ZGRldiRVZXYkVsM1ZXdEtSbEpZWkZGT1JXeH\
JXVEl4VjJKdFJsbFVha0pxWWxWYU5WUkdhRk5pUjAxNlZWaFdhazF0ZUhOWmJHUlhaRm\
RPTlUxWGJHdFJlbFl4VjJ4b1ZGRXdhSFZUYlhoaFRXMTRObHBGYUV0aFIwNXdUVlJDWV\
ZkRk5IZFViV3N4WlcxR1dGWnVVbUZXZWxZMlZFWmtTMDFGZUhST1YzaHJVa1ZHVEZGdF\
pHNWpWMmh5WVdzNVVWVldSa1ZSVjJSUFUxVkdSVkZyV2tKaFZVbzBZa2RTUTJGR2NIaE\
5SVll5VGxWd1RVMXNRbmxXTUU0d1pWWk5NbUZGVWxwV2VrWTFVVEE0ZGxWdFJqRlpia0\
pFVGpBeGFGTlZVbTVUVjJoQ1ZFWk9TMWx0WkUxaWJXUnZXVzFLUWxwNlFtdFpNV1JIVm\
xaYWRrd3laRWhVYWtGMllXNWtObE5zYjNkVk1uZDVZVVJTTkZOV2FISk5VMGx6U1cxR2\
JscFhOVEJNV0U1d1dqSTFiRnBETVd0WldGSm9TV3B2YVZwWWJFdGtNV3haWWtoT2FVMX\
JXbkpUVjNCMllWWndXV0pGZEdwU2JrSmFWbGN3ZUZSV1pFZGpSRXBoVW0xU1VGbHFSbm\
RYVms1WlZXMXdhVlpzYnpCWGExcHJWakpXZEZWclVrNVhSMUp4V1d4U1FrMXNaRmRhUj\
NScFVqQndNVlpXYUZOaGF6RjBaVWhXV21KVVJsaFpWRUkwVjBaV2RHRkhkRk5OUmxwM1\
ZrUkpNV1Z0UmxkaE0zQlVZbGhvWVZZd1drdGpNV1J5VkZob2EySlZjSGRWTVZKaFUyMU\
djbUpFVGxWV00wSkxXa1ZWZUZKWFJYcFZhelZvWVROQ1YxWkdWbE5XYXpWeVRsVldWVl\
pHY0ZCV2ExWkhUVlpTVjFWcmNFNVdiVkozVlRGb1QxTnRTbkpPV0U1YVRXcEdlbGxWWk\
V0U1JURlpWbTEwVjJWclduZFdNbmh2VTIxR1ZrOVlRbFJYUjFKUFZtdFdjMDVzVW5KVm\
JGcE9ZWHBWTWxkdWNGZFRiVXB4VWxSV1NtRllaSEJaZWtwelltMUtkRkpxUW10WFJYQn\
pXVE5zU2s1c1kzcGpNbXhxVTBWd01scEZaRmRoYlZKSVZtMTBTbUZ0T1hCWGJHaHpVek\
pPZEZKc2FGWldNbmhSV1ZaV2QxWnNXa1phUlRWT1RWZFNXbGxWVmpSV01rcEhWMnhrWV\
ZaNlZreFVWRVpMVmxaU2MxTnNhRmRTYkhCRlZqSjRZV0V5U1hsVVdHeE9WbFphVDFSWE\
1VNU9WazVZWWtST2FGWnRlRmxhVldNeFUyMUdkRTlZUWxaaVJuQlBXbFpWTVZaV1pGaG\
lSekZXVlRCc2VsTlhOVTlqUm05NVRsZG9hMU5HV2pWWGJFNUtUbXRzY21RemJGcFdSVX\
B6V1ROd1YxcHJlRmhhU0U1YVZtcHJkMVJxUmxaTlJURldZa1pLV0ZKdGVFcFZNVkpUVV\
d4TmVGWnNaRlpTYTFwdFZGUkdVMkpIVVhoVlZFWnBUVVphVjFkV1ZrOWtSbFpKVVd0MF\
lVMXRVbmxWTUdNeFpEQTVWMVJyTVdGV1Jsb3hXVmRyZUdKc1pFZGlSbEpwVFdzMWMxUX\
hVbTlsUmtaWVUyNVNUMkV3V1hkYVJrMTRVbXhKZUZWcmVGcE5SRlpUVTFjMGVGcEhXbE\
pOUlhOcFpsZ3dJaXdpYzJsbmJtRjBkWEpsY3lJNlczc2ljSEp2ZEdWamRHVmtJam9pWl\
hsS05FNVhUV2xQYkhOcFZGVnNTbEZwZEZWUk1FNUNXVlZPYmxGWVpFcFJhMFp1VTFWa1\
FsZEhOVmRoYms1V1RsVXhRbUl3WkVSUk0wWklWVEF3TUU5VlNrSlVWVTVPVWtSQ05GRX\
pjRUpUYTBwdVZHeGFRMUZXYkZWUlYzUkhWV3N4VTFaWVpFWmtNV3hGVm14R1VsTXdVa0\
psUlhSb1ZucFdkVlV5TVhOa1ZtOTNWRzVhYW1KclJqUlNibkJDVm10S2JsUnNXa05SVl\
RGT1VrZDBkMk5IU25SYVJYUm9WbnBXZFZaclpGZGxiVkpHVkd0S1RsRXdSbGxTUmxKS1\
pVVXhSVmRZWkU5U1JVVjRWR3RTV21WRk5VZGlNV3hGWlcxek1WUXhVbkpsUlRGeFZGaG\
9UbUZyTUhoVU1WSldUbFprY1ZGc1RrNVZXRTR6VVRGR1dsSkdXbEpWVldSR1pEQndRMV\
pXVWtaV2F6RkRWRlZrUWsxV1ZrWlJNbVF6VkZaT2RHSklWbUZOU0VKM1dXMHhhMUpIU1\
hwVGJtUk9WV3N4TTFKV1JscFNSbHBTVlZWYVJtUXlPVE5VVmxKS1pXczFSVlpVU2s5bG\
JXTXhWRlpLYW1Rd1dsSlhWVkpYVlZaR1JWSkZSVEZUTWtaWVRsYzFWR0pYZURGWGFrSl\
RZa2RTZEdKSGNHRldSVXBoVkZWS1RsSXdTalZqVldSVVZGUlJOVkZYWkVaU01FNUVZMV\
ZrVkZSVVVUVlJXR1JHVTBWRmQxTlZSa05SZW1NMVlrZHNhRlZ0VGtOaGJIQnFVbFZXV1\
dSNlpIbFdWMVpvWkc1U1NGTnJSakZUUkZKM1lYcFNTazVFU2pKWlZVcE9ZekZWZUUxWG\
JFMVNSVTVFVkVkMFYyRklVbFpXYWtsNFlsaGFhRk13VGpKVVdHZDVWMU4wVkZSWFpGSl\
BSMXB0WkRCM2VVMHpiM3BXUld4WFVXeGtjVnBHVWtObGF6RkVZekJrUkZFelRraFJWa1\
pXVW10S00xSlhaRU5SYW1oWVUwWmplR0ZIVFhsU1dGSnJVakZhTmxwRlRURmxiVVpZVm\
01U1lWWjZWalpVUm1STFRVVjRkRTVYZUd0U1J6Z3hWR3RTVW1Wck1VTlBSV1JDVFZaV2\
ExTllaRkpYVlRGRFdWVkdSMUpzUmsxaGF6VTJWVU01VkV3eWRIWmtWM0JTWkRKd2JrNV\
ZWVEZhYmxveldURnNhVlJWU2s1U01FVjRWbGRTUzFWV1JrNVVWVVoyVWpCT1JHTXdaRU\
pWVmxaSFVXNWtUbEV3TVVKT1JXUkNUVlpXYTFKSVpFWlJhVGt6VlZWV1FtUXdiRWxhTU\
ZKQ1V6QktibG96Um05aE1uQlFWVVpHVWxKRlJtNVVhMmhDVWtWS1JsRlhiRU5rVkU0el\
ZXdEtUV013Y0U1VlJGWjZWRlJCTTAxRlozSldWVnA1WlZVMVZrNXRaRXhsYTNoUVZXMU\
9SMlZXU2xOVU1uaDRZMVZvY0Zvd2JHNVhSVTUwVTJ0NFZXVnJWbk5rYTFGNVkwYzVURT\
V0VWpST2JYZDRURE5XTldKV1VuVlpiRVpGVWtkYVMySkhSakJrVm1kNVZXMDVVRkpVTU\
dsWVUzZHBaRWhzZDBscWIybGtiVGt4V1RKb2JHTnBNWEZrTTAxeVlXNU9kbUpwU1hOSm\
JVWnpXbmxKTmtsclZsUk5hbFV5U1c0d0lpd2ljMmxuYm1GMGRYSmxJam9pYm5SQlowTT\
NSMVEzZUVsRVdXTklRbGh2V1dWcU9IVkpWVWsyVjFJeVNYWXROMVF4UTJGU0xVbzJMWG\
hUTmpCRWFWZFRNUzEyWm1NMVZYVTFTVTVhVXpGa2VWZGFOSFpXU0RaMVlXOVFZMlZTZU\
U1ak9HY2lmVjE5IiwiY3JlYXRlZC1vbiI6IjIwMjQtMDYtMjRUMDk6MDI6MTUuNTczWi\
IsImFnZW50LXNpZ24tY2VydCI6WyJNSUlCOWpDQ0FaMmdBd0lCQWdJRVl4WHM3VEFLQm\
dncWhrak9QUVFEQWpBK01STXdFUVlEVlFRS0RBcE5lVUoxYzJsdVpYTnpNUTB3Q3dZRF\
ZRUUhEQVJUYVhSbE1SZ3dGZ1lEVlFRRERBOVVaWE4wVUhWemFFMXZaR1ZzUTBFd0hoY0\
5Nakl3T1RBMU1USXpORFV6V2hjTk1qVXdPVEExTVRJek5EVXpXakJnTVFzd0NRWURWUV\
FHRXdKQlVURVNNQkFHQTFVRUNnd0pUWGxEYjIxd1lXNTVNUlV3RXdZRFZRUUxEQXhOZV\
ZOMVluTnBaR2xoY25reEpqQWtCZ05WQkFNTUhVMTVVMmwwWlZCMWMyaE5iMlJsYkZKbF\
oybHpkSEpoY2tGblpXNTBNRmt3RXdZSEtvWkl6ajBDQVFZSUtvWkl6ajBEQVFjRFFnQU\
V4aHZuYWtDSmVpZ3pqWkFVYU5adVAwMWUrUWxVY1E5UjJMSWs2UkI2dmtjdFdMS3BaWC\
85TGthNEdxckFWWmhhM3ZKcmhGc0l4OEdUQkhqWnZLMVd1Nk5uTUdVd0RnWURWUjBQQV\
FIL0JBUURBZ09JTUI4R0ExVWRJd1FZTUJhQUZHK2hQVzUxN1ovb3NSQ0ZUc2NlUDY4bj\
kzc2pNQjBHQTFVZERnUVdCQlJNdHp0akVwVlJUT3ZBVGRCamtGNWFHeVlQZURBVEJnTl\
ZIU1VFRERBS0JnZ3JCZ0VGQlFjREFqQUtCZ2dxaGtqT1BRUURBZ05IQURCRUFpQmJoRG\
pwbDJ2cWNONnBSVjRuZVU0dFFsWWFOTit4ZjNnSnUrMHBKblNBL1FJZ0ljcXpsZmhYaU\
Qxc0g3VTVQdUtwVVpzSWpkRjRSenhzQTZxSnRFTEQyUHM9Il19fQ",
  "signatures": [
    {
      "protected": "eyJ4NWMiOlsiTUlJQm96Q0NBVXFnQXdJQkFnSUdBVzBlTHVJ\
Rk1Bb0dDQ3FHU000OUJBTUNNRFV4RXpBUkJnTlZCQW9NQ2sxNVFuVnphVzVsYzNNeERU\
QUxCZ05WQkFjTUJGTnBkR1V4RHpBTkJnTlZCQU1NQmxSbGMzUkRRVEFlRncweE9UQTVN\
VEV3TWpNM016SmFGdzB5T1RBNU1URXdNak0zTXpKYU1GUXhFekFSQmdOVkJBb01DazE1\
UW5WemFXNWxjM014RFRBTEJnTlZCQWNNQkZOcGRHVXhMakFzQmdOVkJBTU1KVkpsWjJs\
emRISmhjaUJXYjNWamFHVnlJRkpsY1hWbGMzUWdVMmxuYm1sdVp5QkxaWGt3V1RBVEJn\
Y3Foa2pPUFFJQkJnZ3Foa2pPUFFNQkJ3TkNBQVQ2eFZ2QXZxVHoxWlVpdU5XaFhwUXNr\
YVB5N0FISFFMd1hpSjBpRUx0NnVOUGFuQU4wUW5XTVlPLzBDREVqSWtCUW9idzhZS3Fq\
dHhKSFZTR1RqOUtPb3ljd0pUQVRCZ05WSFNVRUREQUtCZ2dyQmdFRkJRY0RIREFPQmdO\
VkhROEJBZjhFQkFNQ0I0QXdDZ1lJS29aSXpqMEVBd0lEUndBd1JBSWdZcjJMZnFvYUNL\
REY0UkFjTW1KaStOQ1pxZFNpdVZ1Z0lTQTdPaEtScTNZQ0lEeG5QTU1ucFhBTVRyUEp1\
UFd5Y2VFUjExUHhIT24rMENwU0hpMnFncFdYIl0sInR5cCI6InZvdWNoZXItandzK2pz\
b24iLCJhbGciOiJFUzI1NiJ9",
      "signature": "_mcsO5vo0g2rFmBvTb-UsOWkEmhYNfQ5XmbuKHKH0ZLjea-7\
911BilAMdFORmT4vCzWKBSH6HSqtpIRcSSxx7Q"
    }
  ]
}
</pre>
</div>
<figcaption><a href="#figure-54" class="selfRef">Figure 54</a>:
<a href="#name-example-registrar-voucher-r" class="selfRef">Example Registrar-Voucher-Request - RVR</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="example-voucher-from-masa-to-pledge-via-registrar-and-registrar-agent">
<section id="appendix-A.3">
        <h3 id="name-example-voucher-from-masa-t">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-example-voucher-from-masa-t" class="section-name selfRef">Example Voucher - from MASA to Pledge, via Registrar and Registrar-Agent</a>
        </h3>
<p id="appendix-A.3-1">The following is an example voucher-response from MASA to Pledge via Registrar and Registrar-Agent, in "General JWS JSON Serialization". The message size of this Voucher is: 1916 bytes<a href="#appendix-A.3-1" class="pilcrow">¶</a></p>
<span id="name-example-voucher-response-fr"></span><div id="ExampleVoucherResponsefigure">
<figure id="figure-55">
          <div class="alignLeft art-text artwork" id="appendix-A.3-2.1">
<pre>
=============== NOTE: '\' line wrapping per RFC 8792 ================

{
  "payload":"eyJpZXRmLXZvdWNoZXI6dm91Y2hlciI6eyJhc3NlcnRpb24iOiJhZ2V\
udC1wcm94aW1pdHkiLCJzZXJpYWwtbnVtYmVyIjoiMDEyMzQ1Njc4OSIsIm5vbmNlIjo\
iTDNJSjZocHRIQ0lRb054YWFiOUhXQT09IiwiY3JlYXRlZC1vbiI6IjIwMjItMDQtMjZ\
UMDU6MTY6MjguNzI2WiIsInBpbm5lZC1kb21haW4tY2VydCI6Ik1JSUJwRENDQVVtZ0F\
3SUJBZ0lHQVcwZUx1SCtNQW9HQ0NxR1NNNDlCQU1DTURVeEV6QVJCZ05WQkFvTUNrMTV\
RblZ6YVc1bGMzTXhEVEFMQmdOVkJBY01CRk5wZEdVeER6QU5CZ05WQkFNTUJsUmxjM1J\
EUVRBZUZ3MHhPVEE1TVRFd01qTTNNekphRncweU9UQTVNVEV3TWpNM016SmFNRFV4RXp\
BUkJnTlZCQW9NQ2sxNVFuVnphVzVsYzNNeERUQUxCZ05WQkFjTUJGTnBkR1V4RHpBTkJ\
nTlZCQU1NQmxSbGMzUkRRVEJaTUJNR0J5cUdTTTQ5QWdFR0NDcUdTTTQ5QXdFSEEwSUF\
CT2t2a1RIdThRbFQzRkhKMVVhSTcrV3NIT2IwVVMzU0FMdEc1d3VLUURqaWV4MDYvU2N\
ZNVBKaWJ2Z0hUQitGL1FUamdlbEhHeTFZS3B3Y05NY3NTeWFqUlRCRE1CSUdBMVVkRXd\
FQi93UUlNQVlCQWY4Q0FRRXdEZ1lEVlIwUEFRSC9CQVFEQWdJRU1CMEdBMVVkRGdRV0J\
CVG9aSU16UWRzRC9qLytnWC83Y0JKdWNIL1htakFLQmdncWhrak9QUVFEQWdOSkFEQkd\
BaUVBdHhRMytJTEdCUEl0U2g0YjlXWGhYTnVocVNQNkgrYi9MQy9mVllEalE2b0NJUUR\
HMnVSQ0hsVnEzeWhCNThUWE1VYnpIOCtPbGhXVXZPbFJEM1ZFcURkY1F3PT0ifX0",
  "signatures":[{
    "protected":"eyJ4NWMiOlsiTUlJQmt6Q0NBVGlnQXdJQkFnSUdBV0ZCakNrWU1\
Bb0dDQ3FHU000OUJBTUNNRDB4Q3pBSkJnTlZCQVlUQWtGUk1SVXdFd1lEVlFRS0RBeEt\
hVzVuU21sdVowTnZjbkF4RnpBVkJnTlZCQU1NRGtwcGJtZEthVzVuVkdWemRFTkJNQjR\
YRFRFNE1ERXlPVEV3TlRJME1Gb1hEVEk0TURFeU9URXdOVEkwTUZvd1R6RUxNQWtHQTF\
VRUJoTUNRVkV4RlRBVEJnTlZCQW9NREVwcGJtZEthVzVuUTI5eWNERXBNQ2NHQTFVRUF\
3d2dTbWx1WjBwcGJtZERiM0p3SUZadmRXTm9aWElnVTJsbmJtbHVaeUJMWlhrd1dUQVR\
CZ2NxaGtqT1BRSUJCZ2dxaGtqT1BRTUJCd05DQUFTQzZiZUxBbWVxMVZ3NmlRclJzOFI\
wWlcrNGIxR1d5ZG1XczJHQU1GV3diaXRmMm5JWEgzT3FIS1Z1OHMyUnZpQkdOaXZPS0d\
CSEh0QmRpRkVaWnZiN294SXdFREFPQmdOVkhROEJBZjhFQkFNQ0I0QXdDZ1lJS29aSXp\
qMEVBd0lEU1FBd1JnSWhBSTRQWWJ4dHNzSFAyVkh4XC90elVvUVwvU3N5ZEwzMERRSU5\
FdGNOOW1DVFhQQWlFQXZJYjNvK0ZPM0JUbmNMRnNhSlpSQWtkN3pPdXNuXC9cL1pLT2F\
FS2JzVkRpVT0iXSwiYWxnIjoiRVMyNTYifQ",
    "signature":"0TB5lr-cs1jqka2vNbQm3bBYWfLJd8zdVKIoV53eo2YgSITnKKY\
TvHMUw0wx9wdyuNVjNoAgLysNIgEvlcltBw"
  }]
}
</pre>
</div>
<figcaption><a href="#figure-55" class="selfRef">Figure 55</a>:
<a href="#name-example-voucher-response-fr" class="selfRef">Example Voucher-Response from MASA</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="example-voucher-masa-issued-voucher-with-additional-registrar-signature-from-masa-to-pledge-via-registrar-and-registrar-agent">
<section id="appendix-A.4">
        <h3 id="name-example-voucher-masa-issued">
<a href="#appendix-A.4" class="section-number selfRef">A.4. </a><a href="#name-example-voucher-masa-issued" class="section-name selfRef">Example Voucher, MASA issued Voucher with additional Registrar signature (from MASA to Pledge, via Registrar and Registrar-Agent)</a>
        </h3>
<p id="appendix-A.4-1">The following is an example voucher-response from MASA to Pledge via Registrar and Registrar-Agent, in "General JWS JSON Serialization".
The message size of this Voucher is: 2994 bytes<a href="#appendix-A.4-1" class="pilcrow">¶</a></p>
<span id="name-example-voucher-response-fro"></span><div id="ExampleVoucherResponseWithRegSignfigure">
<figure id="figure-56">
          <div class="alignLeft art-text artwork" id="appendix-A.4-2.1">
<pre>
=============== NOTE: '\' line wrapping per RFC 8792 ================

{
  "payload": "eyJpZXRmLXZvdWNoZXI6dm91Y2hlciI6eyJhc3NlcnRpb24iOiJhZ2\
VudC1wcm94aW1pdHkiLCJzZXJpYWwtbnVtYmVyIjoiMDEyMzQ1Njc4OSIsIm5vbmNlIj\
oia2hOeUtwTXRoY2NpYTFyWHc0NC92UT09IiwiY3JlYXRlZC1vbiI6IjIwMjQtMDYtMj\
RUMDk6MDI6MTYuMjQ0WiIsInBpbm5lZC1kb21haW4tY2VydCI6Ik1JSUJwRENDQVVtZ0\
F3SUJBZ0lHQVcwZUx1SCtNQW9HQ0NxR1NNNDlCQU1DTURVeEV6QVJCZ05WQkFvTUNrMT\
VRblZ6YVc1bGMzTXhEVEFMQmdOVkJBY01CRk5wZEdVeER6QU5CZ05WQkFNTUJsUmxjM1\
JEUVRBZUZ3MHhPVEE1TVRFd01qTTNNekphRncweU9UQTVNVEV3TWpNM016SmFNRFV4RX\
pBUkJnTlZCQW9NQ2sxNVFuVnphVzVsYzNNeERUQUxCZ05WQkFjTUJGTnBkR1V4RHpBTk\
JnTlZCQU1NQmxSbGMzUkRRVEJaTUJNR0J5cUdTTTQ5QWdFR0NDcUdTTTQ5QXdFSEEwSU\
FCT2t2a1RIdThRbFQzRkhKMVVhSTcrV3NIT2IwVVMzU0FMdEc1d3VLUURqaWV4MDYvU2\
NZNVBKaWJ2Z0hUQitGL1FUamdlbEhHeTFZS3B3Y05NY3NTeWFqUlRCRE1CSUdBMVVkRX\
dFQi93UUlNQVlCQWY4Q0FRRXdEZ1lEVlIwUEFRSC9CQVFEQWdJRU1CMEdBMVVkRGdRV0\
JCVG9aSU16UWRzRC9qLytnWC83Y0JKdWNIL1htakFLQmdncWhrak9QUVFEQWdOSkFEQk\
dBaUVBdHhRMytJTEdCUEl0U2g0YjlXWGhYTnVocVNQNkgrYi9MQy9mVllEalE2b0NJUU\
RHMnVSQ0hsVnEzeWhCNThUWE1VYnpIOCtPbGhXVXZPbFJEM1ZFcURkY1F3PT0ifX0",
  "signatures": [
    {
      "protected": "eyJ4NWMiOlsiTUlJQmt6Q0NBVGlnQXdJQkFnSUdBV0ZCakNr\
WU1Bb0dDQ3FHU000OUJBTUNNRDB4Q3pBSkJnTlZCQVlUQWtGUk1SVXdFd1lEVlFRS0RB\
eEthVzVuU21sdVowTnZjbkF4RnpBVkJnTlZCQU1NRGtwcGJtZEthVzVuVkdWemRFTkJN\
QjRYRFRFNE1ERXlPVEV3TlRJME1Gb1hEVEk0TURFeU9URXdOVEkwTUZvd1R6RUxNQWtH\
QTFVRUJoTUNRVkV4RlRBVEJnTlZCQW9NREVwcGJtZEthVzVuUTI5eWNERXBNQ2NHQTFV\
RUF3d2dTbWx1WjBwcGJtZERiM0p3SUZadmRXTm9aWElnVTJsbmJtbHVaeUJMWlhrd1dU\
QVRCZ2NxaGtqT1BRSUJCZ2dxaGtqT1BRTUJCd05DQUFTQzZiZUxBbWVxMVZ3NmlRclJz\
OFIwWlcrNGIxR1d5ZG1XczJHQU1GV3diaXRmMm5JWEgzT3FIS1Z1OHMyUnZpQkdOaXZP\
S0dCSEh0QmRpRkVaWnZiN294SXdFREFPQmdOVkhROEJBZjhFQkFNQ0I0QXdDZ1lJS29a\
SXpqMEVBd0lEU1FBd1JnSWhBSTRQWWJ4dHNzSFAyVkh4L3R6VW9RL1NzeWRMMzBEUUlO\
RXRjTjltQ1RYUEFpRUF2SWIzbytGTzNCVG5jTEZzYUpaUkFrZDd6T3Vzbi8vWktPYUVL\
YnNWRGlVPSJdLCJ0eXAiOiJ2b3VjaGVyLWp3cytqc29uIiwiYWxnIjoiRVMyNTYifQ",
      "signature": "SFtc2xqK8xN2KVqkYKJl7EUU8UJAai3VvCuK8LIfH8HZFvrr\
hqGiY8vK5cbQHQCjVcroFLn7IyhH708XAdstAQ"
    },
    {
      "protected": "eyJ4NWMiOlsiTUlJQjRqQ0NBWWlnQXdJQkFnSUdBWFk3MmJi\
Wk1Bb0dDQ3FHU000OUJBTUNNRFV4RXpBUkJnTlZCQW9NQ2sxNVFuVnphVzVsYzNNeERU\
QUxCZ05WQkFjTUJGTnBkR1V4RHpBTkJnTlZCQU1NQmxSbGMzUkRRVEFlRncweU1ERXlN\
RGN3TmpFNE1USmFGdzB6TURFeU1EY3dOakU0TVRKYU1ENHhFekFSQmdOVkJBb01DazE1\
UW5WemFXNWxjM014RFRBTEJnTlZCQWNNQkZOcGRHVXhHREFXQmdOVkJBTU1EMFJ2YldG\
cGJsSmxaMmx6ZEhKaGNqQlpNQk1HQnlxR1NNNDlBZ0VHQ0NxR1NNNDlBd0VIQTBJQUJC\
azE2Sy9pNzlvUmtLNVliZVBnOFVTUjgvdXMxZFBVaVpITXRva1NkcUtXNWZuV3NCZCtx\
Ukw3V1JmZmVXa3lnZWJvSmZJbGx1cmNpMjV3bmhpT1ZDR2plekI1TUIwR0ExVWRKUVFX\
TUJRR0NDc0dBUVVGQndNQkJnZ3JCZ0VGQlFjREhEQU9CZ05WSFE4QkFmOEVCQU1DQjRB\
d1NBWURWUjBSQkVFd1A0SWRjbVZuYVhOMGNtRnlMWFJsYzNRdWMybGxiV1Z1Y3kxaWRD\
NXVaWFNDSG5KbFoybHpkSEpoY2kxMFpYTjBOaTV6YVdWdFpXNXpMV0owTG01bGREQUtC\
Z2dxaGtqT1BRUURBZ05JQURCRkFpQnhsZEJoWnEwRXY1SkwyUHJXQ3R5UzZoRFlXMXlD\
Ty9SYXVicEM3TWFJRGdJaEFMU0piZ0xuZ2hiYkFnMGRjV0ZVVm8vZ0dOMC9qd3pKWjBT\
bDJoNHhJWGsxIl0sInR5cCI6InZvdWNoZXItandzK2pzb24iLCJhbGciOiJFUzI1NiJ9\
",
      "signature": "0Q7_a7L4ahn2vmfSxxkKg1xsOMMc8_D7B_Ilzqv5DKzCMkc7\
8YeeezDsuh4Z5JNVQUYHPp7LsK_AS_WH8TdVzA"
    }
  ]
}

</pre>
</div>
<figcaption><a href="#figure-56" class="selfRef">Figure 56</a>:
<a href="#name-example-voucher-response-fro" class="selfRef">Example Voucher-Response from MASA, with additional Registrar signature</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="pledgehttps">
<section id="appendix-B">
      <h2 id="name-http-over-tls-operations-be">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-http-over-tls-operations-be" class="section-name selfRef">HTTP-over-TLS operations between Registrar-Agent and Pledge</a>
      </h2>
<p id="appendix-B-1">The use of HTTP-over-TLS between Registrar-Agent and pledge has been identified as an optional mechanism.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">Provided that the key-agreement in the underlying TLS protocol connection can be properly authenticated, the use of TLS provides privacy for the voucher and enrollment operations between the pledge and the Registrar-Agent.
The authenticity of the onboarding and enrollment is not dependent upon the security of the TLS connection.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<p id="appendix-B-3">The use of HTTP-over-TLS is not mandated by this document for two main reasons:<a href="#appendix-B-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-B-4">
<li id="appendix-B-4.1">
          <p id="appendix-B-4.1.1">A certificate is generally required in order to do TLS.  While there are other modes of authentication including PSK, various EAP methods, and raw public key, they do not help as there is no previous relationship between the Registrar-Agent and the pledge.<a href="#appendix-B-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="appendix-B-4.2">
          <p id="appendix-B-4.2.1">The pledge can use its IDevID certificate to authenticate itself, but <span>[<a href="#RFC9525" class="cite xref">RFC9525</a>]</span> DNS-ID methods do not apply, as the pledge does not have a FQDN, and hence cannot be identified by DNS name.  Instead a new mechanism is required, which authenticates the X520SerialNumber DN attribute that must be present in every IDevID.<a href="#appendix-B-4.2.1" class="pilcrow">¶</a></p>
</li>
      </ol>
<p id="appendix-B-5">If the Registrar-Agent has a pre-configured list of which product-serial-number(s), from which manufacturers it expects to see, then it can attempt to match this pledge against a list of potential devices.<a href="#appendix-B-5" class="pilcrow">¶</a></p>
<p id="appendix-B-6">In many cases only the list of manufacturers is known ahead of time, so at most the Registrar-Agent can show the X520SerialNumber to the (human) operator who may then attempt to confirm that they are standing in front of a device with that product-serial-number.
The use of scannable QR codes may help automate this in some cases.<a href="#appendix-B-6" class="pilcrow">¶</a></p>
<p id="appendix-B-7">The CA used to sign the IDevID will be a manufacturer private PKI as described in <span><a href="https://datatracker.ietf.org/doc/html/draft-irtf-t2trg-taxonomy-manufacturer-anchors-07#section-4.1" class="relref">Section 4.1</a> of [<a href="#I-D.irtf-t2trg-taxonomy-manufacturer-anchors" class="cite xref">I-D.irtf-t2trg-taxonomy-manufacturer-anchors</a>]</span>.
The anchors for this PKI will never be part of the public WebPKI anchors which are distributed with most smartphone operating systems.
A Registrar-Agent application will need to use different APIs in order to initiate an HTTPS connection without performing WebPKI verification.
The application will then have to do its own certificate chain verification against a store of manufacturer trust anchors.
In the Android ecosystem this involves use of a customer TrustManager: many application developers do not create these correctly, and there is significant push to remove this option as it has repeatedly resulted in security failures (see <span>[<a href="#androidtrustfail" class="cite xref">androidtrustfail</a>]</span>).<a href="#appendix-B-7" class="pilcrow">¶</a></p>
<p id="appendix-B-8">Also note that an Extended Key Usage (EKU) for TLS WWW Server authentication cannot be expected in the pledge IDevID certificate.
IDevID certificates are intended to be widely usable and EKU does not support that use.<a href="#appendix-B-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="app_history">
<section id="appendix-C">
      <h2 id="name-history-of-changes-rfc-edit">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-history-of-changes-rfc-edit" class="section-name selfRef">History of Changes [RFC Editor: please delete]</a>
      </h2>
<p id="appendix-C-1">Proof of Concept Code available<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<p id="appendix-C-2">From IETF draft 18 -&gt; IETF draft 19:<a href="#appendix-C-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-3.1">
          <p id="appendix-C-3.1.1">addressed DISCUSS received during telechat preparation:<a href="#appendix-C-3.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-3.1.2.1">
              <p id="appendix-C-3.1.2.1.1">issue 136: included hint for reaction on HTTP requests to avoid DoS (rate limiting) in <a href="#pledge_component" class="auto internal xref">Section 6.2</a><a href="#appendix-C-3.1.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-C-3.1.2.2">
              <p id="appendix-C-3.1.2.2.1">issue 137: HTTP error handling BCP: proposal to avoid normative language<a href="#appendix-C-3.1.2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-C-3.1.2.3">
              <p id="appendix-C-3.1.2.3.1">issue 139: usage of TLS 1.3 emphasized by also referencing UTA draft in <a href="#pvr" class="auto internal xref">Section 7.3</a><a href="#appendix-C-3.1.2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="appendix-C-3.2">
          <p id="appendix-C-3.2.1">addressed COMMENT, NITS, received during telechat preparation, specifically<a href="#appendix-C-3.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-3.2.2.1">
              <p id="appendix-C-3.2.2.1.1">issue 140: synchronized time<a href="#appendix-C-3.2.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-C-3.2.2.2">
              <p id="appendix-C-3.2.2.2.1">issue 141: config options for discovery and nonceless vouchers in <a href="#voucher" class="auto internal xref">Section 7.6</a> and <a href="#agent_component" class="auto internal xref">Section 6.1</a><a href="#appendix-C-3.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-C-3.2.2.3">
              <p id="appendix-C-3.2.2.3.1">issue 142: addressed TTL of provisional accept state by utilizing the last received tPVR for the binding in<a href="#appendix-C-3.2.2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="appendix-C-3.3">
          <p id="appendix-C-3.3.1">updated reference of BRSKI-AE (now RFC 9733).<a href="#appendix-C-3.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-4">From IETF draft 17 -&gt; IETF draft 18:<a href="#appendix-C-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-5.1">
          <p id="appendix-C-5.1.1">addressed nits received from the GenART review<a href="#appendix-C-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-5.2">
          <p id="appendix-C-5.2.1">addressed comment from IANA to update contact for service name registration from IESG to IETF Chair in <a href="#sn_reg" class="auto internal xref">Section 10.2</a><a href="#appendix-C-5.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-5.3">
          <p id="appendix-C-5.3.1">SECDIR review: included reasoning for short lived certificates in <a href="#agent_component" class="auto internal xref">Section 6.1</a><a href="#appendix-C-5.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-5.4">
          <p id="appendix-C-5.4.1">SECDIR review: enhanced reasoning for optional TLS usage in <a href="#tpvr" class="auto internal xref">Section 7.1</a><a href="#appendix-C-5.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-5.5">
          <p id="appendix-C-5.5.1">SECDIR review: added hint for handling if the accept header is not used in <a href="#tpvr" class="auto internal xref">Section 7.1</a> and <a href="#tper" class="auto internal xref">Section 7.2</a><a href="#appendix-C-5.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-5.6">
          <p id="appendix-C-5.6.1">SECDIR review: added hint for response body encoding in <a href="#tpvr" class="auto internal xref">Section 7.1</a> and <a href="#tper" class="auto internal xref">Section 7.2</a><a href="#appendix-C-5.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-5.7">
          <p id="appendix-C-5.7.1">SECDIR review: added hint regarding IDevID and LDevID validity in <a href="#op_cons" class="auto internal xref">Section 9</a><a href="#appendix-C-5.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-5.8">
          <p id="appendix-C-5.8.1">DNSDIR review: renamed <a href="#sn_reg" class="auto internal xref">Section 10.2</a> to Service Name and Transport Protocol Port Number Registry<a href="#appendix-C-5.8.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-5.9">
          <p id="appendix-C-5.9.1">from IANA expert review: included registered service names in headings<a href="#appendix-C-5.9.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-6">From IETF draft 16 -&gt; IETF draft 17:<a href="#appendix-C-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-7.1">
          <p id="appendix-C-7.1.1">updated formatting of key events in <a href="#log_hints" class="auto internal xref">Section 8</a><a href="#appendix-C-7.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-7.2">
          <p id="appendix-C-7.2.1">updated reference to corresponding sections for JWS Header and Signature in <span>[<a href="#I-D.ietf-anima-jws-voucher" class="cite xref">I-D.ietf-anima-jws-voucher</a>]</span> in <a href="#pvr_data" class="auto internal xref">Section 7.1.2.1</a> and <a href="#rvr_data" class="auto internal xref">Section 7.3.4.1</a><a href="#appendix-C-7.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-7.3">
          <p id="appendix-C-7.3.1">simplified description for JWS Protected Header aligning with the update in draft-ietf-anima-jws-voucher-15 to always include the certificate chain in <a href="#pvr_data" class="auto internal xref">Section 7.1.2.1</a> and <a href="#rvr_data" class="auto internal xref">Section 7.3.4.1</a><a href="#appendix-C-7.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-8">From IETF draft 15 -&gt; IETF draft 16:<a href="#appendix-C-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-9.1">
          <p id="appendix-C-9.1.1">issue #135: corrections from IOTDIR review (clarification regarding minimum supported discovery in <a href="#discovery_uc2_ppa" class="auto internal xref">Section 6.1.2</a>, clarification regarding CDDl notation in <a href="#cacerts_CDDL_def" class="auto internal xref">Figure 27</a> and editorial nits.<a href="#appendix-C-9.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-9.2">
          <p id="appendix-C-9.2.1">updated references (draft-ietf-netconf-sztp-csr became RFC 9646, included RFC 9662, operational considerations drafts for registrar and MASA)<a href="#appendix-C-9.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-9.3">
          <p id="appendix-C-9.3.1">AD review: included term Registrar-Agent in Terminology section<a href="#appendix-C-9.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-9.4">
          <p id="appendix-C-9.4.1">AD review: enhanced interaction information in <a href="#uc2figure" class="auto internal xref">Figure 1</a> and <a href="#uc3figure" class="auto internal xref">Figure 2</a><a href="#appendix-C-9.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-9.5">
          <p id="appendix-C-9.5.1">AD review: included new section on <a href="#op_cons" class="auto internal xref">Section 9</a> to outline operational considerations<a href="#appendix-C-9.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-9.6">
          <p id="appendix-C-9.6.1">AD review: enhanced <a href="#log_hints" class="auto internal xref">Section 8</a> with more detailed recommendations on logging<a href="#appendix-C-9.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-9.7">
          <p id="appendix-C-9.7.1">AD review: enhanced <a href="#priv_cons" class="auto internal xref">Section 11</a> with enhanced recommendations concerning logging<a href="#appendix-C-9.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-9.8">
          <p id="appendix-C-9.8.1">AD review: enhanced <a href="#sec_cons_reg-agt" class="auto internal xref">Section 12.3</a> with more information about misuse of the Registrar-Agent<a href="#appendix-C-9.8.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-9.9">
          <p id="appendix-C-9.9.1">IOTDIR/OPSDIR/AD review: addressed various nits received throughout the draft<a href="#appendix-C-9.9.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-10">From IETF draft 14 -&gt; IETF draft 15:<a href="#appendix-C-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-11.1">
          <p id="appendix-C-11.1.1">issue #134: editorial clarifications on references to <span>[<a href="#I-D.ietf-anima-brski-discovery" class="cite xref">I-D.ietf-anima-brski-discovery</a>]</span> in <a href="#discovery_uc2_reg" class="auto internal xref">Section 6.1.1</a> and  <a href="#discovery_uc2_ppa" class="auto internal xref">Section 6.1.2</a><a href="#appendix-C-11.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-12">From IETF draft 13 -&gt; IETF draft 14:<a href="#appendix-C-12" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-13.1">
          <p id="appendix-C-13.1.1">Update of the examples in <a href="#examples" class="auto internal xref">Appendix A</a> to align with the defined prototypes<a href="#appendix-C-13.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-13.2">
          <p id="appendix-C-13.2.1">Changes incorporated based on Shepherd review PR #133:<a href="#appendix-C-13.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-13.2.2.1">
              <p id="appendix-C-13.2.2.1.1">Terminology alignment and clarification throughout the document to use terms more consistently<a href="#appendix-C-13.2.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-C-13.2.2.2">
              <p id="appendix-C-13.2.2.2.1">Restructuring of <a href="#exchanges" class="auto internal xref">Section 7</a> for protocol steps to align to the general approach: Overview, data description, CDDL description (if necessary), JWS Header an Signature. This lead to some movement of text between existing and new subsections.<a href="#appendix-C-13.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-C-13.2.2.3">
              <p id="appendix-C-13.2.2.3.1">Inclusion of new section on logging hints <a href="#log_hints" class="auto internal xref">Section 8</a> to give recommendations on which events to be logged for auditing<a href="#appendix-C-13.2.2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-C-13.2.2.4">
              <p id="appendix-C-13.2.2.4.1">Alignment of pledge status response data across <a href="#vstatus_data" class="auto internal xref">Section 7.6.2.1</a>, <a href="#estatus_data" class="auto internal xref">Section 7.8.2.1</a>, and <a href="#pstatus_data" class="auto internal xref">Section 7.11.2.1</a>.<a href="#appendix-C-13.2.2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-C-13.2.2.5">
              <p id="appendix-C-13.2.2.5.1">Included MASA component in description of affected components in <a href="#system-components" class="auto internal xref">Section 6</a><a href="#appendix-C-13.2.2.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-C-13.2.2.6">
              <p id="appendix-C-13.2.2.6.1">Moved host header field handling from <a href="#pledgehttps" class="auto internal xref">Appendix B</a> to <a href="#pledge_component" class="auto internal xref">Section 6.2</a> as generally applicable<a href="#appendix-C-13.2.2.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-C-13.2.2.7">
              <p id="appendix-C-13.2.2.7.1">Updated status artifacts (vStatus, eStatus, pStatus) to align with BRSKI CDDL definition, but made reason-context mandatory  to have distinguishable objects for the registrar-agent<a href="#appendix-C-13.2.2.7.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-C-13.2.2.8">
              <p id="appendix-C-13.2.2.8.1">Correction of terminology of local host name vs. service instance name in <a href="#discovery_uc2_ppa" class="auto internal xref">Section 6.1.2</a><a href="#appendix-C-13.2.2.8.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="appendix-C-13.3">
          <p id="appendix-C-13.3.1">Update of informative references and nits<a href="#appendix-C-13.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-14">From IETF draft 12 -&gt; IETF draft 13:<a href="#appendix-C-14" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-15.1">
          <p id="appendix-C-15.1.1">Deleted figure in Section "Request Artifact: Pledge Voucher-Request Trigger (tPVR)" for JSON representation of tPVR, as it has been replaced by CDDL<a href="#appendix-C-15.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-15.2">
          <p id="appendix-C-15.2.1">Updated reason-content description in status response messages (enroll-status, voucher-status, and status-response).<a href="#appendix-C-15.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-15.3">
          <p id="appendix-C-15.3.1">Updated CDDL source code integration to allow for automatic verification<a href="#appendix-C-15.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-15.4">
          <p id="appendix-C-15.4.1">Reordered description in <a href="#pvr" class="auto internal xref">Section 7.3</a> in <a href="#tper" class="auto internal xref">Section 7.2</a> to better match the order of communication and artifact processing.<a href="#appendix-C-15.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-15.5">
          <p id="appendix-C-15.5.1">Updated CDDL for the request-enroll trigger in <a href="#tper_CDDL_def" class="auto internal xref">Figure 15</a> according to the outcome of the interim ANIMA WG meeting discussions on April 19, 2024<a href="#appendix-C-15.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-15.6">
          <p id="appendix-C-15.6.1">Included statement in <a href="#per_artifact" class="auto internal xref">Section 7.2.2</a> for using the advanced created-on time from the agent-signed-data also for the PER, when the pledge has no synchronized clock<a href="#appendix-C-15.6.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-16">From IETF draft 11 -&gt; IETF draft 12:<a href="#appendix-C-16" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-17.1">
          <p id="appendix-C-17.1.1">Updated acknowledgments to reflect early reviews<a href="#appendix-C-17.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-17.2">
          <p id="appendix-C-17.2.1">Addressed Shepherd review part 2 (Pull Request #132); containing: terminology alignment, structural improvements of the document; deletion of leftovers from previous draft versions; change of definitions to CDDL, when no YANG is available<a href="#appendix-C-17.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-18">From IETF draft 10 -&gt; IETF draft 11:<a href="#appendix-C-18" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-19.1">
          <p id="appendix-C-19.1.1">issue #79, clarified that BRSKI discovery in the context of BRSKI-PRM is not needed in <a href="#discovery_uc2_reg" class="auto internal xref">Section 6.1.1</a>.<a href="#appendix-C-19.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-19.2">
          <p id="appendix-C-19.2.1">issue #103, removed step 6 in verification handling for the wrapped CA certificate provisioning as only applicable after enrollment <a href="#cacerts" class="auto internal xref">Section 7.7</a><a href="#appendix-C-19.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-19.3">
          <p id="appendix-C-19.3.1">issue #128: included notation of nomadic operation of the Registrar-Agent in <a href="#architecture" class="auto internal xref">Section 5</a>, including proposed text from PR #131<a href="#appendix-C-19.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-19.4">
          <p id="appendix-C-19.4.1">issue #130, introduced DNS service discovery name for brski_pledge to enable discovery by the Registrar-Agent in <a href="#iana_con" class="auto internal xref">Section 10</a><a href="#appendix-C-19.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-19.5">
          <p id="appendix-C-19.5.1">removed unused reference RFC 5280<a href="#appendix-C-19.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-19.6">
          <p id="appendix-C-19.6.1">removed site terminology<a href="#appendix-C-19.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-19.7">
          <p id="appendix-C-19.7.1">deleted duplicated text in <a href="#pledge_component" class="auto internal xref">Section 6.2</a><a href="#appendix-C-19.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-19.8">
          <p id="appendix-C-19.8.1">clarified registrar discovery and relation to BRSKI-Discovery in <a href="#discovery_uc2_reg" class="auto internal xref">Section 6.1.1</a><a href="#appendix-C-19.8.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-19.9">
          <p id="appendix-C-19.9.1">clarified discovery of pledges by the Registrar-Agent in <a href="#discovery_uc2_ppa" class="auto internal xref">Section 6.1.2</a>, deleted reference to GRASP as handled in BRSKI-Discovery<a href="#appendix-C-19.9.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-19.10">
          <p id="appendix-C-19.10.1">addressed comments from SECDIR early review<a href="#appendix-C-19.10.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-20">From IETF draft 09 -&gt; IETF draft 10:<a href="#appendix-C-20" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-21.1">
          <p id="appendix-C-21.1.1">issue #79, clarified discovery in the context of BRSKI-PRM and included information about future discovery enhancements in a separate draft in <a href="#discovery_uc2_reg" class="auto internal xref">Section 6.1.1</a>.<a href="#appendix-C-21.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-21.2">
          <p id="appendix-C-21.2.1">issue #93, included information about conflict resolution in mDNS and GRASP in <a href="#discovery_uc2_ppa" class="auto internal xref">Section 6.1.2</a><a href="#appendix-C-21.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-21.3">
          <p id="appendix-C-21.3.1">issue #103, included verification handling for the wrapped CA certificate provisioning in <a href="#cacerts" class="auto internal xref">Section 7.7</a><a href="#appendix-C-21.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-21.4">
          <p id="appendix-C-21.4.1">issue #106, included additional text to elaborate more the registrar status handling in <a href="#vstatus" class="auto internal xref">Section 7.9</a> and <a href="#estatus" class="auto internal xref">Section 7.10</a><a href="#appendix-C-21.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-21.5">
          <p id="appendix-C-21.5.1">issue #116, enhanced DoS description in <a href="#sec_cons-dos" class="auto internal xref">Section 12.1</a><a href="#appendix-C-21.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-21.6">
          <p id="appendix-C-21.6.1">issue #120, included statement regarding pledge host header processing in <a href="#pledge_component" class="auto internal xref">Section 6.2</a><a href="#appendix-C-21.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-21.7">
          <p id="appendix-C-21.7.1">issue #122, availability of product-serial-number information on registrar agent clarified in <a href="#tpvr" class="auto internal xref">Section 7.1</a><a href="#appendix-C-21.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-21.8">
          <p id="appendix-C-21.8.1">issue #123, Clarified usage of alternative voucher formats in  <a href="#rvr_artifact" class="auto internal xref">Section 7.3.4</a><a href="#appendix-C-21.8.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-21.9">
          <p id="appendix-C-21.9.1">issue #124, determination of pinned domain certificate done as in RFC 8995 included in <a href="#voucher_artifact" class="auto internal xref">Section 7.3.5</a><a href="#appendix-C-21.9.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-21.10">
          <p id="appendix-C-21.10.1">issue #125, remove strength comparison of voucher assertions in <a href="#agt_prx" class="auto internal xref">Section 5.4</a> and <a href="#exchanges" class="auto internal xref">Section 7</a><a href="#appendix-C-21.10.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-21.11">
          <p id="appendix-C-21.11.1">issue #130, aligned the usage of site and domain throughout the document<a href="#appendix-C-21.11.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-21.12">
          <p id="appendix-C-21.12.1">changed naming of registrar certificate from LDevID(RegAgt) to Registrar-Agent EE certificate throughout the document<a href="#appendix-C-21.12.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-21.13">
          <p id="appendix-C-21.13.1">change x5b to x5bag according to <span>[<a href="#RFC9360" class="cite xref">RFC9360</a>]</span><a href="#appendix-C-21.13.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-21.14">
          <p id="appendix-C-21.14.1">updated JSON examples -&gt; "signature": BASE64URL(JWS Signature)<a href="#appendix-C-21.14.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-22">From IETF draft 08 -&gt; IETF draft 09:<a href="#appendix-C-22" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-23.1">
          <p id="appendix-C-23.1.1">issue #80, enhanced <a href="#discovery_uc2_ppa" class="auto internal xref">Section 6.1.2</a> with clarification on the product-serial-number and the inclusion of GRASP<a href="#appendix-C-23.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-23.2">
          <p id="appendix-C-23.2.1">issue #81, enhanced introduction with motivation for agent_signed_data<a href="#appendix-C-23.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-23.3">
          <p id="appendix-C-23.3.1">issue #82, included optional TLS protection of the communication link between Registrar-Agent and pledge in the introduction <a href="#req-sol" class="auto internal xref">Section 4</a>, and <a href="#tpvr" class="auto internal xref">Section 7.1</a><a href="#appendix-C-23.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-23.4">
          <p id="appendix-C-23.4.1">issue #83, enhanced <a href="#tper" class="auto internal xref">Section 7.2</a> and <a href="#pvr" class="auto internal xref">Section 7.3</a> with note to re-enrollment<a href="#appendix-C-23.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-23.5">
          <p id="appendix-C-23.5.1">issue #87, clarified available information at the Registrar-Agent in <a href="#tpvr" class="auto internal xref">Section 7.1</a><a href="#appendix-C-23.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-23.6">
          <p id="appendix-C-23.6.1">issue #88, clarified, that the PVR in <a href="#tpvr" class="auto internal xref">Section 7.1</a> and PER in <a href="#tper" class="auto internal xref">Section 7.2</a> may contain the certificate chain. If not contained it <span class="bcp14">MUST</span> be available at the registrar.<a href="#appendix-C-23.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-23.7">
          <p id="appendix-C-23.7.1">issue #91, clarified that a separate HTTP connection may also be used to provide the PER in <a href="#per" class="auto internal xref">Section 7.4</a><a href="#appendix-C-23.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-23.8">
          <p id="appendix-C-23.8.1">resolved remaining editorial issues discovered after WGLC (responded to on the mailing list in Reply 1 and Reply 2) resulting in more consistent descriptions<a href="#appendix-C-23.8.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-23.9">
          <p id="appendix-C-23.9.1">issue #92: kept separate endpoint for wrapped CSR on registrar <a href="#obtain_cacerts" class="auto internal xref">Section 7.5</a><a href="#appendix-C-23.9.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-23.10">
          <p id="appendix-C-23.10.1">issue #94: clarified terminology (possess vs. obtained)<a href="#appendix-C-23.10.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-23.11">
          <p id="appendix-C-23.11.1">issue #95: clarified optional IDevID CA certificates on Registrar-Agent<a href="#appendix-C-23.11.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-23.12">
          <p id="appendix-C-23.12.1">issue #96: updated exchangesfig_uc2_3 to correct to just one CA certificate provisioning<a href="#appendix-C-23.12.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-23.13">
          <p id="appendix-C-23.13.1">issue #97: deleted format explanation in exchanges_uc2_3 as it may be misleading<a href="#appendix-C-23.13.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-23.14">
          <p id="appendix-C-23.14.1">issue #99: motivated verification of second signature on voucher in <a href="#voucher" class="auto internal xref">Section 7.6</a><a href="#appendix-C-23.14.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-23.15">
          <p id="appendix-C-23.15.1">issue #100: included negative example in <a href="#vstatus_data_example_error" class="auto internal xref">Figure 33</a><a href="#appendix-C-23.15.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-23.16">
          <p id="appendix-C-23.16.1">issue #101: included handling if <a href="#voucher" class="auto internal xref">Section 7.6</a> voucher telemetry information has not been received by the Registrar-Agent<a href="#appendix-C-23.16.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-23.17">
          <p id="appendix-C-23.17.1">issue #102: relaxed requirements for CA certs provisioning in <a href="#cacerts" class="auto internal xref">Section 7.7</a><a href="#appendix-C-23.17.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-23.18">
          <p id="appendix-C-23.18.1">issue #105: included negative example in <a href="#estatus_data_example_error" class="auto internal xref">Figure 39</a><a href="#appendix-C-23.18.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-23.19">
          <p id="appendix-C-23.19.1">issue #107: included example for certificate revocation in <a href="#estatus" class="auto internal xref">Section 7.10</a><a href="#appendix-C-23.19.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-23.20">
          <p id="appendix-C-23.20.1">issue #108: renamed heading to Pledge-Status Request of <a href="#query" class="auto internal xref">Section 7.11</a><a href="#appendix-C-23.20.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-23.21">
          <p id="appendix-C-23.21.1">issue #111: included pledge-status response processing for authenticated requests in <a href="#query" class="auto internal xref">Section 7.11</a><a href="#appendix-C-23.21.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-23.22">
          <p id="appendix-C-23.22.1">issue #112: added "Example key word in pledge-status response in <a href="#stat_example_bootstrap" class="auto internal xref">Figure 50</a><a href="#appendix-C-23.22.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-23.23">
          <p id="appendix-C-23.23.1">issue #113: enhanced description of status reply for "factory-default" in  <a href="#query" class="auto internal xref">Section 7.11</a><a href="#appendix-C-23.23.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-23.24">
          <p id="appendix-C-23.24.1">issue #114: Consideration of optional TLS usage in Privacy Considerations<a href="#appendix-C-23.24.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-23.25">
          <p id="appendix-C-23.25.1">issue #115: Consideration of optional TLS usage in Privacy Considerations to protect potentially privacy related information in the bootstrapping like status information, etc.<a href="#appendix-C-23.25.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-23.26">
          <p id="appendix-C-23.26.1">issue #116: Enhanced DoS description and mitigation options in security consideration section<a href="#appendix-C-23.26.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-23.27">
          <p id="appendix-C-23.27.1">updated references<a href="#appendix-C-23.27.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-24">From IETF draft 07 -&gt; IETF draft 08:<a href="#appendix-C-24" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-25.1">
          <p id="appendix-C-25.1.1">resolved editorial issues discovered after WGLC (still open issues remaining)<a href="#appendix-C-25.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-25.2">
          <p id="appendix-C-25.2.1">resolved first comments from the Shepherd review as discussed in PR #85 on the ANIMA github<a href="#appendix-C-25.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-26">From IETF draft 06 -&gt; IETF draft 07:<a href="#appendix-C-26" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-27.1">
          <p id="appendix-C-27.1.1">WGLC resulted in a removal of the voucher enhancements completely from this document to RFC 8366bis, containing all enhancements and augmentations of the voucher, including the voucher-request as well as the tree diagrams<a href="#appendix-C-27.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-27.2">
          <p id="appendix-C-27.2.1">smaller editorial corrections<a href="#appendix-C-27.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-28">From IETF draft 05 -&gt; IETF draft 06:<a href="#appendix-C-28" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-29.1">
          <p id="appendix-C-29.1.1">Update of list of reviewers<a href="#appendix-C-29.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-29.2">
          <p id="appendix-C-29.2.1">Issue #67, shortened the pledge endpoints to prepare for constraint deployments<a href="#appendix-C-29.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-29.3">
          <p id="appendix-C-29.3.1">Included table for new endpoints on the registrar in the overview of the Registrar-Agent<a href="#appendix-C-29.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-29.4">
          <p id="appendix-C-29.4.1">addressed review comments from SECDIR early review (terminology clarifications, editorial improvements)<a href="#appendix-C-29.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-29.5">
          <p id="appendix-C-29.5.1">addressed review comments from IOTDIR early review (terminology clarifications, editorial improvements)<a href="#appendix-C-29.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-30">From IETF draft 04 -&gt; IETF draft 05:<a href="#appendix-C-30" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-31.1">
          <p id="appendix-C-31.1.1">Restructured document to have a distinct section for the object flow and handling and shortened introduction, issue #72<a href="#appendix-C-31.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-31.2">
          <p id="appendix-C-31.2.1">Added security considerations for using mDNS without a specific product-serial-number, issue #75<a href="#appendix-C-31.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-31.3">
          <p id="appendix-C-31.3.1">Clarified pledge-status responses are cumulative, issue #73<a href="#appendix-C-31.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-31.4">
          <p id="appendix-C-31.4.1">Removed agent-sign-cert from trigger data to save bandwidth and remove complexity through options, issue #70<a href="#appendix-C-31.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-31.5">
          <p id="appendix-C-31.5.1">Changed terminology for LDevID(Reg) certificate to registrar LDevID certificate, as it does not need to be an LDevID, issue #66<a href="#appendix-C-31.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-31.6">
          <p id="appendix-C-31.6.1">Added new protected header parameter (created-on) in PER to support freshness validation, issue #63<a href="#appendix-C-31.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-31.7">
          <p id="appendix-C-31.7.1">Removed reference to CAB Forum as not needed for BRSKI-PRM specifically, issue #65<a href="#appendix-C-31.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-31.8">
          <p id="appendix-C-31.8.1">Enhanced error codes in section 5.5.1, issue #39, #64<a href="#appendix-C-31.8.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-31.9">
          <p id="appendix-C-31.9.1">Enhanced security considerations and privacy considerations, issue #59<a href="#appendix-C-31.9.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-31.10">
          <p id="appendix-C-31.10.1">Issue #50 addressed by referring to the utilized enrollment protocol<a href="#appendix-C-31.10.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-31.11">
          <p id="appendix-C-31.11.1">Issue #47 MASA verification of LDevID(RegAgt) to the same registrar LDevID certificate domain CA<a href="#appendix-C-31.11.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-31.12">
          <p id="appendix-C-31.12.1">Reworked terminology of "enrollment object", "certification object", "enrollment request object", etc., issue #27<a href="#appendix-C-31.12.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-31.13">
          <p id="appendix-C-31.13.1">Reworked all message representations to align with encoding<a href="#appendix-C-31.13.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-31.14">
          <p id="appendix-C-31.14.1">Added explanation of MASA requiring domain CA cert in section 5.5.1 and section 5.5.2, issue #36<a href="#appendix-C-31.14.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-31.15">
          <p id="appendix-C-31.15.1">Defined new endpoint for pledge bootstrapping status inquiry, issue #35 in section <a href="#query" class="auto internal xref">Section 7.11</a>, IANA considerations and section <a href="#pledge_component" class="auto internal xref">Section 6.2</a><a href="#appendix-C-31.15.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-31.16">
          <p id="appendix-C-31.16.1">Included examples for several objects in section <a href="#examples" class="auto internal xref">Appendix A</a> including message example sizes, issue #33<a href="#appendix-C-31.16.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-31.17">
          <p id="appendix-C-31.17.1">PoP for private key to registrar certificate included as mandatory, issues #32 and #49<a href="#appendix-C-31.17.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-31.18">
          <p id="appendix-C-31.18.1">Issue #31, clarified that combined pledge may act as client/server for further (re)enrollment<a href="#appendix-C-31.18.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-31.19">
          <p id="appendix-C-31.19.1">Issue #42, clarified that Registrar needs to verify the status responses with and ensure that they match the audit log response from the MASA, otherwise it needs drop the pledge and revoke the certificate<a href="#appendix-C-31.19.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-31.20">
          <p id="appendix-C-31.20.1">Issue #43, clarified that the pledge shall use the create time from the trigger message if the time has not been synchronized, yet.<a href="#appendix-C-31.20.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-31.21">
          <p id="appendix-C-31.21.1">Several editorial changes and enhancements to increasing readability.<a href="#appendix-C-31.21.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-32">From IETF draft 03 -&gt; IETF draft 04:<a href="#appendix-C-32" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-33.1">
          <p id="appendix-C-33.1.1">In deep Review by Esko Dijk lead to issues #22-#61, which are bein stepwise integrated<a href="#appendix-C-33.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-33.2">
          <p id="appendix-C-33.2.1">Simplified YANG definition by augmenting the voucher-request from RFC 8995 instead of redefining it.<a href="#appendix-C-33.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-33.3">
          <p id="appendix-C-33.3.1">Added explanation for terminology "endpoint" used in this document, issue #16<a href="#appendix-C-33.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-33.4">
          <p id="appendix-C-33.4.1">Added clarification that Registrar-Agent may collect PVR or PER or both in one run, issue #17<a href="#appendix-C-33.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-33.5">
          <p id="appendix-C-33.5.1">Added a statement that nonceless voucher may be accepted, issue #18<a href="#appendix-C-33.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-33.6">
          <p id="appendix-C-33.6.1">Simplified structure in section <a href="#sup-env" class="auto internal xref">Section 3.1</a>, issue #19<a href="#appendix-C-33.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-33.7">
          <p id="appendix-C-33.7.1">Removed join proxy in <a href="#uc2figure" class="auto internal xref">Figure 1</a> and added explanatory text, issue #20<a href="#appendix-C-33.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-33.8">
          <p id="appendix-C-33.8.1">Added description of pledge-CAcerts endpoint plus further handling of providing a wrapped CA certs response to the pledge in section <a href="#cacerts" class="auto internal xref">Section 7.7</a>; also added new required registrar endpoint (section <a href="#pvr" class="auto internal xref">Section 7.3</a> and IANA considerations) for the registrar to provide a wrapped CA certs response, issue #21<a href="#appendix-C-33.8.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-33.9">
          <p id="appendix-C-33.9.1">utilized defined abbreviations in the document consistently, issue #22<a href="#appendix-C-33.9.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-33.10">
          <p id="appendix-C-33.10.1">Reworked text on discovery according to issue #23 to clarify scope and handling<a href="#appendix-C-33.10.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-33.11">
          <p id="appendix-C-33.11.1">Added several clarifications based on review comments<a href="#appendix-C-33.11.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-34">From IETF draft 02 -&gt; IETF draft 03:<a href="#appendix-C-34" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-35.1">
          <p id="appendix-C-35.1.1">Updated examples to state "base64encodedvalue==" for x5c occurrences<a href="#appendix-C-35.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-35.2">
          <p id="appendix-C-35.2.1">Include link to SVG graphic as general overview<a href="#appendix-C-35.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-35.3">
          <p id="appendix-C-35.3.1">Restructuring of section 5 to flatten hierarchy<a href="#appendix-C-35.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-35.4">
          <p id="appendix-C-35.4.1">Enhanced requirements and motivation in <a href="#req-sol" class="auto internal xref">Section 4</a><a href="#appendix-C-35.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-35.5">
          <p id="appendix-C-35.5.1">Several editorial improvements based on review comments<a href="#appendix-C-35.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-36">From IETF draft 01 -&gt; IETF draft 02:<a href="#appendix-C-36" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-37.1">
          <p id="appendix-C-37.1.1">Issue #15 included additional signature on voucher from registrar in section <a href="#pvr" class="auto internal xref">Section 7.3</a> and section <a href="#agt_prx" class="auto internal xref">Section 5.4</a>
The verification of multiple signatures is described in section <a href="#voucher" class="auto internal xref">Section 7.6</a><a href="#appendix-C-37.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-37.2">
          <p id="appendix-C-37.2.1">Included representation for General JWS JSON Serialization for examples<a href="#appendix-C-37.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-37.3">
          <p id="appendix-C-37.3.1">Included error responses from pledge if it is not able to create a Pledge-Voucher-Request or an enrollment request in section <a href="#tpvr" class="auto internal xref">Section 7.1</a><a href="#appendix-C-37.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-37.4">
          <p id="appendix-C-37.4.1">Removed open issue regarding handling of multiple CSRs and Enroll-Responses during the bootstrapping as the initial target it the provisioning of a generic LDevID certificate. The defined endpoint on the pledge may also be used for management of further certificates.<a href="#appendix-C-37.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-38">From IETF draft 00 -&gt; IETF draft 01:<a href="#appendix-C-38" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-39.1">
          <p id="appendix-C-39.1.1">Issue #15 lead to the inclusion of an option for an additional signature of the registrar on the voucher received from the MASA before forwarding to the Registrar-Agent to support verification of POP of the registrars private key in section <a href="#pvr" class="auto internal xref">Section 7.3</a> and exchanges_uc2_3.<a href="#appendix-C-39.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-39.2">
          <p id="appendix-C-39.2.1">Based on issue #11, a new endpoint was defined for the registrar to enable delivery of the wrapped enrollment request from the pledge (in contrast to plain PKCS#10 in simple enroll).<a href="#appendix-C-39.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-39.3">
          <p id="appendix-C-39.3.1">Decision on issue #8 to not provide an additional signature on the enrollment-response object by the registrar. As the Enroll-Response will only contain the generic LDevID certificate. This credential builds the base for further configuration outside the initial enrollment.<a href="#appendix-C-39.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-39.4">
          <p id="appendix-C-39.4.1">Decision on issue #7 to not support multiple CSRs during the bootstrapping, as based on the generic LDevID certificate the pledge may enroll for further certificates.<a href="#appendix-C-39.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-39.5">
          <p id="appendix-C-39.5.1">Closed open issue #5 regarding verification of ietf-ztp-types usage as verified
via a proof-of-concept in section <a href="#tpvr" class="auto internal xref">Section 7.1</a>.<a href="#appendix-C-39.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-39.6">
          <p id="appendix-C-39.6.1">Housekeeping: Removed already addressed open issues stated in the draft directly.<a href="#appendix-C-39.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-39.7">
          <p id="appendix-C-39.7.1">Reworked text in from introduction to section pledge-responder-mode<a href="#appendix-C-39.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-39.8">
          <p id="appendix-C-39.8.1">Fixed "serial-number" encoding in PVR/RVR<a href="#appendix-C-39.8.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-39.9">
          <p id="appendix-C-39.9.1">Added prior-signed-voucher-request in the parameter description of the
registrar-voucher-request in <a href="#pvr" class="auto internal xref">Section 7.3</a>.<a href="#appendix-C-39.9.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-39.10">
          <p id="appendix-C-39.10.1">Note added in <a href="#pvr" class="auto internal xref">Section 7.3</a> if sub-CAs are used, that the
corresponding information is to be provided to the MASA.<a href="#appendix-C-39.10.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-39.11">
          <p id="appendix-C-39.11.1">Inclusion of limitation section (pledge sleeps and needs to be waked
up. Pledge is awake but Registrar-Agent is not available) (Issue #10).<a href="#appendix-C-39.11.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-39.12">
          <p id="appendix-C-39.12.1">Assertion-type aligned with voucher in RFC8366bis, deleted related
open issues. (Issue #4)<a href="#appendix-C-39.12.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-39.13">
          <p id="appendix-C-39.13.1">Included table for endpoints in <a href="#pledge_component" class="auto internal xref">Section 6.2</a> for better readability.<a href="#appendix-C-39.13.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-39.14">
          <p id="appendix-C-39.14.1">Included registrar authorization check for Registrar-Agent during
TLS handshake  in section <a href="#pvr" class="auto internal xref">Section 7.3</a>. Also enhanced figure
<a href="#exchangesfig_uc2_all" class="auto internal xref">Figure 4</a> with the authorization step on TLS level.<a href="#appendix-C-39.14.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-39.15">
          <p id="appendix-C-39.15.1">Enhanced description of registrar authorization check for Registrar-Agent
based on the agent-signed-data in section <a href="#pvr" class="auto internal xref">Section 7.3</a>. Also
enhanced figure <a href="#exchangesfig_uc2_all" class="auto internal xref">Figure 4</a> with the authorization step
on Pledge-Voucher-Request level.<a href="#appendix-C-39.15.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-39.16">
          <p id="appendix-C-39.16.1">Changed agent-signed-cert to an array to allow for providing further
certificate information like the issuing CA cert for the LDevID(RegAgt)
certificate in case the registrar and the Registrar-Agent have different
issuing CAs in <a href="#exchangesfig_uc2_all" class="auto internal xref">Figure 4</a> (issue #12).
This also required changes in the YANG module in <span>[<a href="#I-D.ietf-anima-rfc8366bis" class="cite xref">I-D.ietf-anima-rfc8366bis</a>]</span><a href="#appendix-C-39.16.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-39.17">
          <p id="appendix-C-39.17.1">Addressed YANG warning (issue #1)<a href="#appendix-C-39.17.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-39.18">
          <p id="appendix-C-39.18.1">Inclusion of examples for a trigger to create a Pledge-Voucher-Request
and a Pledge Enroll-Request.<a href="#appendix-C-39.18.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-40">From IETF draft-ietf-anima-brski-async-enroll-03 -&gt; IETF anima-brski-prm-00:<a href="#appendix-C-40" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-41.1">
          <p id="appendix-C-41.1.1">Moved UC2 related parts defining the Pledge in Responder Mode from
draft-ietf-anima-brski-async-enroll-03 to this document
This required changes and adaptations in several sections to remove
the description and references to UC1.<a href="#appendix-C-41.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-41.2">
          <p id="appendix-C-41.2.1">Addressed feedback for voucher-request enhancements from YANG doctor
early review, meanwhile moved to <span>[<a href="#I-D.ietf-anima-rfc8366bis" class="cite xref">I-D.ietf-anima-rfc8366bis</a>]</span> as well as in the security considerations (formerly named ietf-async-voucher-request).<a href="#appendix-C-41.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-41.3">
          <p id="appendix-C-41.3.1">Renamed ietf-async-voucher-request to IETF-voucher-request-prm to
to allow better listing of voucher related extensions; aligned with
constraint voucher (#20)<a href="#appendix-C-41.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-41.4">
          <p id="appendix-C-41.4.1">Utilized ietf-voucher-request-async instead of ietf-voucher-request
in voucher exchanges to utilize the enhanced voucher-request.<a href="#appendix-C-41.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-41.5">
          <p id="appendix-C-41.5.1">Included changes from draft-ietf-netconf-sztp-csr-06 regarding the
YANG definition of csr-types into the enrollment request exchange.<a href="#appendix-C-41.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-42">From IETF draft 02 -&gt; IETF draft 03:<a href="#appendix-C-42" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-43.1">
          <p id="appendix-C-43.1.1">Housekeeping, deleted open issue regarding YANG voucher-request
in <a href="#tpvr" class="auto internal xref">Section 7.1</a> as voucher-request was
enhanced with additional leaf.<a href="#appendix-C-43.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-43.2">
          <p id="appendix-C-43.2.1">Included open issues in YANG model in <a href="#architecture" class="auto internal xref">Section 5</a> regarding assertion
value agent-proximity and csr encapsulation using SZTP sub module).<a href="#appendix-C-43.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-44">From IETF draft 01 -&gt; IETF draft 02:<a href="#appendix-C-44" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-45.1">
          <p id="appendix-C-45.1.1">Defined call flow and objects for interactions in UC2. Object format
based on draft for JOSE signed voucher artifacts and aligned the
remaining objects with this approach in <a href="#exchanges" class="auto internal xref">Section 7</a>.<a href="#appendix-C-45.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-45.2">
          <p id="appendix-C-45.2.1">Terminology change: issue #2 pledge-agent -&gt; Registrar-Agent to
better underline Registrar-Agent relation.<a href="#appendix-C-45.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-45.3">
          <p id="appendix-C-45.3.1">Terminology change: issue #3 PULL/PUSH -&gt; pledge-initiator-mode
and pledge-responder-mode to better address the pledge operation.<a href="#appendix-C-45.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-45.4">
          <p id="appendix-C-45.4.1">Communication approach between pledge and Registrar-Agent
changed by removing TLS-PSK (former section TLS establishment)
and associated references to other drafts in favor of relying on
higher layer exchange of signed data objects. These data objects
are included also in the Pledge-Voucher-Request and lead to an
extension of the YANG module for the voucher-request (issue #12).<a href="#appendix-C-45.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-45.5">
          <p id="appendix-C-45.5.1">Details on trust relationship between Registrar-Agent and
registrar (issue #4, #5, #9) included in <a href="#architecture" class="auto internal xref">Section 5</a>.<a href="#appendix-C-45.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-45.6">
          <p id="appendix-C-45.6.1">Recommendation regarding short-lived certificates for
Registrar-Agent authentication towards registrar (issue #7) in
the security considerations.<a href="#appendix-C-45.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-45.7">
          <p id="appendix-C-45.7.1">Introduction of reference to Registrar-Agent signing certificate using
SubjectKeyIdentifier in Registrar-Agent signed data (issue #37).<a href="#appendix-C-45.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-45.8">
          <p id="appendix-C-45.8.1">Enhanced objects in exchanges between pledge and Registrar-Agent
to allow the registrar to verify agent-proximity to the pledge
(issue #1) in <a href="#exchanges" class="auto internal xref">Section 7</a>.<a href="#appendix-C-45.8.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-45.9">
          <p id="appendix-C-45.9.1">Details on trust relationship between Registrar-Agent and
pledge (issue #5) included in <a href="#architecture" class="auto internal xref">Section 5</a>.<a href="#appendix-C-45.9.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-45.10">
          <p id="appendix-C-45.10.1">Split of use case 2 call flow into sub sections in <a href="#exchanges" class="auto internal xref">Section 7</a>.<a href="#appendix-C-45.10.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-46">From IETF draft 00 -&gt; IETF draft 01:<a href="#appendix-C-46" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-47.1">
          <p id="appendix-C-47.1.1">Update of scope in <a href="#sup-env" class="auto internal xref">Section 3.1</a> to include in
which the pledge acts as a server. This is one main motivation
for use case 2.<a href="#appendix-C-47.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-47.2">
          <p id="appendix-C-47.2.1">Rework of use case 2 in <a href="#architecture" class="auto internal xref">Section 5</a> to consider the
transport between the pledge and the pledge-agent. Addressed is
the TLS channel establishment between the pledge-agent and the
pledge as well as the endpoint definition on the pledge.<a href="#appendix-C-47.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-47.3">
          <p id="appendix-C-47.3.1">First description of exchanged object types (needs more work)<a href="#appendix-C-47.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-47.4">
          <p id="appendix-C-47.4.1">Clarification in discovery options for enrollment endpoints at
the domain registrar based on well-known endpoints do not
result in additional /.well-known URIs. Update of the illustrative example.
Note that the change to /brski for the voucher related endpoints
has been taken over in the BRSKI main document.<a href="#appendix-C-47.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-47.5">
          <p id="appendix-C-47.5.1">Updated references.<a href="#appendix-C-47.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-47.6">
          <p id="appendix-C-47.6.1">Included Thomas Werner as additional author for the document.<a href="#appendix-C-47.6.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-48">From individual version 03 -&gt; IETF draft 00:<a href="#appendix-C-48" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-49.1">
          <p id="appendix-C-49.1.1">Inclusion of discovery options of enrollment endpoints at
the domain registrar based on well-known endpoints in
new section as replacement of section 5.1.3
in the individual draft. This is intended to support both use
cases in the document. An illustrative example is provided.<a href="#appendix-C-49.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-49.2">
          <p id="appendix-C-49.2.1">Missing details provided for the description and call flow in
pledge-agent use case <a href="#architecture" class="auto internal xref">Section 5</a>, e.g. to
accommodate distribution of CA certificates.<a href="#appendix-C-49.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-49.3">
          <p id="appendix-C-49.3.1">Updated CMP example in to use lightweight CMP instead of CMP, as the
draft already provides the necessary /.well-known endpoints.<a href="#appendix-C-49.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-49.4">
          <p id="appendix-C-49.4.1">Requirements discussion moved to separate section in
<a href="#req-sol" class="auto internal xref">Section 4</a>. Shortened description of proof
of identity binding and mapping to existing protocols.<a href="#appendix-C-49.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-49.5">
          <p id="appendix-C-49.5.1">Removal of copied call flows for voucher exchange and registrar
discovery flow from <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span> in UC1 to avoid doubling or text or
inconsistencies.<a href="#appendix-C-49.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-49.6">
          <p id="appendix-C-49.6.1">Reworked abstract and introduction to be more crisp regarding
the targeted solution. Several structural changes in the document
to have a better distinction between requirements, use case
description, and solution description as separate sections.
History moved to appendix.<a href="#appendix-C-49.6.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-50">From individual version 02 -&gt; 03:<a href="#appendix-C-50" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-51.1">
          <p id="appendix-C-51.1.1">Update of terminology from self-contained to authenticated
self-contained object to be consistent in the wording and to
underline the protection of the object with an existing
credential. Note that the naming of this object may be discussed.
An alternative name may be attestation object.<a href="#appendix-C-51.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-51.2">
          <p id="appendix-C-51.2.1">Simplification of the architecture approach for the initial use
case having an offsite PKI.<a href="#appendix-C-51.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-51.3">
          <p id="appendix-C-51.3.1">Introduction of a new use case utilizing authenticated
self-contain objects to onboard a pledge using a commissioning
tool containing a pledge-agent. This requires additional changes
in the BRSKI call flow sequence and led to changes in the
introduction, the application example,and also in the
related BRSKI-PRM call flow.<a href="#appendix-C-51.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-52">From individual version 01 -&gt; 02:<a href="#appendix-C-52" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-53.1">
          <p id="appendix-C-53.1.1">Update of introduction text to clearly relate to the usage of
IDevID and LDevID.<a href="#appendix-C-53.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-53.2">
          <p id="appendix-C-53.2.1">Update of description of architecture elements and
changes to BRSKI in <a href="#architecture" class="auto internal xref">Section 5</a>.<a href="#appendix-C-53.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-53.3">
          <p id="appendix-C-53.3.1">Enhanced consideration of existing enrollment protocols in the
context of mapping the requirements to existing solutions in
<a href="#req-sol" class="auto internal xref">Section 4</a>.<a href="#appendix-C-53.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-54">From individual version 00 -&gt; 01:<a href="#appendix-C-54" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-55.1">
          <p id="appendix-C-55.1.1">Update of examples, specifically for building automation as
well as two new application use cases in <a href="#sup-env" class="auto internal xref">Section 3.1</a>.<a href="#appendix-C-55.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-55.2">
          <p id="appendix-C-55.2.1">Deletion of asynchronous interaction with MASA to not
complicate the use case. Note that the voucher exchange can
already be handled in an asynchronous manner and is therefore
not considered further. This resulted in removal of the
alternative path the MASA in Figure 1 and the associated
description in <a href="#architecture" class="auto internal xref">Section 5</a>.<a href="#appendix-C-55.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-55.3">
          <p id="appendix-C-55.3.1">Enhancement of description of architecture elements and
changes to BRSKI in <a href="#architecture" class="auto internal xref">Section 5</a>.<a href="#appendix-C-55.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-55.4">
          <p id="appendix-C-55.4.1">Consideration of existing enrollment protocols in the context
of mapping the requirements to existing solutions in <a href="#req-sol" class="auto internal xref">Section 4</a>.<a href="#appendix-C-55.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-55.5">
          <p id="appendix-C-55.5.1">New section starting with the
mapping to existing enrollment protocols by collecting
boundary conditions.<a href="#appendix-C-55.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="contributors">
<section id="appendix-D">
      <h2 id="name-contributors">
<a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Esko Dijk</span></div>
<div dir="auto" class="left"><span class="org">IoTconsultancy.nl</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:esko.dijk@iotconsultancy.nl" class="email">esko.dijk@iotconsultancy.nl</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Toerless Eckert</span></div>
<div dir="auto" class="left"><span class="org">Futurewei</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:tte@cs.fau.de" class="email">tte@cs.fau.de</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Matthias Kovatsch</span></div>
<div dir="auto" class="left"><span class="org">Siemens Schweiz AG</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ietf@kovatsch.net" class="email">ietf@kovatsch.net</a>
</div>
</address>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-E">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Steffen Fries</span></div>
<div dir="auto" class="left"><span class="org">Siemens AG</span></div>
<div dir="auto" class="left"><span class="street-address">Otto-Hahn-Ring 6</span></div>
<div dir="auto" class="left">
<span class="postal-code">81739</span> <span class="locality">Munich</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:steffen.fries@siemens.com" class="email">steffen.fries@siemens.com</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://www.siemens.com/" class="url">https://www.siemens.com/</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Thomas Werner</span></div>
<div dir="auto" class="left"><span class="org">Siemens AG</span></div>
<div dir="auto" class="left"><span class="street-address">Otto-Hahn-Ring 6</span></div>
<div dir="auto" class="left">
<span class="postal-code">81739</span> <span class="locality">Munich</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:thomas-werner@siemens.com" class="email">thomas-werner@siemens.com</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://www.siemens.com/" class="url">https://www.siemens.com/</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Eliot Lear</span></div>
<div dir="auto" class="left"><span class="org">Cisco Systems</span></div>
<div dir="auto" class="left"><span class="street-address">Richtistrasse 7</span></div>
<div dir="auto" class="left">CH-<span class="postal-code">8304</span> <span class="locality">Wallisellen</span>
</div>
<div dir="auto" class="left"><span class="country-name">Switzerland</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+41%2044%20878%209200" class="tel">+41 44 878 9200</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:lear@cisco.com" class="email">lear@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Michael C. Richardson</span></div>
<div dir="auto" class="left"><span class="org">Sandelman Software Works</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mcr+ietf@sandelman.ca" class="email">mcr+ietf@sandelman.ca</a>
</div>
<div class="url">
<span>URI:</span>
<a href="http://www.sandelman.ca/" class="url">http://www.sandelman.ca/</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
